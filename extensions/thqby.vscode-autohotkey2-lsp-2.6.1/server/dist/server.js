"use strict";var H_=Object.create;var sf=Object.defineProperty;var z_=Object.getOwnPropertyDescriptor;var G_=Object.getOwnPropertyNames;var X_=Object.getPrototypeOf,Q_=Object.prototype.hasOwnProperty;var Ye=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var J_=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of G_(t))!Q_.call(e,i)&&i!==n&&sf(e,i,{get:()=>t[i],enumerable:!(r=z_(t,i))||r.enumerable});return e};var zn=(e,t,n)=>(n=e!=null?H_(X_(e)):{},J_(t||!e||!e.__esModule?sf(n,"default",{value:e,enumerable:!0}):n,e));var _s=Ye(Cn=>{"use strict";Object.defineProperty(Cn,"__esModule",{value:!0});Cn.thenable=Cn.typedArray=Cn.stringArray=Cn.array=Cn.func=Cn.error=Cn.number=Cn.string=Cn.boolean=void 0;function Y_(e){return e===!0||e===!1}Cn.boolean=Y_;function uf(e){return typeof e=="string"||e instanceof String}Cn.string=uf;function eb(e){return typeof e=="number"||e instanceof Number}Cn.number=eb;function tb(e){return e instanceof Error}Cn.error=tb;function ff(e){return typeof e=="function"}Cn.func=ff;function df(e){return Array.isArray(e)}Cn.array=df;function nb(e){return df(e)&&e.every(t=>uf(t))}Cn.stringArray=nb;function ib(e,t){return Array.isArray(e)&&e.every(t)}Cn.typedArray=ib;function rb(e){return e&&ff(e.then)}Cn.thenable=rb});var Gr=Ye(qn=>{"use strict";Object.defineProperty(qn,"__esModule",{value:!0});qn.stringArray=qn.array=qn.func=qn.error=qn.number=qn.string=qn.boolean=void 0;function ob(e){return e===!0||e===!1}qn.boolean=ob;function pf(e){return typeof e=="string"||e instanceof String}qn.string=pf;function sb(e){return typeof e=="number"||e instanceof Number}qn.number=sb;function ab(e){return e instanceof Error}qn.error=ab;function cb(e){return typeof e=="function"}qn.func=cb;function hf(e){return Array.isArray(e)}qn.array=hf;function lb(e){return hf(e)&&e.every(t=>pf(t))}qn.stringArray=lb});var qc=Ye(at=>{"use strict";Object.defineProperty(at,"__esModule",{value:!0});at.Message=at.NotificationType9=at.NotificationType8=at.NotificationType7=at.NotificationType6=at.NotificationType5=at.NotificationType4=at.NotificationType3=at.NotificationType2=at.NotificationType1=at.NotificationType0=at.NotificationType=at.RequestType9=at.RequestType8=at.RequestType7=at.RequestType6=at.RequestType5=at.RequestType4=at.RequestType3=at.RequestType2=at.RequestType1=at.RequestType=at.RequestType0=at.AbstractMessageSignature=at.ParameterStructures=at.ResponseError=at.ErrorCodes=void 0;var Sr=Gr(),hc;(function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=-32099,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.PendingResponseRejected=-32097,e.ConnectionInactive=-32096,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=-32e3})(hc||(at.ErrorCodes=hc={}));var gc=class e extends Error{constructor(t,n,r){super(n),this.code=Sr.number(t)?t:hc.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,e.prototype)}toJson(){let t={code:this.code,message:this.message};return this.data!==void 0&&(t.data=this.data),t}};at.ResponseError=gc;var Xn=class e{constructor(t){this.kind=t}static is(t){return t===e.auto||t===e.byName||t===e.byPosition}toString(){return this.kind}};at.ParameterStructures=Xn;Xn.auto=new Xn("auto");Xn.byPosition=new Xn("byPosition");Xn.byName=new Xn("byName");var ln=class{constructor(t,n){this.method=t,this.numberOfParams=n}get parameterStructures(){return Xn.auto}};at.AbstractMessageSignature=ln;var mc=class extends ln{constructor(t){super(t,0)}};at.RequestType0=mc;var _c=class extends ln{constructor(t,n=Xn.auto){super(t,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};at.RequestType=_c;var bc=class extends ln{constructor(t,n=Xn.auto){super(t,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};at.RequestType1=bc;var yc=class extends ln{constructor(t){super(t,2)}};at.RequestType2=yc;var kc=class extends ln{constructor(t){super(t,3)}};at.RequestType3=kc;var vc=class extends ln{constructor(t){super(t,4)}};at.RequestType4=vc;var Tc=class extends ln{constructor(t){super(t,5)}};at.RequestType5=Tc;var wc=class extends ln{constructor(t){super(t,6)}};at.RequestType6=wc;var Rc=class extends ln{constructor(t){super(t,7)}};at.RequestType7=Rc;var Cc=class extends ln{constructor(t){super(t,8)}};at.RequestType8=Cc;var xc=class extends ln{constructor(t){super(t,9)}};at.RequestType9=xc;var Dc=class extends ln{constructor(t,n=Xn.auto){super(t,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};at.NotificationType=Dc;var Sc=class extends ln{constructor(t){super(t,0)}};at.NotificationType0=Sc;var Ec=class extends ln{constructor(t,n=Xn.auto){super(t,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};at.NotificationType1=Ec;var Pc=class extends ln{constructor(t){super(t,2)}};at.NotificationType2=Pc;var Oc=class extends ln{constructor(t){super(t,3)}};at.NotificationType3=Oc;var Ac=class extends ln{constructor(t){super(t,4)}};at.NotificationType4=Ac;var Nc=class extends ln{constructor(t){super(t,5)}};at.NotificationType5=Nc;var Lc=class extends ln{constructor(t){super(t,6)}};at.NotificationType6=Lc;var Mc=class extends ln{constructor(t){super(t,7)}};at.NotificationType7=Mc;var Fc=class extends ln{constructor(t){super(t,8)}};at.NotificationType8=Fc;var Ic=class extends ln{constructor(t){super(t,9)}};at.NotificationType9=Ic;var gf;(function(e){function t(i){let s=i;return s&&Sr.string(s.method)&&(Sr.string(s.id)||Sr.number(s.id))}e.isRequest=t;function n(i){let s=i;return s&&Sr.string(s.method)&&i.id===void 0}e.isNotification=n;function r(i){let s=i;return s&&(s.result!==void 0||!!s.error)&&(Sr.string(s.id)||Sr.number(s.id)||s.id===null)}e.isResponse=r})(gf||(at.Message=gf={}))});var jc=Ye(cr=>{"use strict";var mf;Object.defineProperty(cr,"__esModule",{value:!0});cr.LRUCache=cr.LinkedMap=cr.Touch=void 0;var Kn;(function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last})(Kn||(cr.Touch=Kn={}));var bs=class{constructor(){this[mf]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(t){return this._map.has(t)}get(t,n=Kn.None){let r=this._map.get(t);if(r)return n!==Kn.None&&this.touch(r,n),r.value}set(t,n,r=Kn.None){let i=this._map.get(t);if(i)i.value=n,r!==Kn.None&&this.touch(i,r);else{switch(i={key:t,value:n,next:void 0,previous:void 0},r){case Kn.None:this.addItemLast(i);break;case Kn.First:this.addItemFirst(i);break;case Kn.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(t,i),this._size++}return this}delete(t){return!!this.remove(t)}remove(t){let n=this._map.get(t);if(n)return this._map.delete(t),this.removeItem(n),this._size--,n.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let t=this._head;return this._map.delete(t.key),this.removeItem(t),this._size--,t.value}forEach(t,n){let r=this._state,i=this._head;for(;i;){if(n?t.bind(n)(i.value,i.key,this):t(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let t=this._state,n=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let i={value:n.key,done:!1};return n=n.next,i}else return{value:void 0,done:!0}}};return r}values(){let t=this._state,n=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let i={value:n.value,done:!1};return n=n.next,i}else return{value:void 0,done:!0}}};return r}entries(){let t=this._state,n=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let i={value:[n.key,n.value],done:!1};return n=n.next,i}else return{value:void 0,done:!0}}};return r}[(mf=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(t){if(t>=this.size)return;if(t===0){this.clear();return}let n=this._head,r=this.size;for(;n&&r>t;)this._map.delete(n.key),n=n.next,r--;this._head=n,this._size=r,n&&(n.previous=void 0),this._state++}addItemFirst(t){if(!this._head&&!this._tail)this._tail=t;else if(this._head)t.next=this._head,this._head.previous=t;else throw new Error("Invalid list");this._head=t,this._state++}addItemLast(t){if(!this._head&&!this._tail)this._head=t;else if(this._tail)t.previous=this._tail,this._tail.next=t;else throw new Error("Invalid list");this._tail=t,this._state++}removeItem(t){if(t===this._head&&t===this._tail)this._head=void 0,this._tail=void 0;else if(t===this._head){if(!t.next)throw new Error("Invalid list");t.next.previous=void 0,this._head=t.next}else if(t===this._tail){if(!t.previous)throw new Error("Invalid list");t.previous.next=void 0,this._tail=t.previous}else{let n=t.next,r=t.previous;if(!n||!r)throw new Error("Invalid list");n.previous=r,r.next=n}t.next=void 0,t.previous=void 0,this._state++}touch(t,n){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(n!==Kn.First&&n!==Kn.Last)){if(n===Kn.First){if(t===this._head)return;let r=t.next,i=t.previous;t===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),t.previous=void 0,t.next=this._head,this._head.previous=t,this._head=t,this._state++}else if(n===Kn.Last){if(t===this._tail)return;let r=t.next,i=t.previous;t===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),t.next=void 0,t.previous=this._tail,this._tail.next=t,this._tail=t,this._state++}}}toJSON(){let t=[];return this.forEach((n,r)=>{t.push([r,n])}),t}fromJSON(t){this.clear();for(let[n,r]of t)this.set(n,r)}};cr.LinkedMap=bs;var Kc=class extends bs{constructor(t,n=1){super(),this._limit=t,this._ratio=Math.min(Math.max(0,n),1)}get limit(){return this._limit}set limit(t){this._limit=t,this.checkTrim()}get ratio(){return this._ratio}set ratio(t){this._ratio=Math.min(Math.max(0,t),1),this.checkTrim()}get(t,n=Kn.AsNew){return super.get(t,n)}peek(t){return super.get(t,Kn.None)}set(t,n){return super.set(t,n,Kn.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};cr.LRUCache=Kc});var bf=Ye(ys=>{"use strict";Object.defineProperty(ys,"__esModule",{value:!0});ys.Disposable=void 0;var _f;(function(e){function t(n){return{dispose:n}}e.create=t})(_f||(ys.Disposable=_f={}))});var lr=Ye(Vc=>{"use strict";Object.defineProperty(Vc,"__esModule",{value:!0});var $c;function Wc(){if($c===void 0)throw new Error("No runtime abstraction layer installed");return $c}(function(e){function t(n){if(n===void 0)throw new Error("No runtime abstraction layer provided");$c=n}e.install=t})(Wc||(Wc={}));Vc.default=Wc});var Qr=Ye(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});Xr.Emitter=Xr.Event=void 0;var ub=lr(),yf;(function(e){let t={dispose(){}};e.None=function(){return t}})(yf||(Xr.Event=yf={}));var Uc=class{add(t,n=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(t),this._contexts.push(n),Array.isArray(r)&&r.push({dispose:()=>this.remove(t,n)})}remove(t,n=null){if(!this._callbacks)return;let r=!1;for(let i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===t)if(this._contexts[i]===n){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...t){if(!this._callbacks)return[];let n=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let s=0,a=r.length;s<a;s++)try{n.push(r[s].apply(i[s],t))}catch(u){(0,ub.default)().console.error(u)}return n}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},ks=class e{constructor(t){this._options=t}get event(){return this._event||(this._event=(t,n,r)=>{this._callbacks||(this._callbacks=new Uc),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(t,n);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(t,n),i.dispose=e._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(t){this._callbacks&&this._callbacks.invoke.call(this._callbacks,t)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};Xr.Emitter=ks;ks._noop=function(){}});var ws=Ye(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.CancellationTokenSource=Jr.CancellationToken=void 0;var fb=lr(),db=Gr(),Bc=Qr(),vs;(function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Bc.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Bc.Event.None});function t(n){let r=n;return r&&(r===e.None||r===e.Cancelled||db.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}e.is=t})(vs||(Jr.CancellationToken=vs={}));var pb=Object.freeze(function(e,t){let n=(0,fb.default)().timer.setTimeout(e.bind(t),0);return{dispose(){n.dispose()}}}),Ts=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?pb:(this._emitter||(this._emitter=new Bc.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},Hc=class{get token(){return this._token||(this._token=new Ts),this._token}cancel(){this._token?this._token.cancel():this._token=vs.Cancelled}dispose(){this._token?this._token instanceof Ts&&this._token.dispose():this._token=vs.None}};Jr.CancellationTokenSource=Hc});var kf=Ye(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.SharedArrayReceiverStrategy=Zr.SharedArraySenderStrategy=void 0;var hb=ws(),Io;(function(e){e.Continue=0,e.Cancelled=1})(Io||(Io={}));var zc=class{constructor(){this.buffers=new Map}enableCancellation(t){if(t.id===null)return;let n=new SharedArrayBuffer(4),r=new Int32Array(n,0,1);r[0]=Io.Continue,this.buffers.set(t.id,n),t.$cancellationData=n}async sendCancellation(t,n){let r=this.buffers.get(n);if(r===void 0)return;let i=new Int32Array(r,0,1);Atomics.store(i,0,Io.Cancelled)}cleanup(t){this.buffers.delete(t)}dispose(){this.buffers.clear()}};Zr.SharedArraySenderStrategy=zc;var Gc=class{constructor(t){this.data=new Int32Array(t,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===Io.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},Xc=class{constructor(t){this.token=new Gc(t)}cancel(){}dispose(){}},Qc=class{constructor(){this.kind="request"}createCancellationTokenSource(t){let n=t.$cancellationData;return n===void 0?new hb.CancellationTokenSource:new Xc(n)}};Zr.SharedArrayReceiverStrategy=Qc});var Zc=Ye(Rs=>{"use strict";Object.defineProperty(Rs,"__esModule",{value:!0});Rs.Semaphore=void 0;var gb=lr(),Jc=class{constructor(t=1){if(t<=0)throw new Error("Capacity must be greater than 0");this._capacity=t,this._active=0,this._waiting=[]}lock(t){return new Promise((n,r)=>{this._waiting.push({thunk:t,resolve:n,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,gb.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let t=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let n=t.thunk();n instanceof Promise?n.then(r=>{this._active--,t.resolve(r),this.runNext()},r=>{this._active--,t.reject(r),this.runNext()}):(this._active--,t.resolve(n),this.runNext())}catch(n){this._active--,t.reject(n),this.runNext()}}};Rs.Semaphore=Jc});var Tf=Ye(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.ReadableStreamMessageReader=ur.AbstractMessageReader=ur.MessageReader=void 0;var el=lr(),Yr=Gr(),Yc=Qr(),mb=Zc(),vf;(function(e){function t(n){let r=n;return r&&Yr.func(r.listen)&&Yr.func(r.dispose)&&Yr.func(r.onError)&&Yr.func(r.onClose)&&Yr.func(r.onPartialMessage)}e.is=t})(vf||(ur.MessageReader=vf={}));var Cs=class{constructor(){this.errorEmitter=new Yc.Emitter,this.closeEmitter=new Yc.Emitter,this.partialMessageEmitter=new Yc.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(t){this.errorEmitter.fire(this.asError(t))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(t){this.partialMessageEmitter.fire(t)}asError(t){return t instanceof Error?t:new Error(`Reader received error. Reason: ${Yr.string(t.message)?t.message:"unknown"}`)}};ur.AbstractMessageReader=Cs;var tl;(function(e){function t(n){let r,i,s,a=new Map,u,f=new Map;if(n===void 0||typeof n=="string")r=n??"utf-8";else{if(r=n.charset??"utf-8",n.contentDecoder!==void 0&&(s=n.contentDecoder,a.set(s.name,s)),n.contentDecoders!==void 0)for(let l of n.contentDecoders)a.set(l.name,l);if(n.contentTypeDecoder!==void 0&&(u=n.contentTypeDecoder,f.set(u.name,u)),n.contentTypeDecoders!==void 0)for(let l of n.contentTypeDecoders)f.set(l.name,l)}return u===void 0&&(u=(0,el.default)().applicationJson.decoder,f.set(u.name,u)),{charset:r,contentDecoder:s,contentDecoders:a,contentTypeDecoder:u,contentTypeDecoders:f}}e.fromOptions=t})(tl||(tl={}));var nl=class extends Cs{constructor(t,n){super(),this.readable=t,this.options=tl.fromOptions(n),this.buffer=(0,el.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new mb.Semaphore(1)}set partialMessageTimeout(t){this._partialMessageTimeout=t}get partialMessageTimeout(){return this._partialMessageTimeout}listen(t){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=t;let n=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),n}onData(t){try{for(this.buffer.append(t);;){if(this.nextMessageLength===-1){let r=this.buffer.tryReadHeaders(!0);if(!r)return;let i=r.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(r))}`));return}let s=parseInt(i);if(isNaN(s)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=s}let n=this.buffer.tryReadBody(this.nextMessageLength);if(n===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(n):n,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}catch(n){this.fireError(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,el.default)().timer.setTimeout((t,n)=>{this.partialMessageTimer=void 0,t===this.messageToken&&(this.firePartialMessage({messageToken:t,waitingTime:n}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};ur.ReadableStreamMessageReader=nl});var Df=Ye(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.WriteableStreamMessageWriter=fr.AbstractMessageWriter=fr.MessageWriter=void 0;var wf=lr(),qo=Gr(),_b=Zc(),Rf=Qr(),bb="Content-Length: ",Cf=`\r
`,xf;(function(e){function t(n){let r=n;return r&&qo.func(r.dispose)&&qo.func(r.onClose)&&qo.func(r.onError)&&qo.func(r.write)}e.is=t})(xf||(fr.MessageWriter=xf={}));var xs=class{constructor(){this.errorEmitter=new Rf.Emitter,this.closeEmitter=new Rf.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(t,n,r){this.errorEmitter.fire([this.asError(t),n,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(t){return t instanceof Error?t:new Error(`Writer received error. Reason: ${qo.string(t.message)?t.message:"unknown"}`)}};fr.AbstractMessageWriter=xs;var il;(function(e){function t(n){return n===void 0||typeof n=="string"?{charset:n??"utf-8",contentTypeEncoder:(0,wf.default)().applicationJson.encoder}:{charset:n.charset??"utf-8",contentEncoder:n.contentEncoder,contentTypeEncoder:n.contentTypeEncoder??(0,wf.default)().applicationJson.encoder}}e.fromOptions=t})(il||(il={}));var rl=class extends xs{constructor(t,n){super(),this.writable=t,this.options=il.fromOptions(n),this.errorCount=0,this.writeSemaphore=new _b.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(t){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(t,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(bb,r.byteLength.toString(),Cf),i.push(Cf),this.doWrite(t,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(t,n,r){try{return await this.writable.write(n.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,t),Promise.reject(i)}}handleError(t,n){this.errorCount++,this.fireError(t,n,this.errorCount)}end(){this.writable.end()}};fr.WriteableStreamMessageWriter=rl});var Sf=Ye(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.AbstractMessageBuffer=void 0;var yb=13,kb=10,vb=`\r
`,ol=class{constructor(t="utf-8"){this._encoding=t,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(t){let n=typeof t=="string"?this.fromString(t,this._encoding):t;this._chunks.push(n),this._totalLength+=n.byteLength}tryReadHeaders(t=!1){if(this._chunks.length===0)return;let n=0,r=0,i=0,s=0;e:for(;r<this._chunks.length;){let l=this._chunks[r];for(i=0;i<l.length;){switch(l[i]){case yb:switch(n){case 0:n=1;break;case 2:n=3;break;default:n=0}break;case kb:switch(n){case 1:n=2;break;case 3:n=4,i++;break e;default:n=0}break;default:n=0}i++}s+=l.byteLength,r++}if(n!==4)return;let a=this._read(s+i),u=new Map,f=this.toString(a,"ascii").split(vb);if(f.length<2)return u;for(let l=0;l<f.length-2;l++){let c=f[l],g=c.indexOf(":");if(g===-1)throw new Error(`Message header must separate key and value using ':'
${c}`);let k=c.substr(0,g),d=c.substr(g+1).trim();u.set(t?k.toLowerCase():k,d)}return u}tryReadBody(t){if(!(this._totalLength<t))return this._read(t)}get numberOfBytes(){return this._totalLength}_read(t){if(t===0)return this.emptyBuffer();if(t>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===t){let s=this._chunks[0];return this._chunks.shift(),this._totalLength-=t,this.asNative(s)}if(this._chunks[0].byteLength>t){let s=this._chunks[0],a=this.asNative(s,t);return this._chunks[0]=s.slice(t),this._totalLength-=t,a}let n=this.allocNative(t),r=0,i=0;for(;t>0;){let s=this._chunks[i];if(s.byteLength>t){let a=s.slice(0,t);n.set(a,r),r+=t,this._chunks[i]=s.slice(t),this._totalLength-=t,t-=t}else n.set(s,r),r+=s.byteLength,this._chunks.shift(),this._totalLength-=s.byteLength,t-=s.byteLength}return n}};Ds.AbstractMessageBuffer=ol});var Nf=Ye(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});xt.createMessageConnection=xt.ConnectionOptions=xt.MessageStrategy=xt.CancellationStrategy=xt.CancellationSenderStrategy=xt.CancellationReceiverStrategy=xt.RequestCancellationReceiverStrategy=xt.IdCancellationReceiverStrategy=xt.ConnectionStrategy=xt.ConnectionError=xt.ConnectionErrors=xt.LogTraceNotification=xt.SetTraceNotification=xt.TraceFormat=xt.TraceValues=xt.Trace=xt.NullLogger=xt.ProgressType=xt.ProgressToken=void 0;var Ef=lr(),mn=Gr(),mt=qc(),Pf=jc(),Ko=Qr(),sl=ws(),Wo;(function(e){e.type=new mt.NotificationType("$/cancelRequest")})(Wo||(Wo={}));var al;(function(e){function t(n){return typeof n=="string"||typeof n=="number"}e.is=t})(al||(xt.ProgressToken=al={}));var jo;(function(e){e.type=new mt.NotificationType("$/progress")})(jo||(jo={}));var cl=class{constructor(){}};xt.ProgressType=cl;var ll;(function(e){function t(n){return mn.func(n)}e.is=t})(ll||(ll={}));xt.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var Gt;(function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Compact=2]="Compact",e[e.Verbose=3]="Verbose"})(Gt||(xt.Trace=Gt={}));var Of;(function(e){e.Off="off",e.Messages="messages",e.Compact="compact",e.Verbose="verbose"})(Of||(xt.TraceValues=Of={}));(function(e){function t(r){if(!mn.string(r))return e.Off;switch(r=r.toLowerCase(),r){case"off":return e.Off;case"messages":return e.Messages;case"compact":return e.Compact;case"verbose":return e.Verbose;default:return e.Off}}e.fromString=t;function n(r){switch(r){case e.Off:return"off";case e.Messages:return"messages";case e.Compact:return"compact";case e.Verbose:return"verbose";default:return"off"}}e.toString=n})(Gt||(xt.Trace=Gt={}));var ri;(function(e){e.Text="text",e.JSON="json"})(ri||(xt.TraceFormat=ri={}));(function(e){function t(n){return mn.string(n)?(n=n.toLowerCase(),n==="json"?e.JSON:e.Text):e.Text}e.fromString=t})(ri||(xt.TraceFormat=ri={}));var ul;(function(e){e.type=new mt.NotificationType("$/setTrace")})(ul||(xt.SetTraceNotification=ul={}));var Ss;(function(e){e.type=new mt.NotificationType("$/logTrace")})(Ss||(xt.LogTraceNotification=Ss={}));var $o;(function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"})($o||(xt.ConnectionErrors=$o={}));var eo=class e extends Error{constructor(t,n){super(n),this.code=t,Object.setPrototypeOf(this,e.prototype)}};xt.ConnectionError=eo;var fl;(function(e){function t(n){let r=n;return r&&mn.func(r.cancelUndispatched)}e.is=t})(fl||(xt.ConnectionStrategy=fl={}));var Es;(function(e){function t(n){let r=n;return r&&(r.kind===void 0||r.kind==="id")&&mn.func(r.createCancellationTokenSource)&&(r.dispose===void 0||mn.func(r.dispose))}e.is=t})(Es||(xt.IdCancellationReceiverStrategy=Es={}));var dl;(function(e){function t(n){let r=n;return r&&r.kind==="request"&&mn.func(r.createCancellationTokenSource)&&(r.dispose===void 0||mn.func(r.dispose))}e.is=t})(dl||(xt.RequestCancellationReceiverStrategy=dl={}));var Ps;(function(e){e.Message=Object.freeze({createCancellationTokenSource(n){return new sl.CancellationTokenSource}});function t(n){return Es.is(n)||dl.is(n)}e.is=t})(Ps||(xt.CancellationReceiverStrategy=Ps={}));var Os;(function(e){e.Message=Object.freeze({sendCancellation(n,r){return n.sendNotification(Wo.type,{id:r})},cleanup(n){}});function t(n){let r=n;return r&&mn.func(r.sendCancellation)&&mn.func(r.cleanup)}e.is=t})(Os||(xt.CancellationSenderStrategy=Os={}));var As;(function(e){e.Message=Object.freeze({receiver:Ps.Message,sender:Os.Message});function t(n){let r=n;return r&&Ps.is(r.receiver)&&Os.is(r.sender)}e.is=t})(As||(xt.CancellationStrategy=As={}));var Ns;(function(e){function t(n){let r=n;return r&&mn.func(r.handleMessage)}e.is=t})(Ns||(xt.MessageStrategy=Ns={}));var Af;(function(e){function t(n){let r=n;return r&&(As.is(r.cancellationStrategy)||fl.is(r.connectionStrategy)||Ns.is(r.messageStrategy))}e.is=t})(Af||(xt.ConnectionOptions=Af={}));var Ci;(function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"})(Ci||(Ci={}));function Tb(e,t,n,r){let i=n!==void 0?n:xt.NullLogger,s=0,a=0,u=0,f="2.0",l,c=new Map,g,k=new Map,d=new Map,w,I=new Pf.LinkedMap,G=new Map,x=new Set,m=new Map,y=Gt.Off,h=ri.Text,W,_=Ci.New,de=new Ko.Emitter,ye=new Ko.Emitter,pe=new Ko.Emitter,Ve=new Ko.Emitter,le=new Ko.Emitter,N=r&&r.cancellationStrategy?r.cancellationStrategy:As.Message;function V(O){if(O===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+O.toString()}function Re(O){return O===null?"res-unknown-"+(++u).toString():"res-"+O.toString()}function Ce(){return"not-"+(++a).toString()}function xe(O,ue){mt.Message.isRequest(ue)?O.set(V(ue.id),ue):mt.Message.isResponse(ue)?O.set(Re(ue.id),ue):O.set(Ce(),ue)}function R(O){}function pt(){return _===Ci.Listening}function Ut(){return _===Ci.Closed}function De(){return _===Ci.Disposed}function qt(){(_===Ci.New||_===Ci.Listening)&&(_=Ci.Closed,ye.fire(void 0))}function fn(O){de.fire([O,void 0,void 0])}function St(O){de.fire(O)}e.onClose(qt),e.onError(fn),t.onClose(qt),t.onError(St);function Ne(){w||I.size===0||(w=(0,Ef.default)().timer.setImmediate(()=>{w=void 0,wt()}))}function ft(O){mt.Message.isRequest(O)?ct(O):mt.Message.isNotification(O)?ne(O):mt.Message.isResponse(O)?H(O):Ke(O)}function wt(){if(I.size===0)return;let O=I.shift();try{let ue=r?.messageStrategy;Ns.is(ue)?ue.handleMessage(O,ft):ft(O)}finally{Ne()}}let Lt=O=>{try{if(mt.Message.isNotification(O)&&O.method===Wo.type.method){let ue=O.params.id,Ae=V(ue),Ge=I.get(Ae);if(mt.Message.isRequest(Ge)){let Qe=r?.connectionStrategy,yt=Qe&&Qe.cancelUndispatched?Qe.cancelUndispatched(Ge,R):void 0;if(yt&&(yt.error!==void 0||yt.result!==void 0)){I.delete(Ae),m.delete(ue),yt.id=Ge.id,dt(yt,O.method,Date.now()),t.write(yt).catch(()=>i.error("Sending response for canceled message failed."));return}}let Se=m.get(ue);if(Se!==void 0){Se.cancel(),et(O);return}else x.add(ue)}xe(I,O)}finally{Ne()}};function ct(O){if(De())return;function ue(lt,kt,It){let Qt={jsonrpc:f,id:O.id};lt instanceof mt.ResponseError?Qt.error=lt.toJson():Qt.result=lt===void 0?null:lt,dt(Qt,kt,It),t.write(Qt).catch(()=>i.error("Sending response failed."))}function Ae(lt,kt,It){let Qt={jsonrpc:f,id:O.id,error:lt.toJson()};dt(Qt,kt,It),t.write(Qt).catch(()=>i.error("Sending response failed."))}function Ge(lt,kt,It){lt===void 0&&(lt=null);let Qt={jsonrpc:f,id:O.id,result:lt};dt(Qt,kt,It),t.write(Qt).catch(()=>i.error("Sending response failed."))}st(O);let Se=c.get(O.method),Qe,yt;Se&&(Qe=Se.type,yt=Se.handler);let Ft=Date.now();if(yt||l){let lt=O.id??String(Date.now()),kt=Es.is(N.receiver)?N.receiver.createCancellationTokenSource(lt):N.receiver.createCancellationTokenSource(O);O.id!==null&&x.has(O.id)&&kt.cancel(),O.id!==null&&m.set(lt,kt);try{let It;if(yt)if(O.params===void 0){if(Qe!==void 0&&Qe.numberOfParams!==0){Ae(new mt.ResponseError(mt.ErrorCodes.InvalidParams,`Request ${O.method} defines ${Qe.numberOfParams} params but received none.`),O.method,Ft);return}It=yt(kt.token)}else if(Array.isArray(O.params)){if(Qe!==void 0&&Qe.parameterStructures===mt.ParameterStructures.byName){Ae(new mt.ResponseError(mt.ErrorCodes.InvalidParams,`Request ${O.method} defines parameters by name but received parameters by position`),O.method,Ft);return}It=yt(...O.params,kt.token)}else{if(Qe!==void 0&&Qe.parameterStructures===mt.ParameterStructures.byPosition){Ae(new mt.ResponseError(mt.ErrorCodes.InvalidParams,`Request ${O.method} defines parameters by position but received parameters by name`),O.method,Ft);return}It=yt(O.params,kt.token)}else l&&(It=l(O.method,O.params,kt.token));let Qt=It;It?Qt.then?Qt.then(Rn=>{m.delete(lt),ue(Rn,O.method,Ft)},Rn=>{m.delete(lt),Rn instanceof mt.ResponseError?Ae(Rn,O.method,Ft):Rn&&mn.string(Rn.message)?Ae(new mt.ResponseError(mt.ErrorCodes.InternalError,`Request ${O.method} failed with message: ${Rn.message}`),O.method,Ft):Ae(new mt.ResponseError(mt.ErrorCodes.InternalError,`Request ${O.method} failed unexpectedly without providing any details.`),O.method,Ft)}):(m.delete(lt),ue(It,O.method,Ft)):(m.delete(lt),Ge(It,O.method,Ft))}catch(It){m.delete(lt),It instanceof mt.ResponseError?ue(It,O.method,Ft):It&&mn.string(It.message)?Ae(new mt.ResponseError(mt.ErrorCodes.InternalError,`Request ${O.method} failed with message: ${It.message}`),O.method,Ft):Ae(new mt.ResponseError(mt.ErrorCodes.InternalError,`Request ${O.method} failed unexpectedly without providing any details.`),O.method,Ft)}}else Ae(new mt.ResponseError(mt.ErrorCodes.MethodNotFound,`Unhandled method ${O.method}`),O.method,Ft)}function H(O){if(!De())if(O.id===null)O.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(O.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let ue=O.id,Ae=G.get(ue);if(je(O,Ae),Ae!==void 0){G.delete(ue);try{if(O.error){let Ge=O.error;Ae.reject(new mt.ResponseError(Ge.code,Ge.message,Ge.data))}else if(O.result!==void 0)Ae.resolve(O.result);else throw new Error("Should never happen.")}catch(Ge){Ge.message?i.error(`Response handler '${Ae.method}' failed with message: ${Ge.message}`):i.error(`Response handler '${Ae.method}' failed unexpectedly.`)}}}}function ne(O){if(De())return;let ue,Ae;if(O.method===Wo.type.method){let Ge=O.params.id;x.delete(Ge),et(O);return}else{let Ge=k.get(O.method);Ge&&(Ae=Ge.handler,ue=Ge.type)}if(Ae||g)try{if(et(O),Ae)if(O.params===void 0)ue!==void 0&&ue.numberOfParams!==0&&ue.parameterStructures!==mt.ParameterStructures.byName&&i.error(`Notification ${O.method} defines ${ue.numberOfParams} params but received none.`),Ae();else if(Array.isArray(O.params)){let Ge=O.params;O.method===jo.type.method&&Ge.length===2&&al.is(Ge[0])?Ae({token:Ge[0],value:Ge[1]}):(ue!==void 0&&(ue.parameterStructures===mt.ParameterStructures.byName&&i.error(`Notification ${O.method} defines parameters by name but received parameters by position`),ue.numberOfParams!==O.params.length&&i.error(`Notification ${O.method} defines ${ue.numberOfParams} params but received ${Ge.length} arguments`)),Ae(...Ge))}else ue!==void 0&&ue.parameterStructures===mt.ParameterStructures.byPosition&&i.error(`Notification ${O.method} defines parameters by position but received parameters by name`),Ae(O.params);else g&&g(O.method,O.params)}catch(Ge){Ge.message?i.error(`Notification handler '${O.method}' failed with message: ${Ge.message}`):i.error(`Notification handler '${O.method}' failed unexpectedly.`)}else pe.fire(O)}function Ke(O){if(!O){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(O,null,4)}`);let ue=O;if(mn.string(ue.id)||mn.number(ue.id)){let Ae=ue.id,Ge=G.get(Ae);Ge&&Ge.reject(new Error("The received response has neither a result nor an error property."))}}function $e(O){if(O!=null)switch(y){case Gt.Verbose:return JSON.stringify(O,null,4);case Gt.Compact:return JSON.stringify(O);default:return}}function Bt(O){if(!(y===Gt.Off||!W))if(h===ri.Text){let ue;(y===Gt.Verbose||y===Gt.Compact)&&O.params&&(ue=`Params: ${$e(O.params)}

`),W.log(`Sending request '${O.method} - (${O.id})'.`,ue)}else We("send-request",O)}function ke(O){if(!(y===Gt.Off||!W))if(h===ri.Text){let ue;(y===Gt.Verbose||y===Gt.Compact)&&(O.params?ue=`Params: ${$e(O.params)}

`:ue=`No parameters provided.

`),W.log(`Sending notification '${O.method}'.`,ue)}else We("send-notification",O)}function dt(O,ue,Ae){if(!(y===Gt.Off||!W))if(h===ri.Text){let Ge;(y===Gt.Verbose||y===Gt.Compact)&&(O.error&&O.error.data?Ge=`Error data: ${$e(O.error.data)}

`:O.result?Ge=`Result: ${$e(O.result)}

`:O.error===void 0&&(Ge=`No result returned.

`)),W.log(`Sending response '${ue} - (${O.id})'. Processing request took ${Date.now()-Ae}ms`,Ge)}else We("send-response",O)}function st(O){if(!(y===Gt.Off||!W))if(h===ri.Text){let ue;(y===Gt.Verbose||y===Gt.Compact)&&O.params&&(ue=`Params: ${$e(O.params)}

`),W.log(`Received request '${O.method} - (${O.id})'.`,ue)}else We("receive-request",O)}function et(O){if(!(y===Gt.Off||!W||O.method===Ss.type.method))if(h===ri.Text){let ue;(y===Gt.Verbose||y===Gt.Compact)&&(O.params?ue=`Params: ${$e(O.params)}

`:ue=`No parameters provided.

`),W.log(`Received notification '${O.method}'.`,ue)}else We("receive-notification",O)}function je(O,ue){if(!(y===Gt.Off||!W))if(h===ri.Text){let Ae;if((y===Gt.Verbose||y===Gt.Compact)&&(O.error&&O.error.data?Ae=`Error data: ${$e(O.error.data)}

`:O.result?Ae=`Result: ${$e(O.result)}

`:O.error===void 0&&(Ae=`No result returned.

`)),ue){let Ge=O.error?` Request failed: ${O.error.message} (${O.error.code}).`:"";W.log(`Received response '${ue.method} - (${O.id})' in ${Date.now()-ue.timerStart}ms.${Ge}`,Ae)}else W.log(`Received response ${O.id} without active response promise.`,Ae)}else We("receive-response",O)}function We(O,ue){if(!W||y===Gt.Off)return;let Ae={isLSPMessage:!0,type:O,message:ue,timestamp:Date.now()};W.log(Ae)}function Dt(){if(Ut())throw new eo($o.Closed,"Connection is closed.");if(De())throw new eo($o.Disposed,"Connection is disposed.")}function Ht(){if(pt())throw new eo($o.AlreadyListening,"Connection is already listening")}function Jt(){if(!pt())throw new Error("Call listen() first.")}function Ct(O){return O===void 0?null:O}function Xe(O){if(O!==null)return O}function nt(O){return O!=null&&!Array.isArray(O)&&typeof O=="object"}function we(O,ue){switch(O){case mt.ParameterStructures.auto:return nt(ue)?Xe(ue):[Ct(ue)];case mt.ParameterStructures.byName:if(!nt(ue))throw new Error("Received parameters by name but param is not an object literal.");return Xe(ue);case mt.ParameterStructures.byPosition:return[Ct(ue)];default:throw new Error(`Unknown parameter structure ${O.toString()}`)}}function it(O,ue){let Ae,Ge=O.numberOfParams;switch(Ge){case 0:Ae=void 0;break;case 1:Ae=we(O.parameterStructures,ue[0]);break;default:Ae=[];for(let Se=0;Se<ue.length&&Se<Ge;Se++)Ae.push(Ct(ue[Se]));if(ue.length<Ge)for(let Se=ue.length;Se<Ge;Se++)Ae.push(null);break}return Ae}let An={sendNotification:(O,...ue)=>{Dt();let Ae,Ge;if(mn.string(O)){Ae=O;let Qe=ue[0],yt=0,Ft=mt.ParameterStructures.auto;mt.ParameterStructures.is(Qe)&&(yt=1,Ft=Qe);let lt=ue.length,kt=lt-yt;switch(kt){case 0:Ge=void 0;break;case 1:Ge=we(Ft,ue[yt]);break;default:if(Ft===mt.ParameterStructures.byName)throw new Error(`Received ${kt} parameters for 'by Name' notification parameter structure.`);Ge=ue.slice(yt,lt).map(It=>Ct(It));break}}else{let Qe=ue;Ae=O.method,Ge=it(O,Qe)}let Se={jsonrpc:f,method:Ae,params:Ge};return ke(Se),t.write(Se).catch(Qe=>{throw i.error("Sending notification failed."),Qe})},onNotification:(O,ue)=>{Dt();let Ae;return mn.func(O)?g=O:ue&&(mn.string(O)?(Ae=O,k.set(O,{type:void 0,handler:ue})):(Ae=O.method,k.set(O.method,{type:O,handler:ue}))),{dispose:()=>{Ae!==void 0?k.delete(Ae):g=void 0}}},onProgress:(O,ue,Ae)=>{if(d.has(ue))throw new Error(`Progress handler for token ${ue} already registered`);return d.set(ue,Ae),{dispose:()=>{d.delete(ue)}}},sendProgress:(O,ue,Ae)=>An.sendNotification(jo.type,{token:ue,value:Ae}),onUnhandledProgress:Ve.event,sendRequest:(O,...ue)=>{Dt(),Jt();let Ae,Ge,Se;if(mn.string(O)){Ae=O;let lt=ue[0],kt=ue[ue.length-1],It=0,Qt=mt.ParameterStructures.auto;mt.ParameterStructures.is(lt)&&(It=1,Qt=lt);let Rn=ue.length;sl.CancellationToken.is(kt)&&(Rn=Rn-1,Se=kt);let Nn=Rn-It;switch(Nn){case 0:Ge=void 0;break;case 1:Ge=we(Qt,ue[It]);break;default:if(Qt===mt.ParameterStructures.byName)throw new Error(`Received ${Nn} parameters for 'by Name' request parameter structure.`);Ge=ue.slice(It,Rn).map(Zt=>Ct(Zt));break}}else{let lt=ue;Ae=O.method,Ge=it(O,lt);let kt=O.numberOfParams;Se=sl.CancellationToken.is(lt[kt])?lt[kt]:void 0}let Qe=s++,yt;Se&&(yt=Se.onCancellationRequested(()=>{let lt=N.sender.sendCancellation(An,Qe);return lt===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${Qe}`),Promise.resolve()):lt.catch(()=>{i.log(`Sending cancellation messages for id ${Qe} failed`)})}));let Ft={jsonrpc:f,id:Qe,method:Ae,params:Ge};return Bt(Ft),typeof N.sender.enableCancellation=="function"&&N.sender.enableCancellation(Ft),new Promise(async(lt,kt)=>{let It=Nn=>{lt(Nn),N.sender.cleanup(Qe),yt?.dispose()},Qt=Nn=>{kt(Nn),N.sender.cleanup(Qe),yt?.dispose()},Rn={method:Ae,timerStart:Date.now(),resolve:It,reject:Qt};try{await t.write(Ft),G.set(Qe,Rn)}catch(Nn){throw i.error("Sending request failed."),Rn.reject(new mt.ResponseError(mt.ErrorCodes.MessageWriteError,Nn.message?Nn.message:"Unknown reason")),Nn}})},onRequest:(O,ue)=>{Dt();let Ae=null;return ll.is(O)?(Ae=void 0,l=O):mn.string(O)?(Ae=null,ue!==void 0&&(Ae=O,c.set(O,{handler:ue,type:void 0}))):ue!==void 0&&(Ae=O.method,c.set(O.method,{type:O,handler:ue})),{dispose:()=>{Ae!==null&&(Ae!==void 0?c.delete(Ae):l=void 0)}}},hasPendingResponse:()=>G.size>0,trace:async(O,ue,Ae)=>{let Ge=!1,Se=ri.Text;Ae!==void 0&&(mn.boolean(Ae)?Ge=Ae:(Ge=Ae.sendNotification||!1,Se=Ae.traceFormat||ri.Text)),y=O,h=Se,y===Gt.Off?W=void 0:W=ue,Ge&&!Ut()&&!De()&&await An.sendNotification(ul.type,{value:Gt.toString(O)})},onError:de.event,onClose:ye.event,onUnhandledNotification:pe.event,onDispose:le.event,end:()=>{t.end()},dispose:()=>{if(De())return;_=Ci.Disposed,le.fire(void 0);let O=new mt.ResponseError(mt.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let ue of G.values())ue.reject(O);G=new Map,m=new Map,x=new Set,I=new Pf.LinkedMap,mn.func(t.dispose)&&t.dispose(),mn.func(e.dispose)&&e.dispose()},listen:()=>{Dt(),Ht(),_=Ci.Listening,e.listen(Lt)},inspect:()=>{(0,Ef.default)().console.log("inspect")}};return An.onNotification(Ss.type,O=>{if(y===Gt.Off||!W)return;let ue=y===Gt.Verbose||y===Gt.Compact;W.log(O.message,ue?O.verbose:void 0)}),An.onNotification(jo.type,O=>{let ue=d.get(O.token);ue?ue(O.value):Ve.fire(O)}),An}xt.createMessageConnection=Tb});var Ls=Ye(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.ProgressType=fe.ProgressToken=fe.createMessageConnection=fe.NullLogger=fe.ConnectionOptions=fe.ConnectionStrategy=fe.AbstractMessageBuffer=fe.WriteableStreamMessageWriter=fe.AbstractMessageWriter=fe.MessageWriter=fe.ReadableStreamMessageReader=fe.AbstractMessageReader=fe.MessageReader=fe.SharedArrayReceiverStrategy=fe.SharedArraySenderStrategy=fe.CancellationToken=fe.CancellationTokenSource=fe.Emitter=fe.Event=fe.Disposable=fe.LRUCache=fe.Touch=fe.LinkedMap=fe.ParameterStructures=fe.NotificationType9=fe.NotificationType8=fe.NotificationType7=fe.NotificationType6=fe.NotificationType5=fe.NotificationType4=fe.NotificationType3=fe.NotificationType2=fe.NotificationType1=fe.NotificationType0=fe.NotificationType=fe.ErrorCodes=fe.ResponseError=fe.RequestType9=fe.RequestType8=fe.RequestType7=fe.RequestType6=fe.RequestType5=fe.RequestType4=fe.RequestType3=fe.RequestType2=fe.RequestType1=fe.RequestType0=fe.RequestType=fe.Message=fe.RAL=void 0;fe.MessageStrategy=fe.CancellationStrategy=fe.CancellationSenderStrategy=fe.CancellationReceiverStrategy=fe.ConnectionError=fe.ConnectionErrors=fe.LogTraceNotification=fe.SetTraceNotification=fe.TraceFormat=fe.TraceValues=fe.Trace=void 0;var on=qc();Object.defineProperty(fe,"Message",{enumerable:!0,get:function(){return on.Message}});Object.defineProperty(fe,"RequestType",{enumerable:!0,get:function(){return on.RequestType}});Object.defineProperty(fe,"RequestType0",{enumerable:!0,get:function(){return on.RequestType0}});Object.defineProperty(fe,"RequestType1",{enumerable:!0,get:function(){return on.RequestType1}});Object.defineProperty(fe,"RequestType2",{enumerable:!0,get:function(){return on.RequestType2}});Object.defineProperty(fe,"RequestType3",{enumerable:!0,get:function(){return on.RequestType3}});Object.defineProperty(fe,"RequestType4",{enumerable:!0,get:function(){return on.RequestType4}});Object.defineProperty(fe,"RequestType5",{enumerable:!0,get:function(){return on.RequestType5}});Object.defineProperty(fe,"RequestType6",{enumerable:!0,get:function(){return on.RequestType6}});Object.defineProperty(fe,"RequestType7",{enumerable:!0,get:function(){return on.RequestType7}});Object.defineProperty(fe,"RequestType8",{enumerable:!0,get:function(){return on.RequestType8}});Object.defineProperty(fe,"RequestType9",{enumerable:!0,get:function(){return on.RequestType9}});Object.defineProperty(fe,"ResponseError",{enumerable:!0,get:function(){return on.ResponseError}});Object.defineProperty(fe,"ErrorCodes",{enumerable:!0,get:function(){return on.ErrorCodes}});Object.defineProperty(fe,"NotificationType",{enumerable:!0,get:function(){return on.NotificationType}});Object.defineProperty(fe,"NotificationType0",{enumerable:!0,get:function(){return on.NotificationType0}});Object.defineProperty(fe,"NotificationType1",{enumerable:!0,get:function(){return on.NotificationType1}});Object.defineProperty(fe,"NotificationType2",{enumerable:!0,get:function(){return on.NotificationType2}});Object.defineProperty(fe,"NotificationType3",{enumerable:!0,get:function(){return on.NotificationType3}});Object.defineProperty(fe,"NotificationType4",{enumerable:!0,get:function(){return on.NotificationType4}});Object.defineProperty(fe,"NotificationType5",{enumerable:!0,get:function(){return on.NotificationType5}});Object.defineProperty(fe,"NotificationType6",{enumerable:!0,get:function(){return on.NotificationType6}});Object.defineProperty(fe,"NotificationType7",{enumerable:!0,get:function(){return on.NotificationType7}});Object.defineProperty(fe,"NotificationType8",{enumerable:!0,get:function(){return on.NotificationType8}});Object.defineProperty(fe,"NotificationType9",{enumerable:!0,get:function(){return on.NotificationType9}});Object.defineProperty(fe,"ParameterStructures",{enumerable:!0,get:function(){return on.ParameterStructures}});var pl=jc();Object.defineProperty(fe,"LinkedMap",{enumerable:!0,get:function(){return pl.LinkedMap}});Object.defineProperty(fe,"LRUCache",{enumerable:!0,get:function(){return pl.LRUCache}});Object.defineProperty(fe,"Touch",{enumerable:!0,get:function(){return pl.Touch}});var wb=bf();Object.defineProperty(fe,"Disposable",{enumerable:!0,get:function(){return wb.Disposable}});var Lf=Qr();Object.defineProperty(fe,"Event",{enumerable:!0,get:function(){return Lf.Event}});Object.defineProperty(fe,"Emitter",{enumerable:!0,get:function(){return Lf.Emitter}});var Mf=ws();Object.defineProperty(fe,"CancellationTokenSource",{enumerable:!0,get:function(){return Mf.CancellationTokenSource}});Object.defineProperty(fe,"CancellationToken",{enumerable:!0,get:function(){return Mf.CancellationToken}});var Ff=kf();Object.defineProperty(fe,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return Ff.SharedArraySenderStrategy}});Object.defineProperty(fe,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return Ff.SharedArrayReceiverStrategy}});var hl=Tf();Object.defineProperty(fe,"MessageReader",{enumerable:!0,get:function(){return hl.MessageReader}});Object.defineProperty(fe,"AbstractMessageReader",{enumerable:!0,get:function(){return hl.AbstractMessageReader}});Object.defineProperty(fe,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return hl.ReadableStreamMessageReader}});var gl=Df();Object.defineProperty(fe,"MessageWriter",{enumerable:!0,get:function(){return gl.MessageWriter}});Object.defineProperty(fe,"AbstractMessageWriter",{enumerable:!0,get:function(){return gl.AbstractMessageWriter}});Object.defineProperty(fe,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return gl.WriteableStreamMessageWriter}});var Rb=Sf();Object.defineProperty(fe,"AbstractMessageBuffer",{enumerable:!0,get:function(){return Rb.AbstractMessageBuffer}});var Mn=Nf();Object.defineProperty(fe,"ConnectionStrategy",{enumerable:!0,get:function(){return Mn.ConnectionStrategy}});Object.defineProperty(fe,"ConnectionOptions",{enumerable:!0,get:function(){return Mn.ConnectionOptions}});Object.defineProperty(fe,"NullLogger",{enumerable:!0,get:function(){return Mn.NullLogger}});Object.defineProperty(fe,"createMessageConnection",{enumerable:!0,get:function(){return Mn.createMessageConnection}});Object.defineProperty(fe,"ProgressToken",{enumerable:!0,get:function(){return Mn.ProgressToken}});Object.defineProperty(fe,"ProgressType",{enumerable:!0,get:function(){return Mn.ProgressType}});Object.defineProperty(fe,"Trace",{enumerable:!0,get:function(){return Mn.Trace}});Object.defineProperty(fe,"TraceValues",{enumerable:!0,get:function(){return Mn.TraceValues}});Object.defineProperty(fe,"TraceFormat",{enumerable:!0,get:function(){return Mn.TraceFormat}});Object.defineProperty(fe,"SetTraceNotification",{enumerable:!0,get:function(){return Mn.SetTraceNotification}});Object.defineProperty(fe,"LogTraceNotification",{enumerable:!0,get:function(){return Mn.LogTraceNotification}});Object.defineProperty(fe,"ConnectionErrors",{enumerable:!0,get:function(){return Mn.ConnectionErrors}});Object.defineProperty(fe,"ConnectionError",{enumerable:!0,get:function(){return Mn.ConnectionError}});Object.defineProperty(fe,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return Mn.CancellationReceiverStrategy}});Object.defineProperty(fe,"CancellationSenderStrategy",{enumerable:!0,get:function(){return Mn.CancellationSenderStrategy}});Object.defineProperty(fe,"CancellationStrategy",{enumerable:!0,get:function(){return Mn.CancellationStrategy}});Object.defineProperty(fe,"MessageStrategy",{enumerable:!0,get:function(){return Mn.MessageStrategy}});var Cb=lr();fe.RAL=Cb.default});var Kf=Ye(yl=>{"use strict";Object.defineProperty(yl,"__esModule",{value:!0});var If=require("util"),Bi=Ls(),Ms=class e extends Bi.AbstractMessageBuffer{constructor(t="utf-8"){super(t)}emptyBuffer(){return e.emptyBuffer}fromString(t,n){return Buffer.from(t,n)}toString(t,n){return t instanceof Buffer?t.toString(n):new If.TextDecoder(n).decode(t)}asNative(t,n){return n===void 0?t instanceof Buffer?t:Buffer.from(t):t instanceof Buffer?t.slice(0,n):Buffer.from(t,0,n)}allocNative(t){return Buffer.allocUnsafe(t)}};Ms.emptyBuffer=Buffer.allocUnsafe(0);var ml=class{constructor(t){this.stream=t}onClose(t){return this.stream.on("close",t),Bi.Disposable.create(()=>this.stream.off("close",t))}onError(t){return this.stream.on("error",t),Bi.Disposable.create(()=>this.stream.off("error",t))}onEnd(t){return this.stream.on("end",t),Bi.Disposable.create(()=>this.stream.off("end",t))}onData(t){return this.stream.on("data",t),Bi.Disposable.create(()=>this.stream.off("data",t))}},_l=class{constructor(t){this.stream=t}onClose(t){return this.stream.on("close",t),Bi.Disposable.create(()=>this.stream.off("close",t))}onError(t){return this.stream.on("error",t),Bi.Disposable.create(()=>this.stream.off("error",t))}onEnd(t){return this.stream.on("end",t),Bi.Disposable.create(()=>this.stream.off("end",t))}write(t,n){return new Promise((r,i)=>{let s=a=>{a==null?r():i(a)};typeof t=="string"?this.stream.write(t,n,s):this.stream.write(t,s)})}end(){this.stream.end()}},qf=Object.freeze({messageBuffer:Object.freeze({create:e=>new Ms(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(e,void 0,0),t.charset))}catch(n){return Promise.reject(n)}}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{try{return e instanceof Buffer?Promise.resolve(JSON.parse(e.toString(t.charset))):Promise.resolve(JSON.parse(new If.TextDecoder(t.charset).decode(e)))}catch(n){return Promise.reject(n)}}})}),stream:Object.freeze({asReadableStream:e=>new ml(e),asWritableStream:e=>new _l(e)}),console,timer:Object.freeze({setTimeout(e,t,...n){let r=setTimeout(e,t,...n);return{dispose:()=>clearTimeout(r)}},setImmediate(e,...t){let n=setImmediate(e,...t);return{dispose:()=>clearImmediate(n)}},setInterval(e,t,...n){let r=setInterval(e,t,...n);return{dispose:()=>clearInterval(r)}}})});function bl(){return qf}(function(e){function t(){Bi.RAL.install(qf)}e.install=t})(bl||(bl={}));yl.default=bl});var dr=Ye(jt=>{"use strict";var xb=jt&&jt.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Db=jt&&jt.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&xb(t,e,n)};Object.defineProperty(jt,"__esModule",{value:!0});jt.createMessageConnection=jt.createServerSocketTransport=jt.createClientSocketTransport=jt.createServerPipeTransport=jt.createClientPipeTransport=jt.generateRandomPipeName=jt.StreamMessageWriter=jt.StreamMessageReader=jt.SocketMessageWriter=jt.SocketMessageReader=jt.PortMessageWriter=jt.PortMessageReader=jt.IPCMessageWriter=jt.IPCMessageReader=void 0;var to=Kf();to.default.install();var jf=require("path"),Sb=require("os"),Eb=require("crypto"),qs=require("net"),oi=Ls();Db(Ls(),jt);var kl=class extends oi.AbstractMessageReader{constructor(t){super(),this.process=t;let n=this.process;n.on("error",r=>this.fireError(r)),n.on("close",()=>this.fireClose())}listen(t){return this.process.on("message",t),oi.Disposable.create(()=>this.process.off("message",t))}};jt.IPCMessageReader=kl;var vl=class extends oi.AbstractMessageWriter{constructor(t){super(),this.process=t,this.errorCount=0;let n=this.process;n.on("error",r=>this.fireError(r)),n.on("close",()=>this.fireClose)}write(t){try{return typeof this.process.send=="function"&&this.process.send(t,void 0,void 0,n=>{n?(this.errorCount++,this.handleError(n,t)):this.errorCount=0}),Promise.resolve()}catch(n){return this.handleError(n,t),Promise.reject(n)}}handleError(t,n){this.errorCount++,this.fireError(t,n,this.errorCount)}end(){}};jt.IPCMessageWriter=vl;var Tl=class extends oi.AbstractMessageReader{constructor(t){super(),this.onData=new oi.Emitter,t.on("close",()=>this.fireClose),t.on("error",n=>this.fireError(n)),t.on("message",n=>{this.onData.fire(n)})}listen(t){return this.onData.event(t)}};jt.PortMessageReader=Tl;var wl=class extends oi.AbstractMessageWriter{constructor(t){super(),this.port=t,this.errorCount=0,t.on("close",()=>this.fireClose()),t.on("error",n=>this.fireError(n))}write(t){try{return this.port.postMessage(t),Promise.resolve()}catch(n){return this.handleError(n,t),Promise.reject(n)}}handleError(t,n){this.errorCount++,this.fireError(t,n,this.errorCount)}end(){}};jt.PortMessageWriter=wl;var Er=class extends oi.ReadableStreamMessageReader{constructor(t,n="utf-8"){super((0,to.default)().stream.asReadableStream(t),n)}};jt.SocketMessageReader=Er;var Pr=class extends oi.WriteableStreamMessageWriter{constructor(t,n){super((0,to.default)().stream.asWritableStream(t),n),this.socket=t}dispose(){super.dispose(),this.socket.destroy()}};jt.SocketMessageWriter=Pr;var Fs=class extends oi.ReadableStreamMessageReader{constructor(t,n){super((0,to.default)().stream.asReadableStream(t),n)}};jt.StreamMessageReader=Fs;var Is=class extends oi.WriteableStreamMessageWriter{constructor(t,n){super((0,to.default)().stream.asWritableStream(t),n)}};jt.StreamMessageWriter=Is;var $f=process.env.XDG_RUNTIME_DIR,Pb=new Map([["linux",107],["darwin",103]]);function Ob(){let e=(0,Eb.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`;let t;$f?t=jf.join($f,`vscode-ipc-${e}.sock`):t=jf.join(Sb.tmpdir(),`vscode-${e}.sock`);let n=Pb.get(process.platform);return n!==void 0&&t.length>n&&(0,to.default)().console.warn(`WARNING: IPC handle "${t}" is longer than ${n} characters.`),t}jt.generateRandomPipeName=Ob;function Ab(e,t="utf-8"){let n,r=new Promise((i,s)=>{n=i});return new Promise((i,s)=>{let a=(0,qs.createServer)(u=>{a.close(),n([new Er(u,t),new Pr(u,t)])});a.on("error",s),a.listen(e,()=>{a.removeListener("error",s),i({onConnected:()=>r})})})}jt.createClientPipeTransport=Ab;function Nb(e,t="utf-8"){let n=(0,qs.createConnection)(e);return[new Er(n,t),new Pr(n,t)]}jt.createServerPipeTransport=Nb;function Lb(e,t="utf-8"){let n,r=new Promise((i,s)=>{n=i});return new Promise((i,s)=>{let a=(0,qs.createServer)(u=>{a.close(),n([new Er(u,t),new Pr(u,t)])});a.on("error",s),a.listen(e,"127.0.0.1",()=>{a.removeListener("error",s),i({onConnected:()=>r})})})}jt.createClientSocketTransport=Lb;function Mb(e,t="utf-8"){let n=(0,qs.createConnection)(e,"127.0.0.1");return[new Er(n,t),new Pr(n,t)]}jt.createServerSocketTransport=Mb;function Fb(e){let t=e;return t.read!==void 0&&t.addListener!==void 0}function Ib(e){let t=e;return t.write!==void 0&&t.addListener!==void 0}function qb(e,t,n,r){n||(n=oi.NullLogger);let i=Fb(e)?new Fs(e):e,s=Ib(t)?new Is(t):t;return oi.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,oi.createMessageConnection)(i,s,n,r)}jt.createMessageConnection=qb});var Rl=Ye((rv,Wf)=>{"use strict";Wf.exports=dr()});var js=Ye((Vf,Ks)=>{(function(e){if(typeof Ks=="object"&&typeof Ks.exports=="object"){var t=e(require,Vf);t!==void 0&&(Ks.exports=t)}else typeof define=="function"&&define.amd&&define(["require","exports"],e)})(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocument=t.EOL=t.WorkspaceFolder=t.InlineCompletionContext=t.SelectedCompletionInfo=t.InlineCompletionTriggerKind=t.InlineCompletionList=t.InlineCompletionItem=t.StringValue=t.InlayHint=t.InlayHintLabelPart=t.InlayHintKind=t.InlineValueContext=t.InlineValueEvaluatableExpression=t.InlineValueVariableLookup=t.InlineValueText=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.SelectionRange=t.DocumentLink=t.FormattingOptions=t.CodeLens=t.CodeAction=t.CodeActionContext=t.CodeActionTriggerKind=t.CodeActionKind=t.DocumentSymbol=t.WorkspaceSymbol=t.SymbolInformation=t.SymbolTag=t.SymbolKind=t.DocumentHighlight=t.DocumentHighlightKind=t.SignatureInformation=t.ParameterInformation=t.Hover=t.MarkedString=t.CompletionList=t.CompletionItem=t.CompletionItemLabelDetails=t.InsertTextMode=t.InsertReplaceEdit=t.CompletionItemTag=t.InsertTextFormat=t.CompletionItemKind=t.MarkupContent=t.MarkupKind=t.TextDocumentItem=t.OptionalVersionedTextDocumentIdentifier=t.VersionedTextDocumentIdentifier=t.TextDocumentIdentifier=t.WorkspaceChange=t.WorkspaceEdit=t.DeleteFile=t.RenameFile=t.CreateFile=t.TextDocumentEdit=t.AnnotatedTextEdit=t.ChangeAnnotationIdentifier=t.ChangeAnnotation=t.TextEdit=t.Command=t.Diagnostic=t.CodeDescription=t.DiagnosticTag=t.DiagnosticSeverity=t.DiagnosticRelatedInformation=t.FoldingRange=t.FoldingRangeKind=t.ColorPresentation=t.ColorInformation=t.Color=t.LocationLink=t.Location=t.Range=t.Position=t.uinteger=t.integer=t.URI=t.DocumentUri=void 0;var n;(function(v){function F(q){return typeof q=="string"}v.is=F})(n||(t.DocumentUri=n={}));var r;(function(v){function F(q){return typeof q=="string"}v.is=F})(r||(t.URI=r={}));var i;(function(v){v.MIN_VALUE=-2147483648,v.MAX_VALUE=2147483647;function F(q){return typeof q=="number"&&v.MIN_VALUE<=q&&q<=v.MAX_VALUE}v.is=F})(i||(t.integer=i={}));var s;(function(v){v.MIN_VALUE=0,v.MAX_VALUE=2147483647;function F(q){return typeof q=="number"&&v.MIN_VALUE<=q&&q<=v.MAX_VALUE}v.is=F})(s||(t.uinteger=s={}));var a;(function(v){function F(T,b){return T===Number.MAX_VALUE&&(T=s.MAX_VALUE),b===Number.MAX_VALUE&&(b=s.MAX_VALUE),{line:T,character:b}}v.create=F;function q(T){var b=T;return J.objectLiteral(b)&&J.uinteger(b.line)&&J.uinteger(b.character)}v.is=q})(a||(t.Position=a={}));var u;(function(v){function F(T,b,X,he){if(J.uinteger(T)&&J.uinteger(b)&&J.uinteger(X)&&J.uinteger(he))return{start:a.create(T,b),end:a.create(X,he)};if(a.is(T)&&a.is(b))return{start:T,end:b};throw new Error("Range#create called with invalid arguments[".concat(T,", ").concat(b,", ").concat(X,", ").concat(he,"]"))}v.create=F;function q(T){var b=T;return J.objectLiteral(b)&&a.is(b.start)&&a.is(b.end)}v.is=q})(u||(t.Range=u={}));var f;(function(v){function F(T,b){return{uri:T,range:b}}v.create=F;function q(T){var b=T;return J.objectLiteral(b)&&u.is(b.range)&&(J.string(b.uri)||J.undefined(b.uri))}v.is=q})(f||(t.Location=f={}));var l;(function(v){function F(T,b,X,he){return{targetUri:T,targetRange:b,targetSelectionRange:X,originSelectionRange:he}}v.create=F;function q(T){var b=T;return J.objectLiteral(b)&&u.is(b.targetRange)&&J.string(b.targetUri)&&u.is(b.targetSelectionRange)&&(u.is(b.originSelectionRange)||J.undefined(b.originSelectionRange))}v.is=q})(l||(t.LocationLink=l={}));var c;(function(v){function F(T,b,X,he){return{red:T,green:b,blue:X,alpha:he}}v.create=F;function q(T){var b=T;return J.objectLiteral(b)&&J.numberRange(b.red,0,1)&&J.numberRange(b.green,0,1)&&J.numberRange(b.blue,0,1)&&J.numberRange(b.alpha,0,1)}v.is=q})(c||(t.Color=c={}));var g;(function(v){function F(T,b){return{range:T,color:b}}v.create=F;function q(T){var b=T;return J.objectLiteral(b)&&u.is(b.range)&&c.is(b.color)}v.is=q})(g||(t.ColorInformation=g={}));var k;(function(v){function F(T,b,X){return{label:T,textEdit:b,additionalTextEdits:X}}v.create=F;function q(T){var b=T;return J.objectLiteral(b)&&J.string(b.label)&&(J.undefined(b.textEdit)||W.is(b))&&(J.undefined(b.additionalTextEdits)||J.typedArray(b.additionalTextEdits,W.is))}v.is=q})(k||(t.ColorPresentation=k={}));var d;(function(v){v.Comment="comment",v.Imports="imports",v.Region="region"})(d||(t.FoldingRangeKind=d={}));var w;(function(v){function F(T,b,X,he,vt,dn){var Yt={startLine:T,endLine:b};return J.defined(X)&&(Yt.startCharacter=X),J.defined(he)&&(Yt.endCharacter=he),J.defined(vt)&&(Yt.kind=vt),J.defined(dn)&&(Yt.collapsedText=dn),Yt}v.create=F;function q(T){var b=T;return J.objectLiteral(b)&&J.uinteger(b.startLine)&&J.uinteger(b.startLine)&&(J.undefined(b.startCharacter)||J.uinteger(b.startCharacter))&&(J.undefined(b.endCharacter)||J.uinteger(b.endCharacter))&&(J.undefined(b.kind)||J.string(b.kind))}v.is=q})(w||(t.FoldingRange=w={}));var I;(function(v){function F(T,b){return{location:T,message:b}}v.create=F;function q(T){var b=T;return J.defined(b)&&f.is(b.location)&&J.string(b.message)}v.is=q})(I||(t.DiagnosticRelatedInformation=I={}));var G;(function(v){v.Error=1,v.Warning=2,v.Information=3,v.Hint=4})(G||(t.DiagnosticSeverity=G={}));var x;(function(v){v.Unnecessary=1,v.Deprecated=2})(x||(t.DiagnosticTag=x={}));var m;(function(v){function F(q){var T=q;return J.objectLiteral(T)&&J.string(T.href)}v.is=F})(m||(t.CodeDescription=m={}));var y;(function(v){function F(T,b,X,he,vt,dn){var Yt={range:T,message:b};return J.defined(X)&&(Yt.severity=X),J.defined(he)&&(Yt.code=he),J.defined(vt)&&(Yt.source=vt),J.defined(dn)&&(Yt.relatedInformation=dn),Yt}v.create=F;function q(T){var b,X=T;return J.defined(X)&&u.is(X.range)&&J.string(X.message)&&(J.number(X.severity)||J.undefined(X.severity))&&(J.integer(X.code)||J.string(X.code)||J.undefined(X.code))&&(J.undefined(X.codeDescription)||J.string((b=X.codeDescription)===null||b===void 0?void 0:b.href))&&(J.string(X.source)||J.undefined(X.source))&&(J.undefined(X.relatedInformation)||J.typedArray(X.relatedInformation,I.is))}v.is=q})(y||(t.Diagnostic=y={}));var h;(function(v){function F(T,b){for(var X=[],he=2;he<arguments.length;he++)X[he-2]=arguments[he];var vt={title:T,command:b};return J.defined(X)&&X.length>0&&(vt.arguments=X),vt}v.create=F;function q(T){var b=T;return J.defined(b)&&J.string(b.title)&&J.string(b.command)}v.is=q})(h||(t.Command=h={}));var W;(function(v){function F(X,he){return{range:X,newText:he}}v.replace=F;function q(X,he){return{range:{start:X,end:X},newText:he}}v.insert=q;function T(X){return{range:X,newText:""}}v.del=T;function b(X){var he=X;return J.objectLiteral(he)&&J.string(he.newText)&&u.is(he.range)}v.is=b})(W||(t.TextEdit=W={}));var _;(function(v){function F(T,b,X){var he={label:T};return b!==void 0&&(he.needsConfirmation=b),X!==void 0&&(he.description=X),he}v.create=F;function q(T){var b=T;return J.objectLiteral(b)&&J.string(b.label)&&(J.boolean(b.needsConfirmation)||b.needsConfirmation===void 0)&&(J.string(b.description)||b.description===void 0)}v.is=q})(_||(t.ChangeAnnotation=_={}));var de;(function(v){function F(q){var T=q;return J.string(T)}v.is=F})(de||(t.ChangeAnnotationIdentifier=de={}));var ye;(function(v){function F(X,he,vt){return{range:X,newText:he,annotationId:vt}}v.replace=F;function q(X,he,vt){return{range:{start:X,end:X},newText:he,annotationId:vt}}v.insert=q;function T(X,he){return{range:X,newText:"",annotationId:he}}v.del=T;function b(X){var he=X;return W.is(he)&&(_.is(he.annotationId)||de.is(he.annotationId))}v.is=b})(ye||(t.AnnotatedTextEdit=ye={}));var pe;(function(v){function F(T,b){return{textDocument:T,edits:b}}v.create=F;function q(T){var b=T;return J.defined(b)&&Ut.is(b.textDocument)&&Array.isArray(b.edits)}v.is=q})(pe||(t.TextDocumentEdit=pe={}));var Ve;(function(v){function F(T,b,X){var he={kind:"create",uri:T};return b!==void 0&&(b.overwrite!==void 0||b.ignoreIfExists!==void 0)&&(he.options=b),X!==void 0&&(he.annotationId=X),he}v.create=F;function q(T){var b=T;return b&&b.kind==="create"&&J.string(b.uri)&&(b.options===void 0||(b.options.overwrite===void 0||J.boolean(b.options.overwrite))&&(b.options.ignoreIfExists===void 0||J.boolean(b.options.ignoreIfExists)))&&(b.annotationId===void 0||de.is(b.annotationId))}v.is=q})(Ve||(t.CreateFile=Ve={}));var le;(function(v){function F(T,b,X,he){var vt={kind:"rename",oldUri:T,newUri:b};return X!==void 0&&(X.overwrite!==void 0||X.ignoreIfExists!==void 0)&&(vt.options=X),he!==void 0&&(vt.annotationId=he),vt}v.create=F;function q(T){var b=T;return b&&b.kind==="rename"&&J.string(b.oldUri)&&J.string(b.newUri)&&(b.options===void 0||(b.options.overwrite===void 0||J.boolean(b.options.overwrite))&&(b.options.ignoreIfExists===void 0||J.boolean(b.options.ignoreIfExists)))&&(b.annotationId===void 0||de.is(b.annotationId))}v.is=q})(le||(t.RenameFile=le={}));var N;(function(v){function F(T,b,X){var he={kind:"delete",uri:T};return b!==void 0&&(b.recursive!==void 0||b.ignoreIfNotExists!==void 0)&&(he.options=b),X!==void 0&&(he.annotationId=X),he}v.create=F;function q(T){var b=T;return b&&b.kind==="delete"&&J.string(b.uri)&&(b.options===void 0||(b.options.recursive===void 0||J.boolean(b.options.recursive))&&(b.options.ignoreIfNotExists===void 0||J.boolean(b.options.ignoreIfNotExists)))&&(b.annotationId===void 0||de.is(b.annotationId))}v.is=q})(N||(t.DeleteFile=N={}));var V;(function(v){function F(q){var T=q;return T&&(T.changes!==void 0||T.documentChanges!==void 0)&&(T.documentChanges===void 0||T.documentChanges.every(function(b){return J.string(b.kind)?Ve.is(b)||le.is(b)||N.is(b):pe.is(b)}))}v.is=F})(V||(t.WorkspaceEdit=V={}));var Re=function(){function v(F,q){this.edits=F,this.changeAnnotations=q}return v.prototype.insert=function(F,q,T){var b,X;if(T===void 0?b=W.insert(F,q):de.is(T)?(X=T,b=ye.insert(F,q,T)):(this.assertChangeAnnotations(this.changeAnnotations),X=this.changeAnnotations.manage(T),b=ye.insert(F,q,X)),this.edits.push(b),X!==void 0)return X},v.prototype.replace=function(F,q,T){var b,X;if(T===void 0?b=W.replace(F,q):de.is(T)?(X=T,b=ye.replace(F,q,T)):(this.assertChangeAnnotations(this.changeAnnotations),X=this.changeAnnotations.manage(T),b=ye.replace(F,q,X)),this.edits.push(b),X!==void 0)return X},v.prototype.delete=function(F,q){var T,b;if(q===void 0?T=W.del(F):de.is(q)?(b=q,T=ye.del(F,q)):(this.assertChangeAnnotations(this.changeAnnotations),b=this.changeAnnotations.manage(q),T=ye.del(F,b)),this.edits.push(T),b!==void 0)return b},v.prototype.add=function(F){this.edits.push(F)},v.prototype.all=function(){return this.edits},v.prototype.clear=function(){this.edits.splice(0,this.edits.length)},v.prototype.assertChangeAnnotations=function(F){if(F===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},v}(),Ce=function(){function v(F){this._annotations=F===void 0?Object.create(null):F,this._counter=0,this._size=0}return v.prototype.all=function(){return this._annotations},Object.defineProperty(v.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),v.prototype.manage=function(F,q){var T;if(de.is(F)?T=F:(T=this.nextId(),q=F),this._annotations[T]!==void 0)throw new Error("Id ".concat(T," is already in use."));if(q===void 0)throw new Error("No annotation provided for id ".concat(T));return this._annotations[T]=q,this._size++,T},v.prototype.nextId=function(){return this._counter++,this._counter.toString()},v}(),xe=function(){function v(F){var q=this;this._textEditChanges=Object.create(null),F!==void 0?(this._workspaceEdit=F,F.documentChanges?(this._changeAnnotations=new Ce(F.changeAnnotations),F.changeAnnotations=this._changeAnnotations.all(),F.documentChanges.forEach(function(T){if(pe.is(T)){var b=new Re(T.edits,q._changeAnnotations);q._textEditChanges[T.textDocument.uri]=b}})):F.changes&&Object.keys(F.changes).forEach(function(T){var b=new Re(F.changes[T]);q._textEditChanges[T]=b})):this._workspaceEdit={}}return Object.defineProperty(v.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),v.prototype.getTextEditChange=function(F){if(Ut.is(F)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var q={uri:F.uri,version:F.version},T=this._textEditChanges[q.uri];if(!T){var b=[],X={textDocument:q,edits:b};this._workspaceEdit.documentChanges.push(X),T=new Re(b,this._changeAnnotations),this._textEditChanges[q.uri]=T}return T}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var T=this._textEditChanges[F];if(!T){var b=[];this._workspaceEdit.changes[F]=b,T=new Re(b),this._textEditChanges[F]=T}return T}},v.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new Ce,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},v.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},v.prototype.createFile=function(F,q,T){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var b;_.is(q)||de.is(q)?b=q:T=q;var X,he;if(b===void 0?X=Ve.create(F,T):(he=de.is(b)?b:this._changeAnnotations.manage(b),X=Ve.create(F,T,he)),this._workspaceEdit.documentChanges.push(X),he!==void 0)return he},v.prototype.renameFile=function(F,q,T,b){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var X;_.is(T)||de.is(T)?X=T:b=T;var he,vt;if(X===void 0?he=le.create(F,q,b):(vt=de.is(X)?X:this._changeAnnotations.manage(X),he=le.create(F,q,b,vt)),this._workspaceEdit.documentChanges.push(he),vt!==void 0)return vt},v.prototype.deleteFile=function(F,q,T){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var b;_.is(q)||de.is(q)?b=q:T=q;var X,he;if(b===void 0?X=N.create(F,T):(he=de.is(b)?b:this._changeAnnotations.manage(b),X=N.create(F,T,he)),this._workspaceEdit.documentChanges.push(X),he!==void 0)return he},v}();t.WorkspaceChange=xe;var R;(function(v){function F(T){return{uri:T}}v.create=F;function q(T){var b=T;return J.defined(b)&&J.string(b.uri)}v.is=q})(R||(t.TextDocumentIdentifier=R={}));var pt;(function(v){function F(T,b){return{uri:T,version:b}}v.create=F;function q(T){var b=T;return J.defined(b)&&J.string(b.uri)&&J.integer(b.version)}v.is=q})(pt||(t.VersionedTextDocumentIdentifier=pt={}));var Ut;(function(v){function F(T,b){return{uri:T,version:b}}v.create=F;function q(T){var b=T;return J.defined(b)&&J.string(b.uri)&&(b.version===null||J.integer(b.version))}v.is=q})(Ut||(t.OptionalVersionedTextDocumentIdentifier=Ut={}));var De;(function(v){function F(T,b,X,he){return{uri:T,languageId:b,version:X,text:he}}v.create=F;function q(T){var b=T;return J.defined(b)&&J.string(b.uri)&&J.string(b.languageId)&&J.integer(b.version)&&J.string(b.text)}v.is=q})(De||(t.TextDocumentItem=De={}));var qt;(function(v){v.PlainText="plaintext",v.Markdown="markdown";function F(q){var T=q;return T===v.PlainText||T===v.Markdown}v.is=F})(qt||(t.MarkupKind=qt={}));var fn;(function(v){function F(q){var T=q;return J.objectLiteral(q)&&qt.is(T.kind)&&J.string(T.value)}v.is=F})(fn||(t.MarkupContent=fn={}));var St;(function(v){v.Text=1,v.Method=2,v.Function=3,v.Constructor=4,v.Field=5,v.Variable=6,v.Class=7,v.Interface=8,v.Module=9,v.Property=10,v.Unit=11,v.Value=12,v.Enum=13,v.Keyword=14,v.Snippet=15,v.Color=16,v.File=17,v.Reference=18,v.Folder=19,v.EnumMember=20,v.Constant=21,v.Struct=22,v.Event=23,v.Operator=24,v.TypeParameter=25})(St||(t.CompletionItemKind=St={}));var Ne;(function(v){v.PlainText=1,v.Snippet=2})(Ne||(t.InsertTextFormat=Ne={}));var ft;(function(v){v.Deprecated=1})(ft||(t.CompletionItemTag=ft={}));var wt;(function(v){function F(T,b,X){return{newText:T,insert:b,replace:X}}v.create=F;function q(T){var b=T;return b&&J.string(b.newText)&&u.is(b.insert)&&u.is(b.replace)}v.is=q})(wt||(t.InsertReplaceEdit=wt={}));var Lt;(function(v){v.asIs=1,v.adjustIndentation=2})(Lt||(t.InsertTextMode=Lt={}));var ct;(function(v){function F(q){var T=q;return T&&(J.string(T.detail)||T.detail===void 0)&&(J.string(T.description)||T.description===void 0)}v.is=F})(ct||(t.CompletionItemLabelDetails=ct={}));var H;(function(v){function F(q){return{label:q}}v.create=F})(H||(t.CompletionItem=H={}));var ne;(function(v){function F(q,T){return{items:q||[],isIncomplete:!!T}}v.create=F})(ne||(t.CompletionList=ne={}));var Ke;(function(v){function F(T){return T.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}v.fromPlainText=F;function q(T){var b=T;return J.string(b)||J.objectLiteral(b)&&J.string(b.language)&&J.string(b.value)}v.is=q})(Ke||(t.MarkedString=Ke={}));var $e;(function(v){function F(q){var T=q;return!!T&&J.objectLiteral(T)&&(fn.is(T.contents)||Ke.is(T.contents)||J.typedArray(T.contents,Ke.is))&&(q.range===void 0||u.is(q.range))}v.is=F})($e||(t.Hover=$e={}));var Bt;(function(v){function F(q,T){return T?{label:q,documentation:T}:{label:q}}v.create=F})(Bt||(t.ParameterInformation=Bt={}));var ke;(function(v){function F(q,T){for(var b=[],X=2;X<arguments.length;X++)b[X-2]=arguments[X];var he={label:q};return J.defined(T)&&(he.documentation=T),J.defined(b)?he.parameters=b:he.parameters=[],he}v.create=F})(ke||(t.SignatureInformation=ke={}));var dt;(function(v){v.Text=1,v.Read=2,v.Write=3})(dt||(t.DocumentHighlightKind=dt={}));var st;(function(v){function F(q,T){var b={range:q};return J.number(T)&&(b.kind=T),b}v.create=F})(st||(t.DocumentHighlight=st={}));var et;(function(v){v.File=1,v.Module=2,v.Namespace=3,v.Package=4,v.Class=5,v.Method=6,v.Property=7,v.Field=8,v.Constructor=9,v.Enum=10,v.Interface=11,v.Function=12,v.Variable=13,v.Constant=14,v.String=15,v.Number=16,v.Boolean=17,v.Array=18,v.Object=19,v.Key=20,v.Null=21,v.EnumMember=22,v.Struct=23,v.Event=24,v.Operator=25,v.TypeParameter=26})(et||(t.SymbolKind=et={}));var je;(function(v){v.Deprecated=1})(je||(t.SymbolTag=je={}));var We;(function(v){function F(q,T,b,X,he){var vt={name:q,kind:T,location:{uri:X,range:b}};return he&&(vt.containerName=he),vt}v.create=F})(We||(t.SymbolInformation=We={}));var Dt;(function(v){function F(q,T,b,X){return X!==void 0?{name:q,kind:T,location:{uri:b,range:X}}:{name:q,kind:T,location:{uri:b}}}v.create=F})(Dt||(t.WorkspaceSymbol=Dt={}));var Ht;(function(v){function F(T,b,X,he,vt,dn){var Yt={name:T,detail:b,kind:X,range:he,selectionRange:vt};return dn!==void 0&&(Yt.children=dn),Yt}v.create=F;function q(T){var b=T;return b&&J.string(b.name)&&J.number(b.kind)&&u.is(b.range)&&u.is(b.selectionRange)&&(b.detail===void 0||J.string(b.detail))&&(b.deprecated===void 0||J.boolean(b.deprecated))&&(b.children===void 0||Array.isArray(b.children))&&(b.tags===void 0||Array.isArray(b.tags))}v.is=q})(Ht||(t.DocumentSymbol=Ht={}));var Jt;(function(v){v.Empty="",v.QuickFix="quickfix",v.Refactor="refactor",v.RefactorExtract="refactor.extract",v.RefactorInline="refactor.inline",v.RefactorRewrite="refactor.rewrite",v.Source="source",v.SourceOrganizeImports="source.organizeImports",v.SourceFixAll="source.fixAll"})(Jt||(t.CodeActionKind=Jt={}));var Ct;(function(v){v.Invoked=1,v.Automatic=2})(Ct||(t.CodeActionTriggerKind=Ct={}));var Xe;(function(v){function F(T,b,X){var he={diagnostics:T};return b!=null&&(he.only=b),X!=null&&(he.triggerKind=X),he}v.create=F;function q(T){var b=T;return J.defined(b)&&J.typedArray(b.diagnostics,y.is)&&(b.only===void 0||J.typedArray(b.only,J.string))&&(b.triggerKind===void 0||b.triggerKind===Ct.Invoked||b.triggerKind===Ct.Automatic)}v.is=q})(Xe||(t.CodeActionContext=Xe={}));var nt;(function(v){function F(T,b,X){var he={title:T},vt=!0;return typeof b=="string"?(vt=!1,he.kind=b):h.is(b)?he.command=b:he.edit=b,vt&&X!==void 0&&(he.kind=X),he}v.create=F;function q(T){var b=T;return b&&J.string(b.title)&&(b.diagnostics===void 0||J.typedArray(b.diagnostics,y.is))&&(b.kind===void 0||J.string(b.kind))&&(b.edit!==void 0||b.command!==void 0)&&(b.command===void 0||h.is(b.command))&&(b.isPreferred===void 0||J.boolean(b.isPreferred))&&(b.edit===void 0||V.is(b.edit))}v.is=q})(nt||(t.CodeAction=nt={}));var we;(function(v){function F(T,b){var X={range:T};return J.defined(b)&&(X.data=b),X}v.create=F;function q(T){var b=T;return J.defined(b)&&u.is(b.range)&&(J.undefined(b.command)||h.is(b.command))}v.is=q})(we||(t.CodeLens=we={}));var it;(function(v){function F(T,b){return{tabSize:T,insertSpaces:b}}v.create=F;function q(T){var b=T;return J.defined(b)&&J.uinteger(b.tabSize)&&J.boolean(b.insertSpaces)}v.is=q})(it||(t.FormattingOptions=it={}));var An;(function(v){function F(T,b,X){return{range:T,target:b,data:X}}v.create=F;function q(T){var b=T;return J.defined(b)&&u.is(b.range)&&(J.undefined(b.target)||J.string(b.target))}v.is=q})(An||(t.DocumentLink=An={}));var O;(function(v){function F(T,b){return{range:T,parent:b}}v.create=F;function q(T){var b=T;return J.objectLiteral(b)&&u.is(b.range)&&(b.parent===void 0||v.is(b.parent))}v.is=q})(O||(t.SelectionRange=O={}));var ue;(function(v){v.namespace="namespace",v.type="type",v.class="class",v.enum="enum",v.interface="interface",v.struct="struct",v.typeParameter="typeParameter",v.parameter="parameter",v.variable="variable",v.property="property",v.enumMember="enumMember",v.event="event",v.function="function",v.method="method",v.macro="macro",v.keyword="keyword",v.modifier="modifier",v.comment="comment",v.string="string",v.number="number",v.regexp="regexp",v.operator="operator",v.decorator="decorator"})(ue||(t.SemanticTokenTypes=ue={}));var Ae;(function(v){v.declaration="declaration",v.definition="definition",v.readonly="readonly",v.static="static",v.deprecated="deprecated",v.abstract="abstract",v.async="async",v.modification="modification",v.documentation="documentation",v.defaultLibrary="defaultLibrary"})(Ae||(t.SemanticTokenModifiers=Ae={}));var Ge;(function(v){function F(q){var T=q;return J.objectLiteral(T)&&(T.resultId===void 0||typeof T.resultId=="string")&&Array.isArray(T.data)&&(T.data.length===0||typeof T.data[0]=="number")}v.is=F})(Ge||(t.SemanticTokens=Ge={}));var Se;(function(v){function F(T,b){return{range:T,text:b}}v.create=F;function q(T){var b=T;return b!=null&&u.is(b.range)&&J.string(b.text)}v.is=q})(Se||(t.InlineValueText=Se={}));var Qe;(function(v){function F(T,b,X){return{range:T,variableName:b,caseSensitiveLookup:X}}v.create=F;function q(T){var b=T;return b!=null&&u.is(b.range)&&J.boolean(b.caseSensitiveLookup)&&(J.string(b.variableName)||b.variableName===void 0)}v.is=q})(Qe||(t.InlineValueVariableLookup=Qe={}));var yt;(function(v){function F(T,b){return{range:T,expression:b}}v.create=F;function q(T){var b=T;return b!=null&&u.is(b.range)&&(J.string(b.expression)||b.expression===void 0)}v.is=q})(yt||(t.InlineValueEvaluatableExpression=yt={}));var Ft;(function(v){function F(T,b){return{frameId:T,stoppedLocation:b}}v.create=F;function q(T){var b=T;return J.defined(b)&&u.is(T.stoppedLocation)}v.is=q})(Ft||(t.InlineValueContext=Ft={}));var lt;(function(v){v.Type=1,v.Parameter=2;function F(q){return q===1||q===2}v.is=F})(lt||(t.InlayHintKind=lt={}));var kt;(function(v){function F(T){return{value:T}}v.create=F;function q(T){var b=T;return J.objectLiteral(b)&&(b.tooltip===void 0||J.string(b.tooltip)||fn.is(b.tooltip))&&(b.location===void 0||f.is(b.location))&&(b.command===void 0||h.is(b.command))}v.is=q})(kt||(t.InlayHintLabelPart=kt={}));var It;(function(v){function F(T,b,X){var he={position:T,label:b};return X!==void 0&&(he.kind=X),he}v.create=F;function q(T){var b=T;return J.objectLiteral(b)&&a.is(b.position)&&(J.string(b.label)||J.typedArray(b.label,kt.is))&&(b.kind===void 0||lt.is(b.kind))&&b.textEdits===void 0||J.typedArray(b.textEdits,W.is)&&(b.tooltip===void 0||J.string(b.tooltip)||fn.is(b.tooltip))&&(b.paddingLeft===void 0||J.boolean(b.paddingLeft))&&(b.paddingRight===void 0||J.boolean(b.paddingRight))}v.is=q})(It||(t.InlayHint=It={}));var Qt;(function(v){function F(q){return{kind:"snippet",value:q}}v.createSnippet=F})(Qt||(t.StringValue=Qt={}));var Rn;(function(v){function F(q,T,b,X){return{insertText:q,filterText:T,range:b,command:X}}v.create=F})(Rn||(t.InlineCompletionItem=Rn={}));var Nn;(function(v){function F(q){return{items:q}}v.create=F})(Nn||(t.InlineCompletionList=Nn={}));var Zt;(function(v){v.Invoked=0,v.Automatic=1})(Zt||(t.InlineCompletionTriggerKind=Zt={}));var gn;(function(v){function F(q,T){return{range:q,text:T}}v.create=F})(gn||(t.SelectedCompletionInfo=gn={}));var or;(function(v){function F(q,T){return{triggerKind:q,selectedCompletionInfo:T}}v.create=F})(or||(t.InlineCompletionContext=or={}));var zr;(function(v){function F(q){var T=q;return J.objectLiteral(T)&&r.is(T.uri)&&J.string(T.name)}v.is=F})(zr||(t.WorkspaceFolder=zr={})),t.EOL=[`
`,`\r
`,"\r"];var hs;(function(v){function F(X,he,vt,dn){return new uc(X,he,vt,dn)}v.create=F;function q(X){var he=X;return!!(J.defined(he)&&J.string(he.uri)&&(J.undefined(he.languageId)||J.string(he.languageId))&&J.uinteger(he.lineCount)&&J.func(he.getText)&&J.func(he.positionAt)&&J.func(he.offsetAt))}v.is=q;function T(X,he){for(var vt=X.getText(),dn=b(he,function(sr,Dr){var C=sr.range.start.line-Dr.range.start.line;return C===0?sr.range.start.character-Dr.range.start.character:C}),Yt=vt.length,ei=dn.length-1;ei>=0;ei--){var ti=dn[ei],ni=X.offsetAt(ti.range.start),Mt=X.offsetAt(ti.range.end);if(Mt<=Yt)vt=vt.substring(0,ni)+ti.newText+vt.substring(Mt,vt.length);else throw new Error("Overlapping edit");Yt=ni}return vt}v.applyEdits=T;function b(X,he){if(X.length<=1)return X;var vt=X.length/2|0,dn=X.slice(0,vt),Yt=X.slice(vt);b(dn,he),b(Yt,he);for(var ei=0,ti=0,ni=0;ei<dn.length&&ti<Yt.length;){var Mt=he(dn[ei],Yt[ti]);Mt<=0?X[ni++]=dn[ei++]:X[ni++]=Yt[ti++]}for(;ei<dn.length;)X[ni++]=dn[ei++];for(;ti<Yt.length;)X[ni++]=Yt[ti++];return X}})(hs||(t.TextDocument=hs={}));var uc=function(){function v(F,q,T,b){this._uri=F,this._languageId=q,this._version=T,this._content=b,this._lineOffsets=void 0}return Object.defineProperty(v.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),v.prototype.getText=function(F){if(F){var q=this.offsetAt(F.start),T=this.offsetAt(F.end);return this._content.substring(q,T)}return this._content},v.prototype.update=function(F,q){this._content=F.text,this._version=q,this._lineOffsets=void 0},v.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var F=[],q=this._content,T=!0,b=0;b<q.length;b++){T&&(F.push(b),T=!1);var X=q.charAt(b);T=X==="\r"||X===`
`,X==="\r"&&b+1<q.length&&q.charAt(b+1)===`
`&&b++}T&&q.length>0&&F.push(q.length),this._lineOffsets=F}return this._lineOffsets},v.prototype.positionAt=function(F){F=Math.max(Math.min(F,this._content.length),0);var q=this.getLineOffsets(),T=0,b=q.length;if(b===0)return a.create(0,F);for(;T<b;){var X=Math.floor((T+b)/2);q[X]>F?b=X:T=X+1}var he=T-1;return a.create(he,F-q[he])},v.prototype.offsetAt=function(F){var q=this.getLineOffsets();if(F.line>=q.length)return this._content.length;if(F.line<0)return 0;var T=q[F.line],b=F.line+1<q.length?q[F.line+1]:this._content.length;return Math.max(Math.min(T+F.character,b),T)},Object.defineProperty(v.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),v}(),J;(function(v){var F=Object.prototype.toString;function q(Mt){return typeof Mt<"u"}v.defined=q;function T(Mt){return typeof Mt>"u"}v.undefined=T;function b(Mt){return Mt===!0||Mt===!1}v.boolean=b;function X(Mt){return F.call(Mt)==="[object String]"}v.string=X;function he(Mt){return F.call(Mt)==="[object Number]"}v.number=he;function vt(Mt,sr,Dr){return F.call(Mt)==="[object Number]"&&sr<=Mt&&Mt<=Dr}v.numberRange=vt;function dn(Mt){return F.call(Mt)==="[object Number]"&&-2147483648<=Mt&&Mt<=2147483647}v.integer=dn;function Yt(Mt){return F.call(Mt)==="[object Number]"&&0<=Mt&&Mt<=2147483647}v.uinteger=Yt;function ei(Mt){return F.call(Mt)==="[object Function]"}v.func=ei;function ti(Mt){return Mt!==null&&typeof Mt=="object"}v.objectLiteral=ti;function ni(Mt,sr){return Array.isArray(Mt)&&Mt.every(sr)}v.typedArray=ni})(J||(J={}))})});var pn=Ye(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:!0});Qn.ProtocolNotificationType=Qn.ProtocolNotificationType0=Qn.ProtocolRequestType=Qn.ProtocolRequestType0=Qn.RegistrationType=Qn.MessageDirection=void 0;var no=dr(),Uf;(function(e){e.clientToServer="clientToServer",e.serverToClient="serverToClient",e.both="both"})(Uf||(Qn.MessageDirection=Uf={}));var Cl=class{constructor(t){this.method=t}};Qn.RegistrationType=Cl;var xl=class extends no.RequestType0{constructor(t){super(t)}};Qn.ProtocolRequestType0=xl;var Dl=class extends no.RequestType{constructor(t){super(t,no.ParameterStructures.byName)}};Qn.ProtocolRequestType=Dl;var Sl=class extends no.NotificationType0{constructor(t){super(t)}};Qn.ProtocolNotificationType0=Sl;var El=class extends no.NotificationType{constructor(t){super(t,no.ParameterStructures.byName)}};Qn.ProtocolNotificationType=El});var $s=Ye(xn=>{"use strict";Object.defineProperty(xn,"__esModule",{value:!0});xn.objectLiteral=xn.typedArray=xn.stringArray=xn.array=xn.func=xn.error=xn.number=xn.string=xn.boolean=void 0;function Kb(e){return e===!0||e===!1}xn.boolean=Kb;function Bf(e){return typeof e=="string"||e instanceof String}xn.string=Bf;function jb(e){return typeof e=="number"||e instanceof Number}xn.number=jb;function $b(e){return e instanceof Error}xn.error=$b;function Wb(e){return typeof e=="function"}xn.func=Wb;function Hf(e){return Array.isArray(e)}xn.array=Hf;function Vb(e){return Hf(e)&&e.every(t=>Bf(t))}xn.stringArray=Vb;function Ub(e,t){return Array.isArray(e)&&e.every(t)}xn.typedArray=Ub;function Bb(e){return e!==null&&typeof e=="object"}xn.objectLiteral=Bb});var Xf=Ye(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});Ws.ImplementationRequest=void 0;var zf=pn(),Gf;(function(e){e.method="textDocument/implementation",e.messageDirection=zf.MessageDirection.clientToServer,e.type=new zf.ProtocolRequestType(e.method)})(Gf||(Ws.ImplementationRequest=Gf={}))});var Zf=Ye(Vs=>{"use strict";Object.defineProperty(Vs,"__esModule",{value:!0});Vs.TypeDefinitionRequest=void 0;var Qf=pn(),Jf;(function(e){e.method="textDocument/typeDefinition",e.messageDirection=Qf.MessageDirection.clientToServer,e.type=new Qf.ProtocolRequestType(e.method)})(Jf||(Vs.TypeDefinitionRequest=Jf={}))});var td=Ye(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});io.DidChangeWorkspaceFoldersNotification=io.WorkspaceFoldersRequest=void 0;var Us=pn(),Yf;(function(e){e.method="workspace/workspaceFolders",e.messageDirection=Us.MessageDirection.serverToClient,e.type=new Us.ProtocolRequestType0(e.method)})(Yf||(io.WorkspaceFoldersRequest=Yf={}));var ed;(function(e){e.method="workspace/didChangeWorkspaceFolders",e.messageDirection=Us.MessageDirection.clientToServer,e.type=new Us.ProtocolNotificationType(e.method)})(ed||(io.DidChangeWorkspaceFoldersNotification=ed={}))});var rd=Ye(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});Bs.ConfigurationRequest=void 0;var nd=pn(),id;(function(e){e.method="workspace/configuration",e.messageDirection=nd.MessageDirection.serverToClient,e.type=new nd.ProtocolRequestType(e.method)})(id||(Bs.ConfigurationRequest=id={}))});var ad=Ye(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});ro.ColorPresentationRequest=ro.DocumentColorRequest=void 0;var Hs=pn(),od;(function(e){e.method="textDocument/documentColor",e.messageDirection=Hs.MessageDirection.clientToServer,e.type=new Hs.ProtocolRequestType(e.method)})(od||(ro.DocumentColorRequest=od={}));var sd;(function(e){e.method="textDocument/colorPresentation",e.messageDirection=Hs.MessageDirection.clientToServer,e.type=new Hs.ProtocolRequestType(e.method)})(sd||(ro.ColorPresentationRequest=sd={}))});var ud=Ye(oo=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});oo.FoldingRangeRefreshRequest=oo.FoldingRangeRequest=void 0;var zs=pn(),cd;(function(e){e.method="textDocument/foldingRange",e.messageDirection=zs.MessageDirection.clientToServer,e.type=new zs.ProtocolRequestType(e.method)})(cd||(oo.FoldingRangeRequest=cd={}));var ld;(function(e){e.method="workspace/foldingRange/refresh",e.messageDirection=zs.MessageDirection.serverToClient,e.type=new zs.ProtocolRequestType0(e.method)})(ld||(oo.FoldingRangeRefreshRequest=ld={}))});var pd=Ye(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});Gs.DeclarationRequest=void 0;var fd=pn(),dd;(function(e){e.method="textDocument/declaration",e.messageDirection=fd.MessageDirection.clientToServer,e.type=new fd.ProtocolRequestType(e.method)})(dd||(Gs.DeclarationRequest=dd={}))});var md=Ye(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});Xs.SelectionRangeRequest=void 0;var hd=pn(),gd;(function(e){e.method="textDocument/selectionRange",e.messageDirection=hd.MessageDirection.clientToServer,e.type=new hd.ProtocolRequestType(e.method)})(gd||(Xs.SelectionRangeRequest=gd={}))});var kd=Ye(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.WorkDoneProgressCancelNotification=pr.WorkDoneProgressCreateRequest=pr.WorkDoneProgress=void 0;var Hb=dr(),Qs=pn(),_d;(function(e){e.type=new Hb.ProgressType;function t(n){return n===e.type}e.is=t})(_d||(pr.WorkDoneProgress=_d={}));var bd;(function(e){e.method="window/workDoneProgress/create",e.messageDirection=Qs.MessageDirection.serverToClient,e.type=new Qs.ProtocolRequestType(e.method)})(bd||(pr.WorkDoneProgressCreateRequest=bd={}));var yd;(function(e){e.method="window/workDoneProgress/cancel",e.messageDirection=Qs.MessageDirection.clientToServer,e.type=new Qs.ProtocolNotificationType(e.method)})(yd||(pr.WorkDoneProgressCancelNotification=yd={}))});var Rd=Ye(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.CallHierarchyOutgoingCallsRequest=hr.CallHierarchyIncomingCallsRequest=hr.CallHierarchyPrepareRequest=void 0;var so=pn(),vd;(function(e){e.method="textDocument/prepareCallHierarchy",e.messageDirection=so.MessageDirection.clientToServer,e.type=new so.ProtocolRequestType(e.method)})(vd||(hr.CallHierarchyPrepareRequest=vd={}));var Td;(function(e){e.method="callHierarchy/incomingCalls",e.messageDirection=so.MessageDirection.clientToServer,e.type=new so.ProtocolRequestType(e.method)})(Td||(hr.CallHierarchyIncomingCallsRequest=Td={}));var wd;(function(e){e.method="callHierarchy/outgoingCalls",e.messageDirection=so.MessageDirection.clientToServer,e.type=new so.ProtocolRequestType(e.method)})(wd||(hr.CallHierarchyOutgoingCallsRequest=wd={}))});var Pd=Ye(Jn=>{"use strict";Object.defineProperty(Jn,"__esModule",{value:!0});Jn.SemanticTokensRefreshRequest=Jn.SemanticTokensRangeRequest=Jn.SemanticTokensDeltaRequest=Jn.SemanticTokensRequest=Jn.SemanticTokensRegistrationType=Jn.TokenFormat=void 0;var Hi=pn(),Cd;(function(e){e.Relative="relative"})(Cd||(Jn.TokenFormat=Cd={}));var Vo;(function(e){e.method="textDocument/semanticTokens",e.type=new Hi.RegistrationType(e.method)})(Vo||(Jn.SemanticTokensRegistrationType=Vo={}));var xd;(function(e){e.method="textDocument/semanticTokens/full",e.messageDirection=Hi.MessageDirection.clientToServer,e.type=new Hi.ProtocolRequestType(e.method),e.registrationMethod=Vo.method})(xd||(Jn.SemanticTokensRequest=xd={}));var Dd;(function(e){e.method="textDocument/semanticTokens/full/delta",e.messageDirection=Hi.MessageDirection.clientToServer,e.type=new Hi.ProtocolRequestType(e.method),e.registrationMethod=Vo.method})(Dd||(Jn.SemanticTokensDeltaRequest=Dd={}));var Sd;(function(e){e.method="textDocument/semanticTokens/range",e.messageDirection=Hi.MessageDirection.clientToServer,e.type=new Hi.ProtocolRequestType(e.method),e.registrationMethod=Vo.method})(Sd||(Jn.SemanticTokensRangeRequest=Sd={}));var Ed;(function(e){e.method="workspace/semanticTokens/refresh",e.messageDirection=Hi.MessageDirection.serverToClient,e.type=new Hi.ProtocolRequestType0(e.method)})(Ed||(Jn.SemanticTokensRefreshRequest=Ed={}))});var Nd=Ye(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.ShowDocumentRequest=void 0;var Od=pn(),Ad;(function(e){e.method="window/showDocument",e.messageDirection=Od.MessageDirection.serverToClient,e.type=new Od.ProtocolRequestType(e.method)})(Ad||(Js.ShowDocumentRequest=Ad={}))});var Fd=Ye(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});Zs.LinkedEditingRangeRequest=void 0;var Ld=pn(),Md;(function(e){e.method="textDocument/linkedEditingRange",e.messageDirection=Ld.MessageDirection.clientToServer,e.type=new Ld.ProtocolRequestType(e.method)})(Md||(Zs.LinkedEditingRangeRequest=Md={}))});var Ud=Ye(jn=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});jn.WillDeleteFilesRequest=jn.DidDeleteFilesNotification=jn.DidRenameFilesNotification=jn.WillRenameFilesRequest=jn.DidCreateFilesNotification=jn.WillCreateFilesRequest=jn.FileOperationPatternKind=void 0;var pi=pn(),Id;(function(e){e.file="file",e.folder="folder"})(Id||(jn.FileOperationPatternKind=Id={}));var qd;(function(e){e.method="workspace/willCreateFiles",e.messageDirection=pi.MessageDirection.clientToServer,e.type=new pi.ProtocolRequestType(e.method)})(qd||(jn.WillCreateFilesRequest=qd={}));var Kd;(function(e){e.method="workspace/didCreateFiles",e.messageDirection=pi.MessageDirection.clientToServer,e.type=new pi.ProtocolNotificationType(e.method)})(Kd||(jn.DidCreateFilesNotification=Kd={}));var jd;(function(e){e.method="workspace/willRenameFiles",e.messageDirection=pi.MessageDirection.clientToServer,e.type=new pi.ProtocolRequestType(e.method)})(jd||(jn.WillRenameFilesRequest=jd={}));var $d;(function(e){e.method="workspace/didRenameFiles",e.messageDirection=pi.MessageDirection.clientToServer,e.type=new pi.ProtocolNotificationType(e.method)})($d||(jn.DidRenameFilesNotification=$d={}));var Wd;(function(e){e.method="workspace/didDeleteFiles",e.messageDirection=pi.MessageDirection.clientToServer,e.type=new pi.ProtocolNotificationType(e.method)})(Wd||(jn.DidDeleteFilesNotification=Wd={}));var Vd;(function(e){e.method="workspace/willDeleteFiles",e.messageDirection=pi.MessageDirection.clientToServer,e.type=new pi.ProtocolRequestType(e.method)})(Vd||(jn.WillDeleteFilesRequest=Vd={}))});var Xd=Ye(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.MonikerRequest=gr.MonikerKind=gr.UniquenessLevel=void 0;var Bd=pn(),Hd;(function(e){e.document="document",e.project="project",e.group="group",e.scheme="scheme",e.global="global"})(Hd||(gr.UniquenessLevel=Hd={}));var zd;(function(e){e.$import="import",e.$export="export",e.local="local"})(zd||(gr.MonikerKind=zd={}));var Gd;(function(e){e.method="textDocument/moniker",e.messageDirection=Bd.MessageDirection.clientToServer,e.type=new Bd.ProtocolRequestType(e.method)})(Gd||(gr.MonikerRequest=Gd={}))});var Yd=Ye(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.TypeHierarchySubtypesRequest=mr.TypeHierarchySupertypesRequest=mr.TypeHierarchyPrepareRequest=void 0;var ao=pn(),Qd;(function(e){e.method="textDocument/prepareTypeHierarchy",e.messageDirection=ao.MessageDirection.clientToServer,e.type=new ao.ProtocolRequestType(e.method)})(Qd||(mr.TypeHierarchyPrepareRequest=Qd={}));var Jd;(function(e){e.method="typeHierarchy/supertypes",e.messageDirection=ao.MessageDirection.clientToServer,e.type=new ao.ProtocolRequestType(e.method)})(Jd||(mr.TypeHierarchySupertypesRequest=Jd={}));var Zd;(function(e){e.method="typeHierarchy/subtypes",e.messageDirection=ao.MessageDirection.clientToServer,e.type=new ao.ProtocolRequestType(e.method)})(Zd||(mr.TypeHierarchySubtypesRequest=Zd={}))});var np=Ye(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:!0});co.InlineValueRefreshRequest=co.InlineValueRequest=void 0;var Ys=pn(),ep;(function(e){e.method="textDocument/inlineValue",e.messageDirection=Ys.MessageDirection.clientToServer,e.type=new Ys.ProtocolRequestType(e.method)})(ep||(co.InlineValueRequest=ep={}));var tp;(function(e){e.method="workspace/inlineValue/refresh",e.messageDirection=Ys.MessageDirection.serverToClient,e.type=new Ys.ProtocolRequestType0(e.method)})(tp||(co.InlineValueRefreshRequest=tp={}))});var sp=Ye(_r=>{"use strict";Object.defineProperty(_r,"__esModule",{value:!0});_r.InlayHintRefreshRequest=_r.InlayHintResolveRequest=_r.InlayHintRequest=void 0;var lo=pn(),ip;(function(e){e.method="textDocument/inlayHint",e.messageDirection=lo.MessageDirection.clientToServer,e.type=new lo.ProtocolRequestType(e.method)})(ip||(_r.InlayHintRequest=ip={}));var rp;(function(e){e.method="inlayHint/resolve",e.messageDirection=lo.MessageDirection.clientToServer,e.type=new lo.ProtocolRequestType(e.method)})(rp||(_r.InlayHintResolveRequest=rp={}));var op;(function(e){e.method="workspace/inlayHint/refresh",e.messageDirection=lo.MessageDirection.serverToClient,e.type=new lo.ProtocolRequestType0(e.method)})(op||(_r.InlayHintRefreshRequest=op={}))});var pp=Ye(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0});hi.DiagnosticRefreshRequest=hi.WorkspaceDiagnosticRequest=hi.DocumentDiagnosticRequest=hi.DocumentDiagnosticReportKind=hi.DiagnosticServerCancellationData=void 0;var dp=dr(),zb=$s(),uo=pn(),ap;(function(e){function t(n){let r=n;return r&&zb.boolean(r.retriggerRequest)}e.is=t})(ap||(hi.DiagnosticServerCancellationData=ap={}));var cp;(function(e){e.Full="full",e.Unchanged="unchanged"})(cp||(hi.DocumentDiagnosticReportKind=cp={}));var lp;(function(e){e.method="textDocument/diagnostic",e.messageDirection=uo.MessageDirection.clientToServer,e.type=new uo.ProtocolRequestType(e.method),e.partialResult=new dp.ProgressType})(lp||(hi.DocumentDiagnosticRequest=lp={}));var up;(function(e){e.method="workspace/diagnostic",e.messageDirection=uo.MessageDirection.clientToServer,e.type=new uo.ProtocolRequestType(e.method),e.partialResult=new dp.ProgressType})(up||(hi.WorkspaceDiagnosticRequest=up={}));var fp;(function(e){e.method="workspace/diagnostic/refresh",e.messageDirection=uo.MessageDirection.serverToClient,e.type=new uo.ProtocolRequestType0(e.method)})(fp||(hi.DiagnosticRefreshRequest=fp={}))});var kp=Ye(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.DidCloseNotebookDocumentNotification=vn.DidSaveNotebookDocumentNotification=vn.DidChangeNotebookDocumentNotification=vn.NotebookCellArrayChange=vn.DidOpenNotebookDocumentNotification=vn.NotebookDocumentSyncRegistrationType=vn.NotebookDocument=vn.NotebookCell=vn.ExecutionSummary=vn.NotebookCellKind=void 0;var Uo=js(),xi=$s(),Fi=pn(),Pl;(function(e){e.Markup=1,e.Code=2;function t(n){return n===1||n===2}e.is=t})(Pl||(vn.NotebookCellKind=Pl={}));var Ol;(function(e){function t(i,s){let a={executionOrder:i};return(s===!0||s===!1)&&(a.success=s),a}e.create=t;function n(i){let s=i;return xi.objectLiteral(s)&&Uo.uinteger.is(s.executionOrder)&&(s.success===void 0||xi.boolean(s.success))}e.is=n;function r(i,s){return i===s?!0:i==null||s===null||s===void 0?!1:i.executionOrder===s.executionOrder&&i.success===s.success}e.equals=r})(Ol||(vn.ExecutionSummary=Ol={}));var ea;(function(e){function t(s,a){return{kind:s,document:a}}e.create=t;function n(s){let a=s;return xi.objectLiteral(a)&&Pl.is(a.kind)&&Uo.DocumentUri.is(a.document)&&(a.metadata===void 0||xi.objectLiteral(a.metadata))}e.is=n;function r(s,a){let u=new Set;return s.document!==a.document&&u.add("document"),s.kind!==a.kind&&u.add("kind"),s.executionSummary!==a.executionSummary&&u.add("executionSummary"),(s.metadata!==void 0||a.metadata!==void 0)&&!i(s.metadata,a.metadata)&&u.add("metadata"),(s.executionSummary!==void 0||a.executionSummary!==void 0)&&!Ol.equals(s.executionSummary,a.executionSummary)&&u.add("executionSummary"),u}e.diff=r;function i(s,a){if(s===a)return!0;if(s==null||a===null||a===void 0||typeof s!=typeof a||typeof s!="object")return!1;let u=Array.isArray(s),f=Array.isArray(a);if(u!==f)return!1;if(u&&f){if(s.length!==a.length)return!1;for(let l=0;l<s.length;l++)if(!i(s[l],a[l]))return!1}if(xi.objectLiteral(s)&&xi.objectLiteral(a)){let l=Object.keys(s),c=Object.keys(a);if(l.length!==c.length||(l.sort(),c.sort(),!i(l,c)))return!1;for(let g=0;g<l.length;g++){let k=l[g];if(!i(s[k],a[k]))return!1}}return!0}})(ea||(vn.NotebookCell=ea={}));var hp;(function(e){function t(r,i,s,a){return{uri:r,notebookType:i,version:s,cells:a}}e.create=t;function n(r){let i=r;return xi.objectLiteral(i)&&xi.string(i.uri)&&Uo.integer.is(i.version)&&xi.typedArray(i.cells,ea.is)}e.is=n})(hp||(vn.NotebookDocument=hp={}));var fo;(function(e){e.method="notebookDocument/sync",e.messageDirection=Fi.MessageDirection.clientToServer,e.type=new Fi.RegistrationType(e.method)})(fo||(vn.NotebookDocumentSyncRegistrationType=fo={}));var gp;(function(e){e.method="notebookDocument/didOpen",e.messageDirection=Fi.MessageDirection.clientToServer,e.type=new Fi.ProtocolNotificationType(e.method),e.registrationMethod=fo.method})(gp||(vn.DidOpenNotebookDocumentNotification=gp={}));var mp;(function(e){function t(r){let i=r;return xi.objectLiteral(i)&&Uo.uinteger.is(i.start)&&Uo.uinteger.is(i.deleteCount)&&(i.cells===void 0||xi.typedArray(i.cells,ea.is))}e.is=t;function n(r,i,s){let a={start:r,deleteCount:i};return s!==void 0&&(a.cells=s),a}e.create=n})(mp||(vn.NotebookCellArrayChange=mp={}));var _p;(function(e){e.method="notebookDocument/didChange",e.messageDirection=Fi.MessageDirection.clientToServer,e.type=new Fi.ProtocolNotificationType(e.method),e.registrationMethod=fo.method})(_p||(vn.DidChangeNotebookDocumentNotification=_p={}));var bp;(function(e){e.method="notebookDocument/didSave",e.messageDirection=Fi.MessageDirection.clientToServer,e.type=new Fi.ProtocolNotificationType(e.method),e.registrationMethod=fo.method})(bp||(vn.DidSaveNotebookDocumentNotification=bp={}));var yp;(function(e){e.method="notebookDocument/didClose",e.messageDirection=Fi.MessageDirection.clientToServer,e.type=new Fi.ProtocolNotificationType(e.method),e.registrationMethod=fo.method})(yp||(vn.DidCloseNotebookDocumentNotification=yp={}))});var wp=Ye(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.InlineCompletionRequest=void 0;var vp=pn(),Tp;(function(e){e.method="textDocument/inlineCompletion",e.messageDirection=vp.MessageDirection.clientToServer,e.type=new vp.ProtocolRequestType(e.method)})(Tp||(ta.InlineCompletionRequest=Tp={}))});var Fh=Ye(E=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});E.WorkspaceSymbolRequest=E.CodeActionResolveRequest=E.CodeActionRequest=E.DocumentSymbolRequest=E.DocumentHighlightRequest=E.ReferencesRequest=E.DefinitionRequest=E.SignatureHelpRequest=E.SignatureHelpTriggerKind=E.HoverRequest=E.CompletionResolveRequest=E.CompletionRequest=E.CompletionTriggerKind=E.PublishDiagnosticsNotification=E.WatchKind=E.RelativePattern=E.FileChangeType=E.DidChangeWatchedFilesNotification=E.WillSaveTextDocumentWaitUntilRequest=E.WillSaveTextDocumentNotification=E.TextDocumentSaveReason=E.DidSaveTextDocumentNotification=E.DidCloseTextDocumentNotification=E.DidChangeTextDocumentNotification=E.TextDocumentContentChangeEvent=E.DidOpenTextDocumentNotification=E.TextDocumentSyncKind=E.TelemetryEventNotification=E.LogMessageNotification=E.ShowMessageRequest=E.ShowMessageNotification=E.MessageType=E.DidChangeConfigurationNotification=E.ExitNotification=E.ShutdownRequest=E.InitializedNotification=E.InitializeErrorCodes=E.InitializeRequest=E.WorkDoneProgressOptions=E.TextDocumentRegistrationOptions=E.StaticRegistrationOptions=E.PositionEncodingKind=E.FailureHandlingKind=E.ResourceOperationKind=E.UnregistrationRequest=E.RegistrationRequest=E.DocumentSelector=E.NotebookCellTextDocumentFilter=E.NotebookDocumentFilter=E.TextDocumentFilter=void 0;E.MonikerRequest=E.MonikerKind=E.UniquenessLevel=E.WillDeleteFilesRequest=E.DidDeleteFilesNotification=E.WillRenameFilesRequest=E.DidRenameFilesNotification=E.WillCreateFilesRequest=E.DidCreateFilesNotification=E.FileOperationPatternKind=E.LinkedEditingRangeRequest=E.ShowDocumentRequest=E.SemanticTokensRegistrationType=E.SemanticTokensRefreshRequest=E.SemanticTokensRangeRequest=E.SemanticTokensDeltaRequest=E.SemanticTokensRequest=E.TokenFormat=E.CallHierarchyPrepareRequest=E.CallHierarchyOutgoingCallsRequest=E.CallHierarchyIncomingCallsRequest=E.WorkDoneProgressCancelNotification=E.WorkDoneProgressCreateRequest=E.WorkDoneProgress=E.SelectionRangeRequest=E.DeclarationRequest=E.FoldingRangeRefreshRequest=E.FoldingRangeRequest=E.ColorPresentationRequest=E.DocumentColorRequest=E.ConfigurationRequest=E.DidChangeWorkspaceFoldersNotification=E.WorkspaceFoldersRequest=E.TypeDefinitionRequest=E.ImplementationRequest=E.ApplyWorkspaceEditRequest=E.ExecuteCommandRequest=E.PrepareRenameRequest=E.RenameRequest=E.PrepareSupportDefaultBehavior=E.DocumentOnTypeFormattingRequest=E.DocumentRangesFormattingRequest=E.DocumentRangeFormattingRequest=E.DocumentFormattingRequest=E.DocumentLinkResolveRequest=E.DocumentLinkRequest=E.CodeLensRefreshRequest=E.CodeLensResolveRequest=E.CodeLensRequest=E.WorkspaceSymbolResolveRequest=void 0;E.InlineCompletionRequest=E.DidCloseNotebookDocumentNotification=E.DidSaveNotebookDocumentNotification=E.DidChangeNotebookDocumentNotification=E.NotebookCellArrayChange=E.DidOpenNotebookDocumentNotification=E.NotebookDocumentSyncRegistrationType=E.NotebookDocument=E.NotebookCell=E.ExecutionSummary=E.NotebookCellKind=E.DiagnosticRefreshRequest=E.WorkspaceDiagnosticRequest=E.DocumentDiagnosticRequest=E.DocumentDiagnosticReportKind=E.DiagnosticServerCancellationData=E.InlayHintRefreshRequest=E.InlayHintResolveRequest=E.InlayHintRequest=E.InlineValueRefreshRequest=E.InlineValueRequest=E.TypeHierarchySupertypesRequest=E.TypeHierarchySubtypesRequest=E.TypeHierarchyPrepareRequest=void 0;var Ie=pn(),Rp=js(),Pn=$s(),Gb=Xf();Object.defineProperty(E,"ImplementationRequest",{enumerable:!0,get:function(){return Gb.ImplementationRequest}});var Xb=Zf();Object.defineProperty(E,"TypeDefinitionRequest",{enumerable:!0,get:function(){return Xb.TypeDefinitionRequest}});var Ah=td();Object.defineProperty(E,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return Ah.WorkspaceFoldersRequest}});Object.defineProperty(E,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return Ah.DidChangeWorkspaceFoldersNotification}});var Qb=rd();Object.defineProperty(E,"ConfigurationRequest",{enumerable:!0,get:function(){return Qb.ConfigurationRequest}});var Nh=ad();Object.defineProperty(E,"DocumentColorRequest",{enumerable:!0,get:function(){return Nh.DocumentColorRequest}});Object.defineProperty(E,"ColorPresentationRequest",{enumerable:!0,get:function(){return Nh.ColorPresentationRequest}});var Lh=ud();Object.defineProperty(E,"FoldingRangeRequest",{enumerable:!0,get:function(){return Lh.FoldingRangeRequest}});Object.defineProperty(E,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return Lh.FoldingRangeRefreshRequest}});var Jb=pd();Object.defineProperty(E,"DeclarationRequest",{enumerable:!0,get:function(){return Jb.DeclarationRequest}});var Zb=md();Object.defineProperty(E,"SelectionRangeRequest",{enumerable:!0,get:function(){return Zb.SelectionRangeRequest}});var Fl=kd();Object.defineProperty(E,"WorkDoneProgress",{enumerable:!0,get:function(){return Fl.WorkDoneProgress}});Object.defineProperty(E,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return Fl.WorkDoneProgressCreateRequest}});Object.defineProperty(E,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return Fl.WorkDoneProgressCancelNotification}});var Il=Rd();Object.defineProperty(E,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return Il.CallHierarchyIncomingCallsRequest}});Object.defineProperty(E,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return Il.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(E,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return Il.CallHierarchyPrepareRequest}});var po=Pd();Object.defineProperty(E,"TokenFormat",{enumerable:!0,get:function(){return po.TokenFormat}});Object.defineProperty(E,"SemanticTokensRequest",{enumerable:!0,get:function(){return po.SemanticTokensRequest}});Object.defineProperty(E,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return po.SemanticTokensDeltaRequest}});Object.defineProperty(E,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return po.SemanticTokensRangeRequest}});Object.defineProperty(E,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return po.SemanticTokensRefreshRequest}});Object.defineProperty(E,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return po.SemanticTokensRegistrationType}});var Yb=Nd();Object.defineProperty(E,"ShowDocumentRequest",{enumerable:!0,get:function(){return Yb.ShowDocumentRequest}});var ey=Fd();Object.defineProperty(E,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return ey.LinkedEditingRangeRequest}});var Or=Ud();Object.defineProperty(E,"FileOperationPatternKind",{enumerable:!0,get:function(){return Or.FileOperationPatternKind}});Object.defineProperty(E,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Or.DidCreateFilesNotification}});Object.defineProperty(E,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Or.WillCreateFilesRequest}});Object.defineProperty(E,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Or.DidRenameFilesNotification}});Object.defineProperty(E,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Or.WillRenameFilesRequest}});Object.defineProperty(E,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Or.DidDeleteFilesNotification}});Object.defineProperty(E,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Or.WillDeleteFilesRequest}});var ql=Xd();Object.defineProperty(E,"UniquenessLevel",{enumerable:!0,get:function(){return ql.UniquenessLevel}});Object.defineProperty(E,"MonikerKind",{enumerable:!0,get:function(){return ql.MonikerKind}});Object.defineProperty(E,"MonikerRequest",{enumerable:!0,get:function(){return ql.MonikerRequest}});var Kl=Yd();Object.defineProperty(E,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return Kl.TypeHierarchyPrepareRequest}});Object.defineProperty(E,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return Kl.TypeHierarchySubtypesRequest}});Object.defineProperty(E,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return Kl.TypeHierarchySupertypesRequest}});var Mh=np();Object.defineProperty(E,"InlineValueRequest",{enumerable:!0,get:function(){return Mh.InlineValueRequest}});Object.defineProperty(E,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return Mh.InlineValueRefreshRequest}});var jl=sp();Object.defineProperty(E,"InlayHintRequest",{enumerable:!0,get:function(){return jl.InlayHintRequest}});Object.defineProperty(E,"InlayHintResolveRequest",{enumerable:!0,get:function(){return jl.InlayHintResolveRequest}});Object.defineProperty(E,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return jl.InlayHintRefreshRequest}});var Bo=pp();Object.defineProperty(E,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return Bo.DiagnosticServerCancellationData}});Object.defineProperty(E,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return Bo.DocumentDiagnosticReportKind}});Object.defineProperty(E,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return Bo.DocumentDiagnosticRequest}});Object.defineProperty(E,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return Bo.WorkspaceDiagnosticRequest}});Object.defineProperty(E,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return Bo.DiagnosticRefreshRequest}});var Ii=kp();Object.defineProperty(E,"NotebookCellKind",{enumerable:!0,get:function(){return Ii.NotebookCellKind}});Object.defineProperty(E,"ExecutionSummary",{enumerable:!0,get:function(){return Ii.ExecutionSummary}});Object.defineProperty(E,"NotebookCell",{enumerable:!0,get:function(){return Ii.NotebookCell}});Object.defineProperty(E,"NotebookDocument",{enumerable:!0,get:function(){return Ii.NotebookDocument}});Object.defineProperty(E,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return Ii.NotebookDocumentSyncRegistrationType}});Object.defineProperty(E,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return Ii.DidOpenNotebookDocumentNotification}});Object.defineProperty(E,"NotebookCellArrayChange",{enumerable:!0,get:function(){return Ii.NotebookCellArrayChange}});Object.defineProperty(E,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return Ii.DidChangeNotebookDocumentNotification}});Object.defineProperty(E,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return Ii.DidSaveNotebookDocumentNotification}});Object.defineProperty(E,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return Ii.DidCloseNotebookDocumentNotification}});var ty=wp();Object.defineProperty(E,"InlineCompletionRequest",{enumerable:!0,get:function(){return ty.InlineCompletionRequest}});var Al;(function(e){function t(n){let r=n;return Pn.string(r)||Pn.string(r.language)||Pn.string(r.scheme)||Pn.string(r.pattern)}e.is=t})(Al||(E.TextDocumentFilter=Al={}));var Nl;(function(e){function t(n){let r=n;return Pn.objectLiteral(r)&&(Pn.string(r.notebookType)||Pn.string(r.scheme)||Pn.string(r.pattern))}e.is=t})(Nl||(E.NotebookDocumentFilter=Nl={}));var Ll;(function(e){function t(n){let r=n;return Pn.objectLiteral(r)&&(Pn.string(r.notebook)||Nl.is(r.notebook))&&(r.language===void 0||Pn.string(r.language))}e.is=t})(Ll||(E.NotebookCellTextDocumentFilter=Ll={}));var Ml;(function(e){function t(n){if(!Array.isArray(n))return!1;for(let r of n)if(!Pn.string(r)&&!Al.is(r)&&!Ll.is(r))return!1;return!0}e.is=t})(Ml||(E.DocumentSelector=Ml={}));var Cp;(function(e){e.method="client/registerCapability",e.messageDirection=Ie.MessageDirection.serverToClient,e.type=new Ie.ProtocolRequestType(e.method)})(Cp||(E.RegistrationRequest=Cp={}));var xp;(function(e){e.method="client/unregisterCapability",e.messageDirection=Ie.MessageDirection.serverToClient,e.type=new Ie.ProtocolRequestType(e.method)})(xp||(E.UnregistrationRequest=xp={}));var Dp;(function(e){e.Create="create",e.Rename="rename",e.Delete="delete"})(Dp||(E.ResourceOperationKind=Dp={}));var Sp;(function(e){e.Abort="abort",e.Transactional="transactional",e.TextOnlyTransactional="textOnlyTransactional",e.Undo="undo"})(Sp||(E.FailureHandlingKind=Sp={}));var Ep;(function(e){e.UTF8="utf-8",e.UTF16="utf-16",e.UTF32="utf-32"})(Ep||(E.PositionEncodingKind=Ep={}));var Pp;(function(e){function t(n){let r=n;return r&&Pn.string(r.id)&&r.id.length>0}e.hasId=t})(Pp||(E.StaticRegistrationOptions=Pp={}));var Op;(function(e){function t(n){let r=n;return r&&(r.documentSelector===null||Ml.is(r.documentSelector))}e.is=t})(Op||(E.TextDocumentRegistrationOptions=Op={}));var Ap;(function(e){function t(r){let i=r;return Pn.objectLiteral(i)&&(i.workDoneProgress===void 0||Pn.boolean(i.workDoneProgress))}e.is=t;function n(r){let i=r;return i&&Pn.boolean(i.workDoneProgress)}e.hasWorkDoneProgress=n})(Ap||(E.WorkDoneProgressOptions=Ap={}));var Np;(function(e){e.method="initialize",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(Np||(E.InitializeRequest=Np={}));var Lp;(function(e){e.unknownProtocolVersion=1})(Lp||(E.InitializeErrorCodes=Lp={}));var Mp;(function(e){e.method="initialized",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolNotificationType(e.method)})(Mp||(E.InitializedNotification=Mp={}));var Fp;(function(e){e.method="shutdown",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType0(e.method)})(Fp||(E.ShutdownRequest=Fp={}));var Ip;(function(e){e.method="exit",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolNotificationType0(e.method)})(Ip||(E.ExitNotification=Ip={}));var qp;(function(e){e.method="workspace/didChangeConfiguration",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolNotificationType(e.method)})(qp||(E.DidChangeConfigurationNotification=qp={}));var Kp;(function(e){e.Error=1,e.Warning=2,e.Info=3,e.Log=4,e.Debug=5})(Kp||(E.MessageType=Kp={}));var jp;(function(e){e.method="window/showMessage",e.messageDirection=Ie.MessageDirection.serverToClient,e.type=new Ie.ProtocolNotificationType(e.method)})(jp||(E.ShowMessageNotification=jp={}));var $p;(function(e){e.method="window/showMessageRequest",e.messageDirection=Ie.MessageDirection.serverToClient,e.type=new Ie.ProtocolRequestType(e.method)})($p||(E.ShowMessageRequest=$p={}));var Wp;(function(e){e.method="window/logMessage",e.messageDirection=Ie.MessageDirection.serverToClient,e.type=new Ie.ProtocolNotificationType(e.method)})(Wp||(E.LogMessageNotification=Wp={}));var Vp;(function(e){e.method="telemetry/event",e.messageDirection=Ie.MessageDirection.serverToClient,e.type=new Ie.ProtocolNotificationType(e.method)})(Vp||(E.TelemetryEventNotification=Vp={}));var Up;(function(e){e.None=0,e.Full=1,e.Incremental=2})(Up||(E.TextDocumentSyncKind=Up={}));var Bp;(function(e){e.method="textDocument/didOpen",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolNotificationType(e.method)})(Bp||(E.DidOpenTextDocumentNotification=Bp={}));var Hp;(function(e){function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}e.isIncremental=t;function n(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}e.isFull=n})(Hp||(E.TextDocumentContentChangeEvent=Hp={}));var zp;(function(e){e.method="textDocument/didChange",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolNotificationType(e.method)})(zp||(E.DidChangeTextDocumentNotification=zp={}));var Gp;(function(e){e.method="textDocument/didClose",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolNotificationType(e.method)})(Gp||(E.DidCloseTextDocumentNotification=Gp={}));var Xp;(function(e){e.method="textDocument/didSave",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolNotificationType(e.method)})(Xp||(E.DidSaveTextDocumentNotification=Xp={}));var Qp;(function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3})(Qp||(E.TextDocumentSaveReason=Qp={}));var Jp;(function(e){e.method="textDocument/willSave",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolNotificationType(e.method)})(Jp||(E.WillSaveTextDocumentNotification=Jp={}));var Zp;(function(e){e.method="textDocument/willSaveWaitUntil",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(Zp||(E.WillSaveTextDocumentWaitUntilRequest=Zp={}));var Yp;(function(e){e.method="workspace/didChangeWatchedFiles",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolNotificationType(e.method)})(Yp||(E.DidChangeWatchedFilesNotification=Yp={}));var eh;(function(e){e.Created=1,e.Changed=2,e.Deleted=3})(eh||(E.FileChangeType=eh={}));var th;(function(e){function t(n){let r=n;return Pn.objectLiteral(r)&&(Rp.URI.is(r.baseUri)||Rp.WorkspaceFolder.is(r.baseUri))&&Pn.string(r.pattern)}e.is=t})(th||(E.RelativePattern=th={}));var nh;(function(e){e.Create=1,e.Change=2,e.Delete=4})(nh||(E.WatchKind=nh={}));var ih;(function(e){e.method="textDocument/publishDiagnostics",e.messageDirection=Ie.MessageDirection.serverToClient,e.type=new Ie.ProtocolNotificationType(e.method)})(ih||(E.PublishDiagnosticsNotification=ih={}));var rh;(function(e){e.Invoked=1,e.TriggerCharacter=2,e.TriggerForIncompleteCompletions=3})(rh||(E.CompletionTriggerKind=rh={}));var oh;(function(e){e.method="textDocument/completion",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(oh||(E.CompletionRequest=oh={}));var sh;(function(e){e.method="completionItem/resolve",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(sh||(E.CompletionResolveRequest=sh={}));var ah;(function(e){e.method="textDocument/hover",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(ah||(E.HoverRequest=ah={}));var ch;(function(e){e.Invoked=1,e.TriggerCharacter=2,e.ContentChange=3})(ch||(E.SignatureHelpTriggerKind=ch={}));var lh;(function(e){e.method="textDocument/signatureHelp",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(lh||(E.SignatureHelpRequest=lh={}));var uh;(function(e){e.method="textDocument/definition",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(uh||(E.DefinitionRequest=uh={}));var fh;(function(e){e.method="textDocument/references",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(fh||(E.ReferencesRequest=fh={}));var dh;(function(e){e.method="textDocument/documentHighlight",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(dh||(E.DocumentHighlightRequest=dh={}));var ph;(function(e){e.method="textDocument/documentSymbol",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(ph||(E.DocumentSymbolRequest=ph={}));var hh;(function(e){e.method="textDocument/codeAction",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(hh||(E.CodeActionRequest=hh={}));var gh;(function(e){e.method="codeAction/resolve",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(gh||(E.CodeActionResolveRequest=gh={}));var mh;(function(e){e.method="workspace/symbol",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(mh||(E.WorkspaceSymbolRequest=mh={}));var _h;(function(e){e.method="workspaceSymbol/resolve",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(_h||(E.WorkspaceSymbolResolveRequest=_h={}));var bh;(function(e){e.method="textDocument/codeLens",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(bh||(E.CodeLensRequest=bh={}));var yh;(function(e){e.method="codeLens/resolve",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(yh||(E.CodeLensResolveRequest=yh={}));var kh;(function(e){e.method="workspace/codeLens/refresh",e.messageDirection=Ie.MessageDirection.serverToClient,e.type=new Ie.ProtocolRequestType0(e.method)})(kh||(E.CodeLensRefreshRequest=kh={}));var vh;(function(e){e.method="textDocument/documentLink",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(vh||(E.DocumentLinkRequest=vh={}));var Th;(function(e){e.method="documentLink/resolve",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(Th||(E.DocumentLinkResolveRequest=Th={}));var wh;(function(e){e.method="textDocument/formatting",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(wh||(E.DocumentFormattingRequest=wh={}));var Rh;(function(e){e.method="textDocument/rangeFormatting",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(Rh||(E.DocumentRangeFormattingRequest=Rh={}));var Ch;(function(e){e.method="textDocument/rangesFormatting",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(Ch||(E.DocumentRangesFormattingRequest=Ch={}));var xh;(function(e){e.method="textDocument/onTypeFormatting",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(xh||(E.DocumentOnTypeFormattingRequest=xh={}));var Dh;(function(e){e.Identifier=1})(Dh||(E.PrepareSupportDefaultBehavior=Dh={}));var Sh;(function(e){e.method="textDocument/rename",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(Sh||(E.RenameRequest=Sh={}));var Eh;(function(e){e.method="textDocument/prepareRename",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(Eh||(E.PrepareRenameRequest=Eh={}));var Ph;(function(e){e.method="workspace/executeCommand",e.messageDirection=Ie.MessageDirection.clientToServer,e.type=new Ie.ProtocolRequestType(e.method)})(Ph||(E.ExecuteCommandRequest=Ph={}));var Oh;(function(e){e.method="workspace/applyEdit",e.messageDirection=Ie.MessageDirection.serverToClient,e.type=new Ie.ProtocolRequestType("workspace/applyEdit")})(Oh||(E.ApplyWorkspaceEditRequest=Oh={}))});var qh=Ye(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.createProtocolConnection=void 0;var Ih=dr();function ny(e,t,n,r){return Ih.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Ih.createMessageConnection)(e,t,n,r)}na.createProtocolConnection=ny});var jh=Ye(Zn=>{"use strict";var iy=Zn&&Zn.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),ia=Zn&&Zn.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&iy(t,e,n)};Object.defineProperty(Zn,"__esModule",{value:!0});Zn.LSPErrorCodes=Zn.createProtocolConnection=void 0;ia(dr(),Zn);ia(js(),Zn);ia(pn(),Zn);ia(Fh(),Zn);var ry=qh();Object.defineProperty(Zn,"createProtocolConnection",{enumerable:!0,get:function(){return ry.createProtocolConnection}});var Kh;(function(e){e.lspReservedErrorRangeStart=-32899,e.RequestFailed=-32803,e.ServerCancelled=-32802,e.ContentModified=-32801,e.RequestCancelled=-32800,e.lspReservedErrorRangeEnd=-32800})(Kh||(Zn.LSPErrorCodes=Kh={}))});var Tn=Ye(qi=>{"use strict";var oy=qi&&qi.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),$h=qi&&qi.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&oy(t,e,n)};Object.defineProperty(qi,"__esModule",{value:!0});qi.createProtocolConnection=void 0;var sy=Rl();$h(Rl(),qi);$h(jh(),qi);function ay(e,t,n,r){return(0,sy.createMessageConnection)(e,t,n,r)}qi.createProtocolConnection=ay});var $l=Ye(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});gi.generateUuid=gi.parse=gi.isUUID=gi.v4=gi.empty=void 0;var Ho=class{constructor(t){this._value=t}asHex(){return this._value}equals(t){return this.asHex()===t.asHex()}},zo=class e extends Ho{static _oneOf(t){return t[Math.floor(t.length*Math.random())]}static _randomHex(){return e._oneOf(e._chars)}constructor(){super([e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-","4",e._randomHex(),e._randomHex(),e._randomHex(),"-",e._oneOf(e._timeHighBits),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex()].join(""))}};zo._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];zo._timeHighBits=["8","9","a","b"];gi.empty=new Ho("00000000-0000-0000-0000-000000000000");function Wh(){return new zo}gi.v4=Wh;var cy=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Vh(e){return cy.test(e)}gi.isUUID=Vh;function ly(e){if(!Vh(e))throw new Error("invalid uuid");return new Ho(e)}gi.parse=ly;function uy(){return Wh().asHex()}gi.generateUuid=uy});var Uh=Ye(yr=>{"use strict";Object.defineProperty(yr,"__esModule",{value:!0});yr.attachPartialResult=yr.ProgressFeature=yr.attachWorkDone=void 0;var br=Tn(),fy=$l(),Ar=class e{constructor(t,n){this._connection=t,this._token=n,e.Instances.set(this._token,this)}begin(t,n,r,i){let s={kind:"begin",title:t,percentage:n,message:r,cancellable:i};this._connection.sendProgress(br.WorkDoneProgress.type,this._token,s)}report(t,n){let r={kind:"report"};typeof t=="number"?(r.percentage=t,n!==void 0&&(r.message=n)):r.message=t,this._connection.sendProgress(br.WorkDoneProgress.type,this._token,r)}done(){e.Instances.delete(this._token),this._connection.sendProgress(br.WorkDoneProgress.type,this._token,{kind:"end"})}};Ar.Instances=new Map;var ra=class extends Ar{constructor(t,n){super(t,n),this._source=new br.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}},Go=class{constructor(){}begin(){}report(){}done(){}},oa=class extends Go{constructor(){super(),this._source=new br.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}};function dy(e,t){if(t===void 0||t.workDoneToken===void 0)return new Go;let n=t.workDoneToken;return delete t.workDoneToken,new Ar(e,n)}yr.attachWorkDone=dy;var py=e=>class extends e{constructor(){super(),this._progressSupported=!1}initialize(t){super.initialize(t),t?.window?.workDoneProgress===!0&&(this._progressSupported=!0,this.connection.onNotification(br.WorkDoneProgressCancelNotification.type,n=>{let r=Ar.Instances.get(n.token);(r instanceof ra||r instanceof oa)&&r.cancel()}))}attachWorkDoneProgress(t){return t===void 0?new Go:new Ar(this.connection,t)}createWorkDoneProgress(){if(this._progressSupported){let t=(0,fy.generateUuid)();return this.connection.sendRequest(br.WorkDoneProgressCreateRequest.type,{token:t}).then(()=>new ra(this.connection,t))}else return Promise.resolve(new oa)}};yr.ProgressFeature=py;var Wl;(function(e){e.type=new br.ProgressType})(Wl||(Wl={}));var Vl=class{constructor(t,n){this._connection=t,this._token=n}report(t){this._connection.sendProgress(Wl.type,this._token,t)}};function hy(e,t){if(t===void 0||t.partialResultToken===void 0)return;let n=t.partialResultToken;return delete t.partialResultToken,new Vl(e,n)}yr.attachPartialResult=hy});var Bh=Ye(sa=>{"use strict";Object.defineProperty(sa,"__esModule",{value:!0});sa.ConfigurationFeature=void 0;var gy=Tn(),my=_s(),_y=e=>class extends e{getConfiguration(t){return t?my.string(t)?this._getConfiguration({section:t}):this._getConfiguration(t):this._getConfiguration({})}_getConfiguration(t){let n={items:Array.isArray(t)?t:[t]};return this.connection.sendRequest(gy.ConfigurationRequest.type,n).then(r=>Array.isArray(r)?Array.isArray(t)?r:r[0]:Array.isArray(t)?[]:null)}};sa.ConfigurationFeature=_y});var Hh=Ye(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});ca.WorkspaceFoldersFeature=void 0;var aa=Tn(),by=e=>class extends e{constructor(){super(),this._notificationIsAutoRegistered=!1}initialize(t){super.initialize(t);let n=t.workspace;n&&n.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new aa.Emitter,this.connection.onNotification(aa.DidChangeWorkspaceFoldersNotification.type,r=>{this._onDidChangeWorkspaceFolders.fire(r.event)}))}fillServerCapabilities(t){super.fillServerCapabilities(t);let n=t.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=n===!0||typeof n=="string"}getWorkspaceFolders(){return this.connection.sendRequest(aa.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return!this._notificationIsAutoRegistered&&!this._unregistration&&(this._unregistration=this.connection.client.register(aa.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}};ca.WorkspaceFoldersFeature=by});var zh=Ye(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.CallHierarchyFeature=void 0;var Ul=Tn(),yy=e=>class extends e{get callHierarchy(){return{onPrepare:t=>this.connection.onRequest(Ul.CallHierarchyPrepareRequest.type,(n,r)=>t(n,r,this.attachWorkDoneProgress(n),void 0)),onIncomingCalls:t=>{let n=Ul.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(n,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))},onOutgoingCalls:t=>{let n=Ul.CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(n,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};la.CallHierarchyFeature=yy});var Hl=Ye(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.SemanticTokensBuilder=kr.SemanticTokensDiff=kr.SemanticTokensFeature=void 0;var ua=Tn(),ky=e=>class extends e{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(ua.SemanticTokensRefreshRequest.type),on:t=>{let n=ua.SemanticTokensRequest.type;return this.connection.onRequest(n,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))},onDelta:t=>{let n=ua.SemanticTokensDeltaRequest.type;return this.connection.onRequest(n,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))},onRange:t=>{let n=ua.SemanticTokensRangeRequest.type;return this.connection.onRequest(n,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};kr.SemanticTokensFeature=ky;var fa=class{constructor(t,n){this.originalSequence=t,this.modifiedSequence=n}computeDiff(){let t=this.originalSequence.length,n=this.modifiedSequence.length,r=0;for(;r<n&&r<t&&this.originalSequence[r]===this.modifiedSequence[r];)r++;if(r<n&&r<t){let i=t-1,s=n-1;for(;i>=r&&s>=r&&this.originalSequence[i]===this.modifiedSequence[s];)i--,s--;(i<r||s<r)&&(i++,s++);let a=i-r+1,u=this.modifiedSequence.slice(r,s+1);return u.length===1&&u[0]===this.originalSequence[i]?[{start:r,deleteCount:a-1}]:[{start:r,deleteCount:a,data:u}]}else return r<n?[{start:r,deleteCount:0,data:this.modifiedSequence.slice(r)}]:r<t?[{start:r,deleteCount:t-r}]:[]}};kr.SemanticTokensDiff=fa;var Bl=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(t,n,r,i,s){let a=t,u=n;this._dataLen>0&&(a-=this._prevLine,a===0&&(u-=this._prevChar)),this._data[this._dataLen++]=a,this._data[this._dataLen++]=u,this._data[this._dataLen++]=r,this._data[this._dataLen++]=i,this._data[this._dataLen++]=s,this._prevLine=t,this._prevChar=n}get id(){return this._id.toString()}previousResult(t){this.id===t&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return this._prevData!==void 0}buildEdits(){return this._prevData!==void 0?{resultId:this.id,edits:new fa(this._prevData,this._data).computeDiff()}:this.build()}};kr.SemanticTokensBuilder=Bl});var Gh=Ye(da=>{"use strict";Object.defineProperty(da,"__esModule",{value:!0});da.ShowDocumentFeature=void 0;var vy=Tn(),Ty=e=>class extends e{showDocument(t){return this.connection.sendRequest(vy.ShowDocumentRequest.type,t)}};da.ShowDocumentFeature=Ty});var Xh=Ye(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.FileOperationsFeature=void 0;var ho=Tn(),wy=e=>class extends e{onDidCreateFiles(t){return this.connection.onNotification(ho.DidCreateFilesNotification.type,n=>{t(n)})}onDidRenameFiles(t){return this.connection.onNotification(ho.DidRenameFilesNotification.type,n=>{t(n)})}onDidDeleteFiles(t){return this.connection.onNotification(ho.DidDeleteFilesNotification.type,n=>{t(n)})}onWillCreateFiles(t){return this.connection.onRequest(ho.WillCreateFilesRequest.type,(n,r)=>t(n,r))}onWillRenameFiles(t){return this.connection.onRequest(ho.WillRenameFilesRequest.type,(n,r)=>t(n,r))}onWillDeleteFiles(t){return this.connection.onRequest(ho.WillDeleteFilesRequest.type,(n,r)=>t(n,r))}};pa.FileOperationsFeature=wy});var Qh=Ye(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.LinkedEditingRangeFeature=void 0;var Ry=Tn(),Cy=e=>class extends e{onLinkedEditingRange(t){return this.connection.onRequest(Ry.LinkedEditingRangeRequest.type,(n,r)=>t(n,r,this.attachWorkDoneProgress(n),void 0))}};ha.LinkedEditingRangeFeature=Cy});var Jh=Ye(ga=>{"use strict";Object.defineProperty(ga,"__esModule",{value:!0});ga.TypeHierarchyFeature=void 0;var zl=Tn(),xy=e=>class extends e{get typeHierarchy(){return{onPrepare:t=>this.connection.onRequest(zl.TypeHierarchyPrepareRequest.type,(n,r)=>t(n,r,this.attachWorkDoneProgress(n),void 0)),onSupertypes:t=>{let n=zl.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(n,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))},onSubtypes:t=>{let n=zl.TypeHierarchySubtypesRequest.type;return this.connection.onRequest(n,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};ga.TypeHierarchyFeature=xy});var Yh=Ye(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.InlineValueFeature=void 0;var Zh=Tn(),Dy=e=>class extends e{get inlineValue(){return{refresh:()=>this.connection.sendRequest(Zh.InlineValueRefreshRequest.type),on:t=>this.connection.onRequest(Zh.InlineValueRequest.type,(n,r)=>t(n,r,this.attachWorkDoneProgress(n)))}}};ma.InlineValueFeature=Dy});var tg=Ye(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});_a.FoldingRangeFeature=void 0;var eg=Tn(),Sy=e=>class extends e{get foldingRange(){return{refresh:()=>this.connection.sendRequest(eg.FoldingRangeRefreshRequest.type),on:t=>{let n=eg.FoldingRangeRequest.type;return this.connection.onRequest(n,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};_a.FoldingRangeFeature=Sy});var ng=Ye(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.InlayHintFeature=void 0;var Gl=Tn(),Ey=e=>class extends e{get inlayHint(){return{refresh:()=>this.connection.sendRequest(Gl.InlayHintRefreshRequest.type),on:t=>this.connection.onRequest(Gl.InlayHintRequest.type,(n,r)=>t(n,r,this.attachWorkDoneProgress(n))),resolve:t=>this.connection.onRequest(Gl.InlayHintResolveRequest.type,(n,r)=>t(n,r))}}};ba.InlayHintFeature=Ey});var ig=Ye(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});ya.DiagnosticFeature=void 0;var Xo=Tn(),Py=e=>class extends e{get diagnostics(){return{refresh:()=>this.connection.sendRequest(Xo.DiagnosticRefreshRequest.type),on:t=>this.connection.onRequest(Xo.DocumentDiagnosticRequest.type,(n,r)=>t(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(Xo.DocumentDiagnosticRequest.partialResult,n))),onWorkspace:t=>this.connection.onRequest(Xo.WorkspaceDiagnosticRequest.type,(n,r)=>t(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(Xo.WorkspaceDiagnosticRequest.partialResult,n)))}}};ya.DiagnosticFeature=Py});var Ql=Ye(ka=>{"use strict";Object.defineProperty(ka,"__esModule",{value:!0});ka.TextDocuments=void 0;var Nr=Tn(),Xl=class{constructor(t){this._configuration=t,this._syncedDocuments=new Map,this._onDidChangeContent=new Nr.Emitter,this._onDidOpen=new Nr.Emitter,this._onDidClose=new Nr.Emitter,this._onDidSave=new Nr.Emitter,this._onWillSave=new Nr.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(t){this._willSaveWaitUntil=t}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(t){return this._syncedDocuments.get(t)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(t){t.__textDocumentSync=Nr.TextDocumentSyncKind.Incremental;let n=[];return n.push(t.onDidOpenTextDocument(r=>{let i=r.textDocument,s=this._configuration.create(i.uri,i.languageId,i.version,i.text);this._syncedDocuments.set(i.uri,s);let a=Object.freeze({document:s});this._onDidOpen.fire(a),this._onDidChangeContent.fire(a)})),n.push(t.onDidChangeTextDocument(r=>{let i=r.textDocument,s=r.contentChanges;if(s.length===0)return;let{version:a}=i;if(a==null)throw new Error(`Received document change event for ${i.uri} without valid version identifier`);let u=this._syncedDocuments.get(i.uri);u!==void 0&&(u=this._configuration.update(u,s,a),this._syncedDocuments.set(i.uri,u),this._onDidChangeContent.fire(Object.freeze({document:u})))})),n.push(t.onDidCloseTextDocument(r=>{let i=this._syncedDocuments.get(r.textDocument.uri);i!==void 0&&(this._syncedDocuments.delete(r.textDocument.uri),this._onDidClose.fire(Object.freeze({document:i})))})),n.push(t.onWillSaveTextDocument(r=>{let i=this._syncedDocuments.get(r.textDocument.uri);i!==void 0&&this._onWillSave.fire(Object.freeze({document:i,reason:r.reason}))})),n.push(t.onWillSaveTextDocumentWaitUntil((r,i)=>{let s=this._syncedDocuments.get(r.textDocument.uri);return s!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:s,reason:r.reason}),i):[]})),n.push(t.onDidSaveTextDocument(r=>{let i=this._syncedDocuments.get(r.textDocument.uri);i!==void 0&&this._onDidSave.fire(Object.freeze({document:i}))})),Nr.Disposable.create(()=>{n.forEach(r=>r.dispose())})}};ka.TextDocuments=Xl});var Zl=Ye(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.NotebookDocuments=go.NotebookSyncFeature=void 0;var mi=Tn(),rg=Ql(),Oy=e=>class extends e{get synchronization(){return{onDidOpenNotebookDocument:t=>this.connection.onNotification(mi.DidOpenNotebookDocumentNotification.type,n=>{t(n)}),onDidChangeNotebookDocument:t=>this.connection.onNotification(mi.DidChangeNotebookDocumentNotification.type,n=>{t(n)}),onDidSaveNotebookDocument:t=>this.connection.onNotification(mi.DidSaveNotebookDocumentNotification.type,n=>{t(n)}),onDidCloseNotebookDocument:t=>this.connection.onNotification(mi.DidCloseNotebookDocumentNotification.type,n=>{t(n)})}}};go.NotebookSyncFeature=Oy;var va=class e{onDidOpenTextDocument(t){return this.openHandler=t,mi.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(t){this.openHandler&&this.openHandler(t)}onDidChangeTextDocument(t){return this.changeHandler=t,mi.Disposable.create(()=>{this.changeHandler=t})}changeTextDocument(t){this.changeHandler&&this.changeHandler(t)}onDidCloseTextDocument(t){return this.closeHandler=t,mi.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(t){this.closeHandler&&this.closeHandler(t)}onWillSaveTextDocument(){return e.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return e.NULL_DISPOSE}onDidSaveTextDocument(){return e.NULL_DISPOSE}};va.NULL_DISPOSE=Object.freeze({dispose:()=>{}});var Jl=class{constructor(t){t instanceof rg.TextDocuments?this._cellTextDocuments=t:this._cellTextDocuments=new rg.TextDocuments(t),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new mi.Emitter,this._onDidChange=new mi.Emitter,this._onDidSave=new mi.Emitter,this._onDidClose=new mi.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(t){return this._cellTextDocuments.get(t.document)}getNotebookDocument(t){return this.notebookDocuments.get(t)}getNotebookCell(t){let n=this.notebookCellMap.get(t);return n&&n[0]}findNotebookDocumentForCell(t){let n=typeof t=="string"?t:t.document,r=this.notebookCellMap.get(n);return r&&r[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(t){let n=new va,r=[];return r.push(this.cellTextDocuments.listen(n)),r.push(t.notebooks.synchronization.onDidOpenNotebookDocument(i=>{this.notebookDocuments.set(i.notebookDocument.uri,i.notebookDocument);for(let s of i.cellTextDocuments)n.openTextDocument({textDocument:s});this.updateCellMap(i.notebookDocument),this._onDidOpen.fire(i.notebookDocument)})),r.push(t.notebooks.synchronization.onDidChangeNotebookDocument(i=>{let s=this.notebookDocuments.get(i.notebookDocument.uri);if(s===void 0)return;s.version=i.notebookDocument.version;let a=s.metadata,u=!1,f=i.change;f.metadata!==void 0&&(u=!0,s.metadata=f.metadata);let l=[],c=[],g=[],k=[];if(f.cells!==void 0){let x=f.cells;if(x.structure!==void 0){let m=x.structure.array;if(s.cells.splice(m.start,m.deleteCount,...m.cells!==void 0?m.cells:[]),x.structure.didOpen!==void 0)for(let y of x.structure.didOpen)n.openTextDocument({textDocument:y}),l.push(y.uri);if(x.structure.didClose)for(let y of x.structure.didClose)n.closeTextDocument({textDocument:y}),c.push(y.uri)}if(x.data!==void 0){let m=new Map(x.data.map(y=>[y.document,y]));for(let y=0;y<=s.cells.length;y++){let h=m.get(s.cells[y].document);if(h!==void 0){let W=s.cells.splice(y,1,h);if(g.push({old:W[0],new:h}),m.delete(h.document),m.size===0)break}}}if(x.textContent!==void 0)for(let m of x.textContent)n.changeTextDocument({textDocument:m.document,contentChanges:m.changes}),k.push(m.document.uri)}this.updateCellMap(s);let d={notebookDocument:s};u&&(d.metadata={old:a,new:s.metadata});let w=[];for(let x of l)w.push(this.getNotebookCell(x));let I=[];for(let x of c)I.push(this.getNotebookCell(x));let G=[];for(let x of k)G.push(this.getNotebookCell(x));(w.length>0||I.length>0||g.length>0||G.length>0)&&(d.cells={added:w,removed:I,changed:{data:g,textContent:G}}),(d.metadata!==void 0||d.cells!==void 0)&&this._onDidChange.fire(d)})),r.push(t.notebooks.synchronization.onDidSaveNotebookDocument(i=>{let s=this.notebookDocuments.get(i.notebookDocument.uri);s!==void 0&&this._onDidSave.fire(s)})),r.push(t.notebooks.synchronization.onDidCloseNotebookDocument(i=>{let s=this.notebookDocuments.get(i.notebookDocument.uri);if(s!==void 0){this._onDidClose.fire(s);for(let a of i.cellTextDocuments)n.closeTextDocument({textDocument:a});this.notebookDocuments.delete(i.notebookDocument.uri);for(let a of s.cells)this.notebookCellMap.delete(a.document)}})),mi.Disposable.create(()=>{r.forEach(i=>i.dispose())})}updateCellMap(t){for(let n of t.cells)this.notebookCellMap.set(n.document,[n,t])}};go.NotebookDocuments=Jl});var og=Ye(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.MonikerFeature=void 0;var Ay=Tn(),Ny=e=>class extends e{get moniker(){return{on:t=>{let n=Ay.MonikerRequest.type;return this.connection.onRequest(n,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};Ta.MonikerFeature=Ny});var ru=Ye(Vt=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});Vt.createConnection=Vt.combineFeatures=Vt.combineNotebooksFeatures=Vt.combineLanguagesFeatures=Vt.combineWorkspaceFeatures=Vt.combineWindowFeatures=Vt.combineClientFeatures=Vt.combineTracerFeatures=Vt.combineTelemetryFeatures=Vt.combineConsoleFeatures=Vt._NotebooksImpl=Vt._LanguagesImpl=Vt.BulkUnregistration=Vt.BulkRegistration=Vt.ErrorMessageTracker=void 0;var ze=Tn(),_i=_s(),eu=$l(),Rt=Uh(),Ly=Bh(),My=Hh(),Fy=zh(),Iy=Hl(),qy=Gh(),Ky=Xh(),jy=Qh(),$y=Jh(),Wy=Yh(),Vy=tg(),Uy=ng(),By=ig(),Hy=Zl(),zy=og();function Yl(e){if(e!==null)return e}var tu=class{constructor(){this._messages=Object.create(null)}add(t){let n=this._messages[t];n||(n=0),n++,this._messages[t]=n}sendErrors(t){Object.keys(this._messages).forEach(n=>{t.window.showErrorMessage(n)})}};Vt.ErrorMessageTracker=tu;var wa=class{constructor(){}rawAttach(t){this._rawConnection=t}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(t){}initialize(t){}error(t){this.send(ze.MessageType.Error,t)}warn(t){this.send(ze.MessageType.Warning,t)}info(t){this.send(ze.MessageType.Info,t)}log(t){this.send(ze.MessageType.Log,t)}debug(t){this.send(ze.MessageType.Debug,t)}send(t,n){this._rawConnection&&this._rawConnection.sendNotification(ze.LogMessageNotification.type,{type:t,message:n}).catch(()=>{(0,ze.RAL)().console.error("Sending log message failed")})}},nu=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}showErrorMessage(t,...n){let r={type:ze.MessageType.Error,message:t,actions:n};return this.connection.sendRequest(ze.ShowMessageRequest.type,r).then(Yl)}showWarningMessage(t,...n){let r={type:ze.MessageType.Warning,message:t,actions:n};return this.connection.sendRequest(ze.ShowMessageRequest.type,r).then(Yl)}showInformationMessage(t,...n){let r={type:ze.MessageType.Info,message:t,actions:n};return this.connection.sendRequest(ze.ShowMessageRequest.type,r).then(Yl)}},sg=(0,qy.ShowDocumentFeature)((0,Rt.ProgressFeature)(nu)),ag;(function(e){function t(){return new Ra}e.create=t})(ag||(Vt.BulkRegistration=ag={}));var Ra=class{constructor(){this._registrations=[],this._registered=new Set}add(t,n){let r=_i.string(t)?t:t.method;if(this._registered.has(r))throw new Error(`${r} is already added to this registration`);let i=eu.generateUuid();this._registrations.push({id:i,method:r,registerOptions:n||{}}),this._registered.add(r)}asRegistrationParams(){return{registrations:this._registrations}}},cg;(function(e){function t(){return new Qo(void 0,[])}e.create=t})(cg||(Vt.BulkUnregistration=cg={}));var Qo=class{constructor(t,n){this._connection=t,this._unregistrations=new Map,n.forEach(r=>{this._unregistrations.set(r.method,r)})}get isAttached(){return!!this._connection}attach(t){this._connection=t}add(t){this._unregistrations.set(t.method,t)}dispose(){let t=[];for(let r of this._unregistrations.values())t.push(r);let n={unregisterations:t};this._connection.sendRequest(ze.UnregistrationRequest.type,n).catch(()=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(t){let n=_i.string(t)?t:t.method,r=this._unregistrations.get(n);if(!r)return!1;let i={unregisterations:[r]};return this._connection.sendRequest(ze.UnregistrationRequest.type,i).then(()=>{this._unregistrations.delete(n)},s=>{this._connection.console.info(`Un-registering request handler for ${r.id} failed.`)}),!0}},Ca=class{attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}register(t,n,r){return t instanceof Ra?this.registerMany(t):t instanceof Qo?this.registerSingle1(t,n,r):this.registerSingle2(t,n)}registerSingle1(t,n,r){let i=_i.string(n)?n:n.method,s=eu.generateUuid(),a={registrations:[{id:s,method:i,registerOptions:r||{}}]};return t.isAttached||t.attach(this.connection),this.connection.sendRequest(ze.RegistrationRequest.type,a).then(u=>(t.add({id:s,method:i}),t),u=>(this.connection.console.info(`Registering request handler for ${i} failed.`),Promise.reject(u)))}registerSingle2(t,n){let r=_i.string(t)?t:t.method,i=eu.generateUuid(),s={registrations:[{id:i,method:r,registerOptions:n||{}}]};return this.connection.sendRequest(ze.RegistrationRequest.type,s).then(a=>ze.Disposable.create(()=>{this.unregisterSingle(i,r).catch(()=>{this.connection.console.info(`Un-registering capability with id ${i} failed.`)})}),a=>(this.connection.console.info(`Registering request handler for ${r} failed.`),Promise.reject(a)))}unregisterSingle(t,n){let r={unregisterations:[{id:t,method:n}]};return this.connection.sendRequest(ze.UnregistrationRequest.type,r).catch(()=>{this.connection.console.info(`Un-registering request handler for ${t} failed.`)})}registerMany(t){let n=t.asRegistrationParams();return this.connection.sendRequest(ze.RegistrationRequest.type,n).then(()=>new Qo(this._connection,n.registrations.map(r=>({id:r.id,method:r.method}))),r=>(this.connection.console.info("Bulk registration failed."),Promise.reject(r)))}},iu=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}applyEdit(t){function n(i){return i&&!!i.edit}let r=n(t)?t:{edit:t};return this.connection.sendRequest(ze.ApplyWorkspaceEditRequest.type,r)}},lg=(0,Ky.FileOperationsFeature)((0,My.WorkspaceFoldersFeature)((0,Ly.ConfigurationFeature)(iu))),xa=class{constructor(){this._trace=ze.Trace.Off}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}set trace(t){this._trace=t}log(t,n){this._trace!==ze.Trace.Off&&this.connection.sendNotification(ze.LogTraceNotification.type,{message:t,verbose:this._trace===ze.Trace.Verbose?n:void 0}).catch(()=>{})}},Da=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}logEvent(t){this.connection.sendNotification(ze.TelemetryEventNotification.type,t).catch(()=>{this.connection.console.log("Sending TelemetryEventNotification failed")})}},Sa=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}attachWorkDoneProgress(t){return(0,Rt.attachWorkDone)(this.connection,t)}attachPartialResultProgress(t,n){return(0,Rt.attachPartialResult)(this.connection,n)}};Vt._LanguagesImpl=Sa;var ug=(0,Vy.FoldingRangeFeature)((0,zy.MonikerFeature)((0,By.DiagnosticFeature)((0,Uy.InlayHintFeature)((0,Wy.InlineValueFeature)((0,$y.TypeHierarchyFeature)((0,jy.LinkedEditingRangeFeature)((0,Iy.SemanticTokensFeature)((0,Fy.CallHierarchyFeature)(Sa))))))))),Ea=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}attachWorkDoneProgress(t){return(0,Rt.attachWorkDone)(this.connection,t)}attachPartialResultProgress(t,n){return(0,Rt.attachPartialResult)(this.connection,n)}};Vt._NotebooksImpl=Ea;var fg=(0,Hy.NotebookSyncFeature)(Ea);function dg(e,t){return function(n){return t(e(n))}}Vt.combineConsoleFeatures=dg;function pg(e,t){return function(n){return t(e(n))}}Vt.combineTelemetryFeatures=pg;function hg(e,t){return function(n){return t(e(n))}}Vt.combineTracerFeatures=hg;function gg(e,t){return function(n){return t(e(n))}}Vt.combineClientFeatures=gg;function mg(e,t){return function(n){return t(e(n))}}Vt.combineWindowFeatures=mg;function _g(e,t){return function(n){return t(e(n))}}Vt.combineWorkspaceFeatures=_g;function bg(e,t){return function(n){return t(e(n))}}Vt.combineLanguagesFeatures=bg;function yg(e,t){return function(n){return t(e(n))}}Vt.combineNotebooksFeatures=yg;function Gy(e,t){function n(i,s,a){return i&&s?a(i,s):i||s}return{__brand:"features",console:n(e.console,t.console,dg),tracer:n(e.tracer,t.tracer,hg),telemetry:n(e.telemetry,t.telemetry,pg),client:n(e.client,t.client,gg),window:n(e.window,t.window,mg),workspace:n(e.workspace,t.workspace,_g),languages:n(e.languages,t.languages,bg),notebooks:n(e.notebooks,t.notebooks,yg)}}Vt.combineFeatures=Gy;function Xy(e,t,n){let r=n&&n.console?new(n.console(wa)):new wa,i=e(r);r.rawAttach(i);let s=n&&n.tracer?new(n.tracer(xa)):new xa,a=n&&n.telemetry?new(n.telemetry(Da)):new Da,u=n&&n.client?new(n.client(Ca)):new Ca,f=n&&n.window?new(n.window(sg)):new sg,l=n&&n.workspace?new(n.workspace(lg)):new lg,c=n&&n.languages?new(n.languages(ug)):new ug,g=n&&n.notebooks?new(n.notebooks(fg)):new fg,k=[r,s,a,u,f,l,c,g];function d(m){return m instanceof Promise?m:_i.thenable(m)?new Promise((y,h)=>{m.then(W=>y(W),W=>h(W))}):Promise.resolve(m)}let w,I,G,x={listen:()=>i.listen(),sendRequest:(m,...y)=>i.sendRequest(_i.string(m)?m:m.method,...y),onRequest:(m,y)=>i.onRequest(m,y),sendNotification:(m,y)=>{let h=_i.string(m)?m:m.method;return i.sendNotification(h,y)},onNotification:(m,y)=>i.onNotification(m,y),onProgress:i.onProgress,sendProgress:i.sendProgress,onInitialize:m=>(I=m,{dispose:()=>{I=void 0}}),onInitialized:m=>i.onNotification(ze.InitializedNotification.type,m),onShutdown:m=>(w=m,{dispose:()=>{w=void 0}}),onExit:m=>(G=m,{dispose:()=>{G=void 0}}),get console(){return r},get telemetry(){return a},get tracer(){return s},get client(){return u},get window(){return f},get workspace(){return l},get languages(){return c},get notebooks(){return g},onDidChangeConfiguration:m=>i.onNotification(ze.DidChangeConfigurationNotification.type,m),onDidChangeWatchedFiles:m=>i.onNotification(ze.DidChangeWatchedFilesNotification.type,m),__textDocumentSync:void 0,onDidOpenTextDocument:m=>i.onNotification(ze.DidOpenTextDocumentNotification.type,m),onDidChangeTextDocument:m=>i.onNotification(ze.DidChangeTextDocumentNotification.type,m),onDidCloseTextDocument:m=>i.onNotification(ze.DidCloseTextDocumentNotification.type,m),onWillSaveTextDocument:m=>i.onNotification(ze.WillSaveTextDocumentNotification.type,m),onWillSaveTextDocumentWaitUntil:m=>i.onRequest(ze.WillSaveTextDocumentWaitUntilRequest.type,m),onDidSaveTextDocument:m=>i.onNotification(ze.DidSaveTextDocumentNotification.type,m),sendDiagnostics:m=>i.sendNotification(ze.PublishDiagnosticsNotification.type,m),onHover:m=>i.onRequest(ze.HoverRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),void 0)),onCompletion:m=>i.onRequest(ze.CompletionRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onCompletionResolve:m=>i.onRequest(ze.CompletionResolveRequest.type,m),onSignatureHelp:m=>i.onRequest(ze.SignatureHelpRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),void 0)),onDeclaration:m=>i.onRequest(ze.DeclarationRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onDefinition:m=>i.onRequest(ze.DefinitionRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onTypeDefinition:m=>i.onRequest(ze.TypeDefinitionRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onImplementation:m=>i.onRequest(ze.ImplementationRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onReferences:m=>i.onRequest(ze.ReferencesRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onDocumentHighlight:m=>i.onRequest(ze.DocumentHighlightRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onDocumentSymbol:m=>i.onRequest(ze.DocumentSymbolRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onWorkspaceSymbol:m=>i.onRequest(ze.WorkspaceSymbolRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onWorkspaceSymbolResolve:m=>i.onRequest(ze.WorkspaceSymbolResolveRequest.type,m),onCodeAction:m=>i.onRequest(ze.CodeActionRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onCodeActionResolve:m=>i.onRequest(ze.CodeActionResolveRequest.type,(y,h)=>m(y,h)),onCodeLens:m=>i.onRequest(ze.CodeLensRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onCodeLensResolve:m=>i.onRequest(ze.CodeLensResolveRequest.type,(y,h)=>m(y,h)),onDocumentFormatting:m=>i.onRequest(ze.DocumentFormattingRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),void 0)),onDocumentRangeFormatting:m=>i.onRequest(ze.DocumentRangeFormattingRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),void 0)),onDocumentOnTypeFormatting:m=>i.onRequest(ze.DocumentOnTypeFormattingRequest.type,(y,h)=>m(y,h)),onRenameRequest:m=>i.onRequest(ze.RenameRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),void 0)),onPrepareRename:m=>i.onRequest(ze.PrepareRenameRequest.type,(y,h)=>m(y,h)),onDocumentLinks:m=>i.onRequest(ze.DocumentLinkRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onDocumentLinkResolve:m=>i.onRequest(ze.DocumentLinkResolveRequest.type,(y,h)=>m(y,h)),onDocumentColor:m=>i.onRequest(ze.DocumentColorRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onColorPresentation:m=>i.onRequest(ze.ColorPresentationRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onFoldingRanges:m=>i.onRequest(ze.FoldingRangeRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onSelectionRanges:m=>i.onRequest(ze.SelectionRangeRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),(0,Rt.attachPartialResult)(i,y))),onExecuteCommand:m=>i.onRequest(ze.ExecuteCommandRequest.type,(y,h)=>m(y,h,(0,Rt.attachWorkDone)(i,y),void 0)),dispose:()=>i.dispose()};for(let m of k)m.attach(x);return i.onRequest(ze.InitializeRequest.type,m=>{t.initialize(m),_i.string(m.trace)&&(s.trace=ze.Trace.fromString(m.trace));for(let y of k)y.initialize(m.capabilities);if(I){let y=I(m,new ze.CancellationTokenSource().token,(0,Rt.attachWorkDone)(i,m),void 0);return d(y).then(h=>{if(h instanceof ze.ResponseError)return h;let W=h;W||(W={capabilities:{}});let _=W.capabilities;_||(_={},W.capabilities=_),_.textDocumentSync===void 0||_.textDocumentSync===null?_.textDocumentSync=_i.number(x.__textDocumentSync)?x.__textDocumentSync:ze.TextDocumentSyncKind.None:!_i.number(_.textDocumentSync)&&!_i.number(_.textDocumentSync.change)&&(_.textDocumentSync.change=_i.number(x.__textDocumentSync)?x.__textDocumentSync:ze.TextDocumentSyncKind.None);for(let de of k)de.fillServerCapabilities(_);return W})}else{let y={capabilities:{textDocumentSync:ze.TextDocumentSyncKind.None}};for(let h of k)h.fillServerCapabilities(y.capabilities);return y}}),i.onRequest(ze.ShutdownRequest.type,()=>{if(t.shutdownReceived=!0,w)return w(new ze.CancellationTokenSource().token)}),i.onNotification(ze.ExitNotification.type,()=>{try{G&&G()}finally{t.shutdownReceived?t.exit(0):t.exit(1)}}),i.onNotification(ze.SetTraceNotification.type,m=>{s.trace=ze.Trace.fromString(m.value)}),x}Vt.createConnection=Xy});var kg=Ye(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.resolveModulePath=Yn.FileSystem=Yn.resolveGlobalYarnPath=Yn.resolveGlobalNodePath=Yn.resolve=Yn.uriToFilePath=void 0;var Qy=require("url"),Di=require("path"),ou=require("fs"),lu=require("child_process");function Jy(e){let t=Qy.parse(e);if(t.protocol!=="file:"||!t.path)return;let n=t.path.split("/");for(var r=0,i=n.length;r<i;r++)n[r]=decodeURIComponent(n[r]);if(process.platform==="win32"&&n.length>1){let s=n[0],a=n[1];s.length===0&&a.length>1&&a[1]===":"&&n.shift()}return Di.normalize(n.join("/"))}Yn.uriToFilePath=Jy;function su(){return process.platform==="win32"}function Pa(e,t,n,r){let i="NODE_PATH",s=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise((a,u)=>{let f=process.env,l=Object.create(null);Object.keys(f).forEach(c=>l[c]=f[c]),t&&ou.existsSync(t)&&(l[i]?l[i]=t+Di.delimiter+l[i]:l[i]=t,r&&r(`NODE_PATH value is: ${l[i]}`)),l.ELECTRON_RUN_AS_NODE="1";try{let c=(0,lu.fork)("",[],{cwd:n,env:l,execArgv:["-e",s]});if(c.pid===void 0){u(new Error(`Starting process to resolve node module  ${e} failed`));return}c.on("error",k=>{u(k)}),c.on("message",k=>{k.c==="r"&&(c.send({c:"e"}),k.s?a(k.r):u(new Error(`Failed to resolve module: ${e}`)))});let g={c:"rs",a:e};c.send(g)}catch(c){u(c)}})}Yn.resolve=Pa;function au(e){let t="npm",n=Object.create(null);Object.keys(process.env).forEach(s=>n[s]=process.env[s]),n.NO_UPDATE_NOTIFIER="true";let r={encoding:"utf8",env:n};su()&&(t="npm.cmd",r.shell=!0);let i=()=>{};try{process.on("SIGPIPE",i);let s=(0,lu.spawnSync)(t,["config","get","prefix"],r).stdout;if(!s){e&&e("'npm config get prefix' didn't return a value.");return}let a=s.trim();return e&&e(`'npm config get prefix' value is: ${a}`),a.length>0?su()?Di.join(a,"node_modules"):Di.join(a,"lib","node_modules"):void 0}catch{return}finally{process.removeListener("SIGPIPE",i)}}Yn.resolveGlobalNodePath=au;function Zy(e){let t="yarn",n={encoding:"utf8"};su()&&(t="yarn.cmd",n.shell=!0);let r=()=>{};try{process.on("SIGPIPE",r);let i=(0,lu.spawnSync)(t,["global","dir","--json"],n),s=i.stdout;if(!s){e&&(e("'yarn global dir' didn't return a value."),i.stderr&&e(i.stderr));return}let a=s.trim().split(/\r?\n/);for(let u of a)try{let f=JSON.parse(u);if(f.type==="log")return Di.join(f.data,"node_modules")}catch{}return}catch{return}finally{process.removeListener("SIGPIPE",r)}}Yn.resolveGlobalYarnPath=Zy;var cu;(function(e){let t;function n(){return t!==void 0||(process.platform==="win32"?t=!1:t=!ou.existsSync(__filename.toUpperCase())||!ou.existsSync(__filename.toLowerCase())),t}e.isCaseSensitive=n;function r(i,s){return n()?Di.normalize(s).indexOf(Di.normalize(i))===0:Di.normalize(s).toLowerCase().indexOf(Di.normalize(i).toLowerCase())===0}e.isParent=r})(cu||(Yn.FileSystem=cu={}));function Yy(e,t,n,r){return n?(Di.isAbsolute(n)||(n=Di.join(e,n)),Pa(t,n,n,r).then(i=>cu.isParent(n,i)?i:Promise.reject(new Error(`Failed to load ${t} from node path location.`))).then(void 0,i=>Pa(t,au(r),e,r))):Pa(t,au(r),e,r)}Yn.resolveModulePath=Yy});var uu=Ye((dT,vg)=>{"use strict";vg.exports=Tn()});var Tg=Ye(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.InlineCompletionFeature=void 0;var ek=Tn(),tk=e=>class extends e{get inlineCompletion(){return{on:t=>this.connection.onRequest(ek.InlineCompletionRequest.type,(n,r)=>t(n,r,this.attachWorkDoneProgress(n)))}}};Oa.InlineCompletionFeature=tk});var Cg=Ye($n=>{"use strict";var nk=$n&&$n.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Rg=$n&&$n.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&nk(t,e,n)};Object.defineProperty($n,"__esModule",{value:!0});$n.ProposedFeatures=$n.NotebookDocuments=$n.TextDocuments=$n.SemanticTokensBuilder=void 0;var ik=Hl();Object.defineProperty($n,"SemanticTokensBuilder",{enumerable:!0,get:function(){return ik.SemanticTokensBuilder}});var rk=Tg();Rg(Tn(),$n);var ok=Ql();Object.defineProperty($n,"TextDocuments",{enumerable:!0,get:function(){return ok.TextDocuments}});var sk=Zl();Object.defineProperty($n,"NotebookDocuments",{enumerable:!0,get:function(){return sk.NotebookDocuments}});Rg(ru(),$n);var wg;(function(e){e.all={__brand:"features",languages:rk.InlineCompletionFeature}})(wg||($n.ProposedFeatures=wg={}))});var si=Ye(bi=>{"use strict";var ak=bi&&bi.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Eg=bi&&bi.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&ak(t,e,n)};Object.defineProperty(bi,"__esModule",{value:!0});bi.createConnection=bi.Files=void 0;var xg=require("node:util"),fu=_s(),ck=ru(),Jo=kg(),Lr=uu();Eg(uu(),bi);Eg(Cg(),bi);var Dg;(function(e){e.uriToFilePath=Jo.uriToFilePath,e.resolveGlobalNodePath=Jo.resolveGlobalNodePath,e.resolveGlobalYarnPath=Jo.resolveGlobalYarnPath,e.resolve=Jo.resolve,e.resolveModulePath=Jo.resolveModulePath})(Dg||(bi.Files=Dg={}));var Sg;function Aa(){if(Sg!==void 0)try{Sg.end()}catch{}}var mo=!1,Pg;function lk(){let e="--clientProcessId";function t(n){try{let r=parseInt(n);isNaN(r)||(Pg=setInterval(()=>{try{process.kill(r,0)}catch{Aa(),process.exit(mo?0:1)}},3e3))}catch{}}for(let n=2;n<process.argv.length;n++){let r=process.argv[n];if(r===e&&n+1<process.argv.length){t(process.argv[n+1]);return}else{let i=r.split("=");i[0]===e&&t(i[1])}}}lk();var uk={initialize:e=>{let t=e.processId;fu.number(t)&&Pg===void 0&&setInterval(()=>{try{process.kill(t,0)}catch{process.exit(mo?0:1)}},3e3)},get shutdownReceived(){return mo},set shutdownReceived(e){mo=e},exit:e=>{Aa(),process.exit(e)}};function fk(e,t,n,r){let i,s,a,u;return e!==void 0&&e.__brand==="features"&&(i=e,e=t,t=n,n=r),Lr.ConnectionStrategy.is(e)||Lr.ConnectionOptions.is(e)?u=e:(s=e,a=t,u=n),dk(s,a,u,i)}bi.createConnection=fk;function dk(e,t,n,r){let i=!1;if(!e&&!t&&process.argv.length>2){let f,l,c=process.argv.slice(2);for(let g=0;g<c.length;g++){let k=c[g];if(k==="--node-ipc"){e=new Lr.IPCMessageReader(process),t=new Lr.IPCMessageWriter(process);break}else if(k==="--stdio"){i=!0,e=process.stdin,t=process.stdout;break}else if(k==="--socket"){f=parseInt(c[g+1]);break}else if(k==="--pipe"){l=c[g+1];break}else{var s=k.split("=");if(s[0]==="--socket"){f=parseInt(s[1]);break}else if(s[0]==="--pipe"){l=s[1];break}}}if(f){let g=(0,Lr.createServerSocketTransport)(f);e=g[0],t=g[1]}else if(l){let g=(0,Lr.createServerPipeTransport)(l);e=g[0],t=g[1]}}var a="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!e)throw new Error("Connection input stream is not set. "+a);if(!t)throw new Error("Connection output stream is not set. "+a);if(fu.func(e.read)&&fu.func(e.on)){let f=e;f.on("end",()=>{Aa(),process.exit(mo?0:1)}),f.on("close",()=>{Aa(),process.exit(mo?0:1)})}let u=f=>{let l=(0,Lr.createProtocolConnection)(e,t,f,n);return i&&pk(f),l};return(0,ck.createConnection)(u,uk,r)}function pk(e){function t(r){return r.map(i=>typeof i=="string"?i:(0,xg.inspect)(i)).join(" ")}let n=new Map;console.assert=function(i,...s){if(!i)if(s.length===0)e.error("Assertion failed");else{let[a,...u]=s;e.error(`Assertion failed: ${a} ${t(u)}`)}},console.count=function(i="default"){let s=String(i),a=n.get(s)??0;a+=1,n.set(s,a),e.log(`${s}: ${s}`)},console.countReset=function(i){i===void 0?n.clear():n.delete(String(i))},console.debug=function(...i){e.log(t(i))},console.dir=function(i,s){e.log((0,xg.inspect)(i,s))},console.log=function(...i){e.log(t(i))},console.error=function(...i){e.error(t(i))},console.trace=function(...i){let s=new Error().stack.replace(/(.+\n){2}/,""),a="Trace";i.length!==0&&(a+=`: ${t(i)}`),e.log(`${a}
${s}`)},console.warn=function(...i){e.warn(t(i))}}});var du=Ye((_T,Og)=>{"use strict";Og.exports=si()});var ps=require("path"),M_=require("net"),F_=require("child_process");var ms=class e{constructor(t,n,r,i){this._uri=t,this._languageId=n,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(t){if(t){let n=this.offsetAt(t.start),r=this.offsetAt(t.end);return this._content.substring(n,r)}return this._content}update(t,n){for(let r of t)if(e.isIncremental(r)){let i=lf(r.range),s=this.offsetAt(i.start),a=this.offsetAt(i.end);this._content=this._content.substring(0,s)+r.text+this._content.substring(a,this._content.length);let u=Math.max(i.start.line,0),f=Math.max(i.end.line,0),l=this._lineOffsets,c=af(r.text,!1,s);if(f-u===c.length)for(let k=0,d=c.length;k<d;k++)l[k+u+1]=c[k];else c.length<1e4?l.splice(u+1,f-u,...c):this._lineOffsets=l=l.slice(0,u+1).concat(c,l.slice(f+1));let g=r.text.length-(a-s);if(g!==0)for(let k=u+1+c.length,d=l.length;k<d;k++)l[k]=l[k]+g}else if(e.isFull(r))this._content=r.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=n}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=af(this._content,!0)),this._lineOffsets}positionAt(t){t=Math.max(Math.min(t,this._content.length),0);let n=this.getLineOffsets(),r=0,i=n.length;if(i===0)return{line:0,character:t};for(;r<i;){let a=Math.floor((r+i)/2);n[a]>t?i=a:r=a+1}let s=r-1;return t=this.ensureBeforeEOL(t,n[s]),{line:s,character:t-n[s]}}offsetAt(t){let n=this.getLineOffsets();if(t.line>=n.length)return this._content.length;if(t.line<0)return 0;let r=n[t.line];if(t.character<=0)return r;let i=t.line+1<n.length?n[t.line+1]:this._content.length,s=Math.min(r+t.character,i);return this.ensureBeforeEOL(s,r)}ensureBeforeEOL(t,n){for(;t>n&&cf(this._content.charCodeAt(t-1));)t--;return t}get lineCount(){return this.getLineOffsets().length}static isIncremental(t){let n=t;return n!=null&&typeof n.text=="string"&&n.range!==void 0&&(n.rangeLength===void 0||typeof n.rangeLength=="number")}static isFull(t){let n=t;return n!=null&&typeof n.text=="string"&&n.range===void 0&&n.rangeLength===void 0}},Gn;(function(e){function t(i,s,a,u){return new ms(i,s,a,u)}e.create=t;function n(i,s,a){if(i instanceof ms)return i.update(s,a),i;throw new Error("TextDocument.update: document must be created by TextDocument.create")}e.update=n;function r(i,s){let a=i.getText(),u=pc(s.map(Z_),(c,g)=>{let k=c.range.start.line-g.range.start.line;return k===0?c.range.start.character-g.range.start.character:k}),f=0,l=[];for(let c of u){let g=i.offsetAt(c.range.start);if(g<f)throw new Error("Overlapping edit");g>f&&l.push(a.substring(f,g)),c.newText.length&&l.push(c.newText),f=i.offsetAt(c.range.end)}return l.push(a.substr(f)),l.join("")}e.applyEdits=r})(Gn||(Gn={}));function pc(e,t){if(e.length<=1)return e;let n=e.length/2|0,r=e.slice(0,n),i=e.slice(n);pc(r,t),pc(i,t);let s=0,a=0,u=0;for(;s<r.length&&a<i.length;)t(r[s],i[a])<=0?e[u++]=r[s++]:e[u++]=i[a++];for(;s<r.length;)e[u++]=r[s++];for(;a<i.length;)e[u++]=i[a++];return e}function af(e,t,n=0){let r=t?[n]:[];for(let i=0;i<e.length;i++){let s=e.charCodeAt(i);cf(s)&&(s===13&&i+1<e.length&&e.charCodeAt(i+1)===10&&i++,r.push(n+i+1))}return r}function cf(e){return e===13||e===10}function lf(e){let t=e.start,n=e.end;return t.line>n.line||t.line===n.line&&t.character>n.character?{start:n,end:t}:e}function Z_(e){let t=lf(e.range);return t!==e.range?{newText:e.newText,range:t}:e}var di=zn(du());var Ag;(()=>{"use strict";var e={470:i=>{function s(f){if(typeof f!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(f))}function a(f,l){for(var c,g="",k=0,d=-1,w=0,I=0;I<=f.length;++I){if(I<f.length)c=f.charCodeAt(I);else{if(c===47)break;c=47}if(c===47){if(!(d===I-1||w===1))if(d!==I-1&&w===2){if(g.length<2||k!==2||g.charCodeAt(g.length-1)!==46||g.charCodeAt(g.length-2)!==46){if(g.length>2){var G=g.lastIndexOf("/");if(G!==g.length-1){G===-1?(g="",k=0):k=(g=g.slice(0,G)).length-1-g.lastIndexOf("/"),d=I,w=0;continue}}else if(g.length===2||g.length===1){g="",k=0,d=I,w=0;continue}}l&&(g.length>0?g+="/..":g="..",k=2)}else g.length>0?g+="/"+f.slice(d+1,I):g=f.slice(d+1,I),k=I-d-1;d=I,w=0}else c===46&&w!==-1?++w:w=-1}return g}var u={resolve:function(){for(var f,l="",c=!1,g=arguments.length-1;g>=-1&&!c;g--){var k;g>=0?k=arguments[g]:(f===void 0&&(f=process.cwd()),k=f),s(k),k.length!==0&&(l=k+"/"+l,c=k.charCodeAt(0)===47)}return l=a(l,!c),c?l.length>0?"/"+l:"/":l.length>0?l:"."},normalize:function(f){if(s(f),f.length===0)return".";var l=f.charCodeAt(0)===47,c=f.charCodeAt(f.length-1)===47;return(f=a(f,!l)).length!==0||l||(f="."),f.length>0&&c&&(f+="/"),l?"/"+f:f},isAbsolute:function(f){return s(f),f.length>0&&f.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var f,l=0;l<arguments.length;++l){var c=arguments[l];s(c),c.length>0&&(f===void 0?f=c:f+="/"+c)}return f===void 0?".":u.normalize(f)},relative:function(f,l){if(s(f),s(l),f===l||(f=u.resolve(f))===(l=u.resolve(l)))return"";for(var c=1;c<f.length&&f.charCodeAt(c)===47;++c);for(var g=f.length,k=g-c,d=1;d<l.length&&l.charCodeAt(d)===47;++d);for(var w=l.length-d,I=k<w?k:w,G=-1,x=0;x<=I;++x){if(x===I){if(w>I){if(l.charCodeAt(d+x)===47)return l.slice(d+x+1);if(x===0)return l.slice(d+x)}else k>I&&(f.charCodeAt(c+x)===47?G=x:x===0&&(G=0));break}var m=f.charCodeAt(c+x);if(m!==l.charCodeAt(d+x))break;m===47&&(G=x)}var y="";for(x=c+G+1;x<=g;++x)x!==g&&f.charCodeAt(x)!==47||(y.length===0?y+="..":y+="/..");return y.length>0?y+l.slice(d+G):(d+=G,l.charCodeAt(d)===47&&++d,l.slice(d))},_makeLong:function(f){return f},dirname:function(f){if(s(f),f.length===0)return".";for(var l=f.charCodeAt(0),c=l===47,g=-1,k=!0,d=f.length-1;d>=1;--d)if((l=f.charCodeAt(d))===47){if(!k){g=d;break}}else k=!1;return g===-1?c?"/":".":c&&g===1?"//":f.slice(0,g)},basename:function(f,l){if(l!==void 0&&typeof l!="string")throw new TypeError('"ext" argument must be a string');s(f);var c,g=0,k=-1,d=!0;if(l!==void 0&&l.length>0&&l.length<=f.length){if(l.length===f.length&&l===f)return"";var w=l.length-1,I=-1;for(c=f.length-1;c>=0;--c){var G=f.charCodeAt(c);if(G===47){if(!d){g=c+1;break}}else I===-1&&(d=!1,I=c+1),w>=0&&(G===l.charCodeAt(w)?--w==-1&&(k=c):(w=-1,k=I))}return g===k?k=I:k===-1&&(k=f.length),f.slice(g,k)}for(c=f.length-1;c>=0;--c)if(f.charCodeAt(c)===47){if(!d){g=c+1;break}}else k===-1&&(d=!1,k=c+1);return k===-1?"":f.slice(g,k)},extname:function(f){s(f);for(var l=-1,c=0,g=-1,k=!0,d=0,w=f.length-1;w>=0;--w){var I=f.charCodeAt(w);if(I!==47)g===-1&&(k=!1,g=w+1),I===46?l===-1?l=w:d!==1&&(d=1):l!==-1&&(d=-1);else if(!k){c=w+1;break}}return l===-1||g===-1||d===0||d===1&&l===g-1&&l===c+1?"":f.slice(l,g)},format:function(f){if(f===null||typeof f!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof f);return function(l,c){var g=c.dir||c.root,k=c.base||(c.name||"")+(c.ext||"");return g?g===c.root?g+k:g+"/"+k:k}(0,f)},parse:function(f){s(f);var l={root:"",dir:"",base:"",ext:"",name:""};if(f.length===0)return l;var c,g=f.charCodeAt(0),k=g===47;k?(l.root="/",c=1):c=0;for(var d=-1,w=0,I=-1,G=!0,x=f.length-1,m=0;x>=c;--x)if((g=f.charCodeAt(x))!==47)I===-1&&(G=!1,I=x+1),g===46?d===-1?d=x:m!==1&&(m=1):d!==-1&&(m=-1);else if(!G){w=x+1;break}return d===-1||I===-1||m===0||m===1&&d===I-1&&d===w+1?I!==-1&&(l.base=l.name=w===0&&k?f.slice(1,I):f.slice(w,I)):(w===0&&k?(l.name=f.slice(1,d),l.base=f.slice(1,I)):(l.name=f.slice(w,d),l.base=f.slice(w,I)),l.ext=f.slice(d,I)),w>0?l.dir=f.slice(0,w-1):k&&(l.dir="/"),l},sep:"/",delimiter:":",win32:null,posix:null};u.posix=u,i.exports=u}},t={};function n(i){var s=t[i];if(s!==void 0)return s.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.d=(i,s)=>{for(var a in s)n.o(s,a)&&!n.o(i,a)&&Object.defineProperty(i,a,{enumerable:!0,get:s[a]})},n.o=(i,s)=>Object.prototype.hasOwnProperty.call(i,s),n.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var r={};(()=>{let i;n.r(r),n.d(r,{URI:()=>k,Utils:()=>Ve}),typeof process=="object"?i=process.platform==="win32":typeof navigator=="object"&&(i=navigator.userAgent.indexOf("Windows")>=0);let s=/^\w[\w\d+.-]*$/,a=/^\//,u=/^\/\//;function f(le,N){if(!le.scheme&&N)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${le.authority}", path: "${le.path}", query: "${le.query}", fragment: "${le.fragment}"}`);if(le.scheme&&!s.test(le.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(le.path){if(le.authority){if(!a.test(le.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(u.test(le.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}let l="",c="/",g=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class k{static isUri(N){return N instanceof k||!!N&&typeof N.authority=="string"&&typeof N.fragment=="string"&&typeof N.path=="string"&&typeof N.query=="string"&&typeof N.scheme=="string"&&typeof N.fsPath=="string"&&typeof N.with=="function"&&typeof N.toString=="function"}scheme;authority;path;query;fragment;constructor(N,V,Re,Ce,xe,R=!1){typeof N=="object"?(this.scheme=N.scheme||l,this.authority=N.authority||l,this.path=N.path||l,this.query=N.query||l,this.fragment=N.fragment||l):(this.scheme=function(pt,Ut){return pt||Ut?pt:"file"}(N,R),this.authority=V||l,this.path=function(pt,Ut){switch(pt){case"https":case"http":case"file":Ut?Ut[0]!==c&&(Ut=c+Ut):Ut=c}return Ut}(this.scheme,Re||l),this.query=Ce||l,this.fragment=xe||l,f(this,R))}get fsPath(){return m(this,!1)}with(N){if(!N)return this;let{scheme:V,authority:Re,path:Ce,query:xe,fragment:R}=N;return V===void 0?V=this.scheme:V===null&&(V=l),Re===void 0?Re=this.authority:Re===null&&(Re=l),Ce===void 0?Ce=this.path:Ce===null&&(Ce=l),xe===void 0?xe=this.query:xe===null&&(xe=l),R===void 0?R=this.fragment:R===null&&(R=l),V===this.scheme&&Re===this.authority&&Ce===this.path&&xe===this.query&&R===this.fragment?this:new w(V,Re,Ce,xe,R)}static parse(N,V=!1){let Re=g.exec(N);return Re?new w(Re[2]||l,_(Re[4]||l),_(Re[5]||l),_(Re[7]||l),_(Re[9]||l),V):new w(l,l,l,l,l)}static file(N){let V=l;if(i&&(N=N.replace(/\\/g,c)),N[0]===c&&N[1]===c){let Re=N.indexOf(c,2);Re===-1?(V=N.substring(2),N=c):(V=N.substring(2,Re),N=N.substring(Re)||c)}return new w("file",V,N,l,l)}static from(N){let V=new w(N.scheme,N.authority,N.path,N.query,N.fragment);return f(V,!0),V}toString(N=!1){return y(this,N)}toJSON(){return this}static revive(N){if(N){if(N instanceof k)return N;{let V=new w(N);return V._formatted=N.external,V._fsPath=N._sep===d?N.fsPath:null,V}}return N}}let d=i?1:void 0;class w extends k{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=m(this,!1)),this._fsPath}toString(N=!1){return N?y(this,!0):(this._formatted||(this._formatted=y(this,!1)),this._formatted)}toJSON(){let N={$mid:1};return this._fsPath&&(N.fsPath=this._fsPath,N._sep=d),this._formatted&&(N.external=this._formatted),this.path&&(N.path=this.path),this.scheme&&(N.scheme=this.scheme),this.authority&&(N.authority=this.authority),this.query&&(N.query=this.query),this.fragment&&(N.fragment=this.fragment),N}}let I={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function G(le,N,V){let Re,Ce=-1;for(let xe=0;xe<le.length;xe++){let R=le.charCodeAt(xe);if(R>=97&&R<=122||R>=65&&R<=90||R>=48&&R<=57||R===45||R===46||R===95||R===126||N&&R===47||V&&R===91||V&&R===93||V&&R===58)Ce!==-1&&(Re+=encodeURIComponent(le.substring(Ce,xe)),Ce=-1),Re!==void 0&&(Re+=le.charAt(xe));else{Re===void 0&&(Re=le.substr(0,xe));let pt=I[R];pt!==void 0?(Ce!==-1&&(Re+=encodeURIComponent(le.substring(Ce,xe)),Ce=-1),Re+=pt):Ce===-1&&(Ce=xe)}}return Ce!==-1&&(Re+=encodeURIComponent(le.substring(Ce))),Re!==void 0?Re:le}function x(le){let N;for(let V=0;V<le.length;V++){let Re=le.charCodeAt(V);Re===35||Re===63?(N===void 0&&(N=le.substr(0,V)),N+=I[Re]):N!==void 0&&(N+=le[V])}return N!==void 0?N:le}function m(le,N){let V;return V=le.authority&&le.path.length>1&&le.scheme==="file"?`//${le.authority}${le.path}`:le.path.charCodeAt(0)===47&&(le.path.charCodeAt(1)>=65&&le.path.charCodeAt(1)<=90||le.path.charCodeAt(1)>=97&&le.path.charCodeAt(1)<=122)&&le.path.charCodeAt(2)===58?N?le.path.substr(1):le.path[1].toLowerCase()+le.path.substr(2):le.path,i&&(V=V.replace(/\//g,"\\")),V}function y(le,N){let V=N?x:G,Re="",{scheme:Ce,authority:xe,path:R,query:pt,fragment:Ut}=le;if(Ce&&(Re+=Ce,Re+=":"),(xe||Ce==="file")&&(Re+=c,Re+=c),xe){let De=xe.indexOf("@");if(De!==-1){let qt=xe.substr(0,De);xe=xe.substr(De+1),De=qt.lastIndexOf(":"),De===-1?Re+=V(qt,!1,!1):(Re+=V(qt.substr(0,De),!1,!1),Re+=":",Re+=V(qt.substr(De+1),!1,!0)),Re+="@"}xe=xe.toLowerCase(),De=xe.lastIndexOf(":"),De===-1?Re+=V(xe,!1,!0):(Re+=V(xe.substr(0,De),!1,!0),Re+=xe.substr(De))}if(R){if(R.length>=3&&R.charCodeAt(0)===47&&R.charCodeAt(2)===58){let De=R.charCodeAt(1);De>=65&&De<=90&&(R=`/${String.fromCharCode(De+32)}:${R.substr(3)}`)}else if(R.length>=2&&R.charCodeAt(1)===58){let De=R.charCodeAt(0);De>=65&&De<=90&&(R=`${String.fromCharCode(De+32)}:${R.substr(2)}`)}Re+=V(R,!0,!1)}return pt&&(Re+="?",Re+=V(pt,!1,!1)),Ut&&(Re+="#",Re+=N?Ut:G(Ut,!1,!1)),Re}function h(le){try{return decodeURIComponent(le)}catch{return le.length>3?le.substr(0,3)+h(le.substr(3)):le}}let W=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function _(le){return le.match(W)?le.replace(W,N=>h(N)):le}var de=n(470);let ye=de.posix||de,pe="/";var Ve;(function(le){le.joinPath=function(N,...V){return N.with({path:ye.join(N.path,...V)})},le.resolvePath=function(N,...V){let Re=N.path,Ce=!1;Re[0]!==pe&&(Re=pe+Re,Ce=!0);let xe=ye.resolve(Re,...V);return Ce&&xe[0]===pe&&!N.authority&&(xe=xe.substring(1)),N.with({path:xe})},le.dirname=function(N){if(N.path.length===0||N.path===pe)return N;let V=ye.dirname(N.path);return V.length===1&&V.charCodeAt(0)===46&&(V=""),N.with({path:V})},le.basename=function(N){return ye.basename(N.path)},le.extname=function(N){return ye.extname(N.path)}})(Ve||(Ve={}))})(),Ag=r})();var{URI:hn,Utils:bT}=Ag;var Hr=zn(du()),A_=require("child_process");var Ng;(function(e){function t(n){return typeof n=="string"}e.is=t})(Ng||(Ng={}));var pu;(function(e){function t(n){return typeof n=="string"}e.is=t})(pu||(pu={}));var Lg;(function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647;function t(n){return typeof n=="number"&&e.MIN_VALUE<=n&&n<=e.MAX_VALUE}e.is=t})(Lg||(Lg={}));var Na;(function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647;function t(n){return typeof n=="number"&&e.MIN_VALUE<=n&&n<=e.MAX_VALUE}e.is=t})(Na||(Na={}));var Si;(function(e){function t(r,i){return r===Number.MAX_VALUE&&(r=Na.MAX_VALUE),i===Number.MAX_VALUE&&(i=Na.MAX_VALUE),{line:r,character:i}}e.create=t;function n(r){let i=r;return Y.objectLiteral(i)&&Y.uinteger(i.line)&&Y.uinteger(i.character)}e.is=n})(Si||(Si={}));var _n;(function(e){function t(r,i,s,a){if(Y.uinteger(r)&&Y.uinteger(i)&&Y.uinteger(s)&&Y.uinteger(a))return{start:Si.create(r,i),end:Si.create(s,a)};if(Si.is(r)&&Si.is(i))return{start:r,end:i};throw new Error(`Range#create called with invalid arguments[${r}, ${i}, ${s}, ${a}]`)}e.create=t;function n(r){let i=r;return Y.objectLiteral(i)&&Si.is(i.start)&&Si.is(i.end)}e.is=n})(_n||(_n={}));var La;(function(e){function t(r,i){return{uri:r,range:i}}e.create=t;function n(r){let i=r;return Y.objectLiteral(i)&&_n.is(i.range)&&(Y.string(i.uri)||Y.undefined(i.uri))}e.is=n})(La||(La={}));var Mg;(function(e){function t(r,i,s,a){return{targetUri:r,targetRange:i,targetSelectionRange:s,originSelectionRange:a}}e.create=t;function n(r){let i=r;return Y.objectLiteral(i)&&_n.is(i.targetRange)&&Y.string(i.targetUri)&&_n.is(i.targetSelectionRange)&&(_n.is(i.originSelectionRange)||Y.undefined(i.originSelectionRange))}e.is=n})(Mg||(Mg={}));var hu;(function(e){function t(r,i,s,a){return{red:r,green:i,blue:s,alpha:a}}e.create=t;function n(r){let i=r;return Y.objectLiteral(i)&&Y.numberRange(i.red,0,1)&&Y.numberRange(i.green,0,1)&&Y.numberRange(i.blue,0,1)&&Y.numberRange(i.alpha,0,1)}e.is=n})(hu||(hu={}));var Fg;(function(e){function t(r,i){return{range:r,color:i}}e.create=t;function n(r){let i=r;return Y.objectLiteral(i)&&_n.is(i.range)&&hu.is(i.color)}e.is=n})(Fg||(Fg={}));var Ig;(function(e){function t(r,i,s){return{label:r,textEdit:i,additionalTextEdits:s}}e.create=t;function n(r){let i=r;return Y.objectLiteral(i)&&Y.string(i.label)&&(Y.undefined(i.textEdit)||bo.is(i))&&(Y.undefined(i.additionalTextEdits)||Y.typedArray(i.additionalTextEdits,bo.is))}e.is=n})(Ig||(Ig={}));var qg;(function(e){e.Comment="comment",e.Imports="imports",e.Region="region"})(qg||(qg={}));var Kg;(function(e){function t(r,i,s,a,u,f){let l={startLine:r,endLine:i};return Y.defined(s)&&(l.startCharacter=s),Y.defined(a)&&(l.endCharacter=a),Y.defined(u)&&(l.kind=u),Y.defined(f)&&(l.collapsedText=f),l}e.create=t;function n(r){let i=r;return Y.objectLiteral(i)&&Y.uinteger(i.startLine)&&Y.uinteger(i.startLine)&&(Y.undefined(i.startCharacter)||Y.uinteger(i.startCharacter))&&(Y.undefined(i.endCharacter)||Y.uinteger(i.endCharacter))&&(Y.undefined(i.kind)||Y.string(i.kind))}e.is=n})(Kg||(Kg={}));var gu;(function(e){function t(r,i){return{location:r,message:i}}e.create=t;function n(r){let i=r;return Y.defined(i)&&La.is(i.location)&&Y.string(i.message)}e.is=n})(gu||(gu={}));var jg;(function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4})(jg||(jg={}));var $g;(function(e){e.Unnecessary=1,e.Deprecated=2})($g||($g={}));var Wg;(function(e){function t(n){let r=n;return Y.objectLiteral(r)&&Y.string(r.href)}e.is=t})(Wg||(Wg={}));var Ma;(function(e){function t(r,i,s,a,u,f){let l={range:r,message:i};return Y.defined(s)&&(l.severity=s),Y.defined(a)&&(l.code=a),Y.defined(u)&&(l.source=u),Y.defined(f)&&(l.relatedInformation=f),l}e.create=t;function n(r){var i;let s=r;return Y.defined(s)&&_n.is(s.range)&&Y.string(s.message)&&(Y.number(s.severity)||Y.undefined(s.severity))&&(Y.integer(s.code)||Y.string(s.code)||Y.undefined(s.code))&&(Y.undefined(s.codeDescription)||Y.string((i=s.codeDescription)===null||i===void 0?void 0:i.href))&&(Y.string(s.source)||Y.undefined(s.source))&&(Y.undefined(s.relatedInformation)||Y.typedArray(s.relatedInformation,gu.is))}e.is=n})(Ma||(Ma={}));var _o;(function(e){function t(r,i,...s){let a={title:r,command:i};return Y.defined(s)&&s.length>0&&(a.arguments=s),a}e.create=t;function n(r){let i=r;return Y.defined(i)&&Y.string(i.title)&&Y.string(i.command)}e.is=n})(_o||(_o={}));var bo;(function(e){function t(s,a){return{range:s,newText:a}}e.replace=t;function n(s,a){return{range:{start:s,end:s},newText:a}}e.insert=n;function r(s){return{range:s,newText:""}}e.del=r;function i(s){let a=s;return Y.objectLiteral(a)&&Y.string(a.newText)&&_n.is(a.range)}e.is=i})(bo||(bo={}));var mu;(function(e){function t(r,i,s){let a={label:r};return i!==void 0&&(a.needsConfirmation=i),s!==void 0&&(a.description=s),a}e.create=t;function n(r){let i=r;return Y.objectLiteral(i)&&Y.string(i.label)&&(Y.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(Y.string(i.description)||i.description===void 0)}e.is=n})(mu||(mu={}));var yo;(function(e){function t(n){let r=n;return Y.string(r)}e.is=t})(yo||(yo={}));var Vg;(function(e){function t(s,a,u){return{range:s,newText:a,annotationId:u}}e.replace=t;function n(s,a,u){return{range:{start:s,end:s},newText:a,annotationId:u}}e.insert=n;function r(s,a){return{range:s,newText:"",annotationId:a}}e.del=r;function i(s){let a=s;return bo.is(a)&&(mu.is(a.annotationId)||yo.is(a.annotationId))}e.is=i})(Vg||(Vg={}));var _u;(function(e){function t(r,i){return{textDocument:r,edits:i}}e.create=t;function n(r){let i=r;return Y.defined(i)&&Tu.is(i.textDocument)&&Array.isArray(i.edits)}e.is=n})(_u||(_u={}));var bu;(function(e){function t(r,i,s){let a={kind:"create",uri:r};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),s!==void 0&&(a.annotationId=s),a}e.create=t;function n(r){let i=r;return i&&i.kind==="create"&&Y.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||Y.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||Y.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||yo.is(i.annotationId))}e.is=n})(bu||(bu={}));var yu;(function(e){function t(r,i,s,a){let u={kind:"rename",oldUri:r,newUri:i};return s!==void 0&&(s.overwrite!==void 0||s.ignoreIfExists!==void 0)&&(u.options=s),a!==void 0&&(u.annotationId=a),u}e.create=t;function n(r){let i=r;return i&&i.kind==="rename"&&Y.string(i.oldUri)&&Y.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||Y.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||Y.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||yo.is(i.annotationId))}e.is=n})(yu||(yu={}));var ku;(function(e){function t(r,i,s){let a={kind:"delete",uri:r};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),s!==void 0&&(a.annotationId=s),a}e.create=t;function n(r){let i=r;return i&&i.kind==="delete"&&Y.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||Y.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||Y.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||yo.is(i.annotationId))}e.is=n})(ku||(ku={}));var vu;(function(e){function t(n){let r=n;return r&&(r.changes!==void 0||r.documentChanges!==void 0)&&(r.documentChanges===void 0||r.documentChanges.every(i=>Y.string(i.kind)?bu.is(i)||yu.is(i)||ku.is(i):_u.is(i)))}e.is=t})(vu||(vu={}));var Ug;(function(e){function t(r){return{uri:r}}e.create=t;function n(r){let i=r;return Y.defined(i)&&Y.string(i.uri)}e.is=n})(Ug||(Ug={}));var Bg;(function(e){function t(r,i){return{uri:r,version:i}}e.create=t;function n(r){let i=r;return Y.defined(i)&&Y.string(i.uri)&&Y.integer(i.version)}e.is=n})(Bg||(Bg={}));var Tu;(function(e){function t(r,i){return{uri:r,version:i}}e.create=t;function n(r){let i=r;return Y.defined(i)&&Y.string(i.uri)&&(i.version===null||Y.integer(i.version))}e.is=n})(Tu||(Tu={}));var Hg;(function(e){function t(r,i,s,a){return{uri:r,languageId:i,version:s,text:a}}e.create=t;function n(r){let i=r;return Y.defined(i)&&Y.string(i.uri)&&Y.string(i.languageId)&&Y.integer(i.version)&&Y.string(i.text)}e.is=n})(Hg||(Hg={}));var wu;(function(e){e.PlainText="plaintext",e.Markdown="markdown";function t(n){let r=n;return r===e.PlainText||r===e.Markdown}e.is=t})(wu||(wu={}));var Zo;(function(e){function t(n){let r=n;return Y.objectLiteral(n)&&wu.is(r.kind)&&Y.string(r.value)}e.is=t})(Zo||(Zo={}));var Ei;(function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25})(Ei||(Ei={}));var Mr;(function(e){e.PlainText=1,e.Snippet=2})(Mr||(Mr={}));var zg;(function(e){e.Deprecated=1})(zg||(zg={}));var Gg;(function(e){function t(r,i,s){return{newText:r,insert:i,replace:s}}e.create=t;function n(r){let i=r;return i&&Y.string(i.newText)&&_n.is(i.insert)&&_n.is(i.replace)}e.is=n})(Gg||(Gg={}));var Xg;(function(e){e.asIs=1,e.adjustIndentation=2})(Xg||(Xg={}));var Qg;(function(e){function t(n){let r=n;return r&&(Y.string(r.detail)||r.detail===void 0)&&(Y.string(r.description)||r.description===void 0)}e.is=t})(Qg||(Qg={}));var Jg;(function(e){function t(n){return{label:n}}e.create=t})(Jg||(Jg={}));var Zg;(function(e){function t(n,r){return{items:n||[],isIncomplete:!!r}}e.create=t})(Zg||(Zg={}));var Fa;(function(e){function t(r){return r.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}e.fromPlainText=t;function n(r){let i=r;return Y.string(i)||Y.objectLiteral(i)&&Y.string(i.language)&&Y.string(i.value)}e.is=n})(Fa||(Fa={}));var Yg;(function(e){function t(n){let r=n;return!!r&&Y.objectLiteral(r)&&(Zo.is(r.contents)||Fa.is(r.contents)||Y.typedArray(r.contents,Fa.is))&&(n.range===void 0||_n.is(n.range))}e.is=t})(Yg||(Yg={}));var em;(function(e){function t(n,r){return r?{label:n,documentation:r}:{label:n}}e.create=t})(em||(em={}));var tm;(function(e){function t(n,r,...i){let s={label:n};return Y.defined(r)&&(s.documentation=r),Y.defined(i)?s.parameters=i:s.parameters=[],s}e.create=t})(tm||(tm={}));var nm;(function(e){e.Text=1,e.Read=2,e.Write=3})(nm||(nm={}));var im;(function(e){function t(n,r){let i={range:n};return Y.number(r)&&(i.kind=r),i}e.create=t})(im||(im={}));var Ia;(function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26})(Ia||(Ia={}));var rm;(function(e){e.Deprecated=1})(rm||(rm={}));var om;(function(e){function t(n,r,i,s,a){let u={name:n,kind:r,location:{uri:s,range:i}};return a&&(u.containerName=a),u}e.create=t})(om||(om={}));var sm;(function(e){function t(n,r,i,s){return s!==void 0?{name:n,kind:r,location:{uri:i,range:s}}:{name:n,kind:r,location:{uri:i}}}e.create=t})(sm||(sm={}));var am;(function(e){function t(r,i,s,a,u,f){let l={name:r,detail:i,kind:s,range:a,selectionRange:u};return f!==void 0&&(l.children=f),l}e.create=t;function n(r){let i=r;return i&&Y.string(i.name)&&Y.number(i.kind)&&_n.is(i.range)&&_n.is(i.selectionRange)&&(i.detail===void 0||Y.string(i.detail))&&(i.deprecated===void 0||Y.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}e.is=n})(am||(am={}));var cm;(function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"})(cm||(cm={}));var qa;(function(e){e.Invoked=1,e.Automatic=2})(qa||(qa={}));var lm;(function(e){function t(r,i,s){let a={diagnostics:r};return i!=null&&(a.only=i),s!=null&&(a.triggerKind=s),a}e.create=t;function n(r){let i=r;return Y.defined(i)&&Y.typedArray(i.diagnostics,Ma.is)&&(i.only===void 0||Y.typedArray(i.only,Y.string))&&(i.triggerKind===void 0||i.triggerKind===qa.Invoked||i.triggerKind===qa.Automatic)}e.is=n})(lm||(lm={}));var um;(function(e){function t(r,i,s){let a={title:r},u=!0;return typeof i=="string"?(u=!1,a.kind=i):_o.is(i)?a.command=i:a.edit=i,u&&s!==void 0&&(a.kind=s),a}e.create=t;function n(r){let i=r;return i&&Y.string(i.title)&&(i.diagnostics===void 0||Y.typedArray(i.diagnostics,Ma.is))&&(i.kind===void 0||Y.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||_o.is(i.command))&&(i.isPreferred===void 0||Y.boolean(i.isPreferred))&&(i.edit===void 0||vu.is(i.edit))}e.is=n})(um||(um={}));var fm;(function(e){function t(r,i){let s={range:r};return Y.defined(i)&&(s.data=i),s}e.create=t;function n(r){let i=r;return Y.defined(i)&&_n.is(i.range)&&(Y.undefined(i.command)||_o.is(i.command))}e.is=n})(fm||(fm={}));var dm;(function(e){function t(r,i){return{tabSize:r,insertSpaces:i}}e.create=t;function n(r){let i=r;return Y.defined(i)&&Y.uinteger(i.tabSize)&&Y.boolean(i.insertSpaces)}e.is=n})(dm||(dm={}));var pm;(function(e){function t(r,i,s){return{range:r,target:i,data:s}}e.create=t;function n(r){let i=r;return Y.defined(i)&&_n.is(i.range)&&(Y.undefined(i.target)||Y.string(i.target))}e.is=n})(pm||(pm={}));var hm;(function(e){function t(r,i){return{range:r,parent:i}}e.create=t;function n(r){let i=r;return Y.objectLiteral(i)&&_n.is(i.range)&&(i.parent===void 0||e.is(i.parent))}e.is=n})(hm||(hm={}));var gm;(function(e){e.namespace="namespace",e.type="type",e.class="class",e.enum="enum",e.interface="interface",e.struct="struct",e.typeParameter="typeParameter",e.parameter="parameter",e.variable="variable",e.property="property",e.enumMember="enumMember",e.event="event",e.function="function",e.method="method",e.macro="macro",e.keyword="keyword",e.modifier="modifier",e.comment="comment",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.decorator="decorator"})(gm||(gm={}));var mm;(function(e){e.declaration="declaration",e.definition="definition",e.readonly="readonly",e.static="static",e.deprecated="deprecated",e.abstract="abstract",e.async="async",e.modification="modification",e.documentation="documentation",e.defaultLibrary="defaultLibrary"})(mm||(mm={}));var _m;(function(e){function t(n){let r=n;return Y.objectLiteral(r)&&(r.resultId===void 0||typeof r.resultId=="string")&&Array.isArray(r.data)&&(r.data.length===0||typeof r.data[0]=="number")}e.is=t})(_m||(_m={}));var bm;(function(e){function t(r,i){return{range:r,text:i}}e.create=t;function n(r){let i=r;return i!=null&&_n.is(i.range)&&Y.string(i.text)}e.is=n})(bm||(bm={}));var ym;(function(e){function t(r,i,s){return{range:r,variableName:i,caseSensitiveLookup:s}}e.create=t;function n(r){let i=r;return i!=null&&_n.is(i.range)&&Y.boolean(i.caseSensitiveLookup)&&(Y.string(i.variableName)||i.variableName===void 0)}e.is=n})(ym||(ym={}));var km;(function(e){function t(r,i){return{range:r,expression:i}}e.create=t;function n(r){let i=r;return i!=null&&_n.is(i.range)&&(Y.string(i.expression)||i.expression===void 0)}e.is=n})(km||(km={}));var vm;(function(e){function t(r,i){return{frameId:r,stoppedLocation:i}}e.create=t;function n(r){let i=r;return Y.defined(i)&&_n.is(r.stoppedLocation)}e.is=n})(vm||(vm={}));var Ru;(function(e){e.Type=1,e.Parameter=2;function t(n){return n===1||n===2}e.is=t})(Ru||(Ru={}));var Cu;(function(e){function t(r){return{value:r}}e.create=t;function n(r){let i=r;return Y.objectLiteral(i)&&(i.tooltip===void 0||Y.string(i.tooltip)||Zo.is(i.tooltip))&&(i.location===void 0||La.is(i.location))&&(i.command===void 0||_o.is(i.command))}e.is=n})(Cu||(Cu={}));var Tm;(function(e){function t(r,i,s){let a={position:r,label:i};return s!==void 0&&(a.kind=s),a}e.create=t;function n(r){let i=r;return Y.objectLiteral(i)&&Si.is(i.position)&&(Y.string(i.label)||Y.typedArray(i.label,Cu.is))&&(i.kind===void 0||Ru.is(i.kind))&&i.textEdits===void 0||Y.typedArray(i.textEdits,bo.is)&&(i.tooltip===void 0||Y.string(i.tooltip)||Zo.is(i.tooltip))&&(i.paddingLeft===void 0||Y.boolean(i.paddingLeft))&&(i.paddingRight===void 0||Y.boolean(i.paddingRight))}e.is=n})(Tm||(Tm={}));var wm;(function(e){function t(n){return{kind:"snippet",value:n}}e.createSnippet=t})(wm||(wm={}));var Rm;(function(e){function t(n,r,i,s){return{insertText:n,filterText:r,range:i,command:s}}e.create=t})(Rm||(Rm={}));var Cm;(function(e){function t(n){return{items:n}}e.create=t})(Cm||(Cm={}));var xm;(function(e){e.Invoked=0,e.Automatic=1})(xm||(xm={}));var Dm;(function(e){function t(n,r){return{range:n,text:r}}e.create=t})(Dm||(Dm={}));var Sm;(function(e){function t(n,r){return{triggerKind:n,selectedCompletionInfo:r}}e.create=t})(Sm||(Sm={}));var Em;(function(e){function t(n){let r=n;return Y.objectLiteral(r)&&pu.is(r.uri)&&Y.string(r.name)}e.is=t})(Em||(Em={}));var Pm;(function(e){function t(s,a,u,f){return new xu(s,a,u,f)}e.create=t;function n(s){let a=s;return!!(Y.defined(a)&&Y.string(a.uri)&&(Y.undefined(a.languageId)||Y.string(a.languageId))&&Y.uinteger(a.lineCount)&&Y.func(a.getText)&&Y.func(a.positionAt)&&Y.func(a.offsetAt))}e.is=n;function r(s,a){let u=s.getText(),f=i(a,(c,g)=>{let k=c.range.start.line-g.range.start.line;return k===0?c.range.start.character-g.range.start.character:k}),l=u.length;for(let c=f.length-1;c>=0;c--){let g=f[c],k=s.offsetAt(g.range.start),d=s.offsetAt(g.range.end);if(d<=l)u=u.substring(0,k)+g.newText+u.substring(d,u.length);else throw new Error("Overlapping edit");l=k}return u}e.applyEdits=r;function i(s,a){if(s.length<=1)return s;let u=s.length/2|0,f=s.slice(0,u),l=s.slice(u);i(f,a),i(l,a);let c=0,g=0,k=0;for(;c<f.length&&g<l.length;)a(f[c],l[g])<=0?s[k++]=f[c++]:s[k++]=l[g++];for(;c<f.length;)s[k++]=f[c++];for(;g<l.length;)s[k++]=l[g++];return s}})(Pm||(Pm={}));var xu=class{constructor(t,n,r,i){this._uri=t,this._languageId=n,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(t){if(t){let n=this.offsetAt(t.start),r=this.offsetAt(t.end);return this._content.substring(n,r)}return this._content}update(t,n){this._content=t.text,this._version=n,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let t=[],n=this._content,r=!0;for(let i=0;i<n.length;i++){r&&(t.push(i),r=!1);let s=n.charAt(i);r=s==="\r"||s===`
`,s==="\r"&&i+1<n.length&&n.charAt(i+1)===`
`&&i++}r&&n.length>0&&t.push(n.length),this._lineOffsets=t}return this._lineOffsets}positionAt(t){t=Math.max(Math.min(t,this._content.length),0);let n=this.getLineOffsets(),r=0,i=n.length;if(i===0)return Si.create(0,t);for(;r<i;){let a=Math.floor((r+i)/2);n[a]>t?i=a:r=a+1}let s=r-1;return Si.create(s,t-n[s])}offsetAt(t){let n=this.getLineOffsets();if(t.line>=n.length)return this._content.length;if(t.line<0)return 0;let r=n[t.line],i=t.line+1<n.length?n[t.line+1]:this._content.length;return Math.max(Math.min(r+t.character,i),r)}get lineCount(){return this.getLineOffsets().length}},Y;(function(e){let t=Object.prototype.toString;function n(d){return typeof d<"u"}e.defined=n;function r(d){return typeof d>"u"}e.undefined=r;function i(d){return d===!0||d===!1}e.boolean=i;function s(d){return t.call(d)==="[object String]"}e.string=s;function a(d){return t.call(d)==="[object Number]"}e.number=a;function u(d,w,I){return t.call(d)==="[object Number]"&&w<=d&&d<=I}e.numberRange=u;function f(d){return t.call(d)==="[object Number]"&&-2147483648<=d&&d<=2147483647}e.integer=f;function l(d){return t.call(d)==="[object Number]"&&0<=d&&d<=2147483647}e.uinteger=l;function c(d){return t.call(d)==="[object Function]"}e.func=c;function g(d){return d!==null&&typeof d=="object"}e.objectLiteral=g;function k(d,w){return Array.isArray(d)&&d.every(w)}e.typedArray=k})(Y||(Y={}));var Dn=require("fs"),fs=require("fs/promises"),w_=require("child_process"),rr=require("path");var ci=require("fs"),wo=require("path"),D=zn(si());var Om=["true","false","unset","a_ahkpath","a_ahkversion","a_allowmainwindow","a_appdata","a_appdatacommon","a_args","a_clipboard","a_computername","a_comspec","a_controldelay","a_coordmodecaret","a_coordmodemenu","a_coordmodemouse","a_coordmodepixel","a_coordmodetooltip","a_cursor","a_dd","a_ddd","a_dddd","a_defaultmousespeed","a_desktop","a_desktopcommon","a_detecthiddentext","a_detecthiddenwindows","a_endchar","a_eventinfo","a_fileencoding","a_hotkeyinterval","a_hotkeymodifiertimeout","a_hour","a_iconfile","a_iconhidden","a_iconnumber","a_icontip","a_index","a_initialworkingdir","a_is64bitos","a_isadmin","a_iscompiled","a_iscritical","a_ispaused","a_issuspended","a_keydelay","a_keydelayplay","a_keyduration","a_keydurationplay","a_language","a_lasterror","a_linefile","a_linenumber","a_listlines","a_loopfield","a_loopfileattrib","a_loopfiledir","a_loopfileext","a_loopfilefullpath","a_loopfilename","a_loopfilepath","a_loopfileshortname","a_loopfileshortpath","a_loopfilesize","a_loopfilesizekb","a_loopfilesizemb","a_loopfiletimeaccessed","a_loopfiletimecreated","a_loopfiletimemodified","a_loopreadline","a_loopregkey","a_loopregname","a_loopregtimemodified","a_loopregtype","a_maxhotkeysperinterval","a_mday","a_menumaskkey","a_min","a_mm","a_mmm","a_mmmm","a_mon","a_mousedelay","a_mousedelayplay","a_msec","a_mydocuments","a_now","a_nowutc","a_osversion","a_priorhotkey","a_priorkey","a_programfiles","a_programs","a_programscommon","a_ptrsize","a_regview","a_screendpi","a_screenheight","a_screenwidth","a_scriptdir","a_scriptfullpath","a_scripthwnd","a_scriptname","a_sec","a_sendlevel","a_sendmode","a_space","a_startmenu","a_startmenucommon","a_startup","a_startupcommon","a_storecapslockmode","a_tab","a_temp","a_thisfunc","a_thishotkey","a_tickcount","a_timeidle","a_timeidlekeyboard","a_timeidlemouse","a_timeidlephysical","a_timesincepriorhotkey","a_timesincethishotkey","a_titlematchmode","a_titlematchmodespeed","a_traymenu","a_username","a_wday","a_windelay","a_windir","a_workingdir","a_yday","a_year","a_yweek","a_yyyy"],Am=["a_ahkdir","a_dlldir","a_dllpath","a_globalstruct","a_isdll","a_mainthreadid","a_memorymodule","a_modulehandle","a_scriptstruct","a_threadid"],Nm=["autotrim","blockinput","click","clipwait","control","controlclick","controlfocus","controlget","controlgetfocus","controlgetpos","controlgettext","controlmove","controlsend","controlsendraw","controlsettext","coordmode","critical","detecthiddentext","detecthiddenwindows","drive","driveget","drivespacefree","envadd","envdiv","envget","envmult","envset","envsub","envupdate","exit","exitapp","fileappend","filecopy","filecopydir","filecreatedir","filecreateshortcut","filedelete","fileencoding","filegetattrib","filegetshortcut","filegetsize","filegettime","filegetversion","fileinstall","filemove","filemovedir","fileopen","fileread","filereadline","filerecycle","filerecycleempty","fileremovedir","fileselectfile","fileselectfolder","filesetattrib","filesettime","format","formattime","getkeystate","gosub","groupactivate","groupadd","groupclose","groupdeactivate","gui","guicontrol","guicontrolget","hotkey","ifequal","ifexist","ifgreater","ifgreaterorequal","ifless","iflessorequal","ifmsgbox","ifnotequal","ifnotexist","ifwinactive","ifwinexist","ifwinnotactive","ifwinnotexist","imagesearch","inidelete","iniread","iniwrite","input","inputbox","keywait","listlines","menu","mouseclick","mouseclickdrag","mousegetpos","mousemove","msgbox","onerror","onexit","outputdebug","pause","pixelgetcolor","pixelsearch","postmessage","process","progress","random","regdelete","regread","regwrite","run","runas","runwait","send","sendevent","sendinput","sendlevel","sendmessage","sendmode","sendplay","sendraw","setbatchlines","setcapslockstate","setcontroldelay","setdefaultmousespeed","setenv","setformat","setkeydelay","setmousedelay","setnumlockstate","setregview","setscrolllockstate","setstorecapslockmode","settimer","settitlematchmode","setwindelay","setworkingdir","shutdown","sleep","sort","soundbeep","soundget","soundgetwavevolume","soundplay","soundset","soundsetwavevolume","splashimage","splashtextoff","splashtexton","splitpath","statusbargettext","statusbarwait","stringcasesense","stringleft","stringlower","stringright","stringtrimleft","stringtrimright","stringupper","suspend","sysget","thread","tooltip","transform","traytip","urldownloadtofile","winactivate","winactivatebottom","winclose","winget","wingetactivestats","wingetactivetitle","wingetclass","wingetpos","wingettext","wingettitle","winhide","winkill","winmaximize","winmenuselectitem","winminimize","winminimizeall","winminimizeallundo","winmove","winrestore","winset","winsettitle","winshow","winwait","winwaitactive","winwaitclose","winwaitnotactive"],Wn={space:" ",tab:"	"},Du=["str","astr","wstr","int64","int","uint","short","ushort","char","uchar","float","double","ptr","uptr","hresult"],Yo={"\uFF0C":",","\u3002":".","\uFF1B":";","\u2018":"'","\u2019":"'","\u3010":"[","\u3011":"]","\u300A":"<","\u300B":">","\uFF1F":"?","\uFF1A":":","\u201C":'"',"\u201D":'"',"\uFF08":"(","\uFF09":")","\uFF01":"!"},Lm=["abstract","access","alias","argument","async","augments","author","borrows","callback","class","classdesc","constant","constructor","constructs","copyright","default","deprecated","description","emits","enum","event","example","exports","extends","external","field","file","fileoverview","fires","function","generator","global","hideconstructor","host","ignore","implements","inheritdoc","inner","instance","interface","kind","lends","license","link","linkcode","linkplain","listens","member","memberof","method","mixes","module","name","namespace","overload","override","package","param","private","prop","property","protected","public","readonly","requires","returns","satisfies","see","since","static","summary","template","this","throws","todo","tutorial","type","typedef","var","variation","version","virtual","yields"];var Fm={},zi={author:He("completionitem.author","Add file infos about author, description, date, version."),comment:He("completionitem.generatecomment","Generate comment template of current function/method."),include:He("completionitem.include","Auto import from '{0}'"),prototype:He("completionitem.prototype","Retrieve or set the object on which all instances of the class are based."),thishotkey:He("completionitem.thishotkey","The hidden parameter to the hotkey function."),value:He("completionitem.value","Within the dynamic property 'set', 'Value' contains the value being assigned."),new:He("completionitem.new","export construct a new instance of the class."),this:He("completionitem.this","In the class, access other instance variables and methods of the class through 'this'."),super:He("completionitem.super","In the inherited class, 'super' can replace 'this' to access the superclass version of the method or property that is overridden in the derived class.")},Im={include:He("codeaction.include","Import '{0}'")},ee={acceptparams:He("diagnostic.acceptparams","'{0}' accepts {1} parameter(s)"),assignerr:He("diagnostic.assignerr","This {0} '{1}' cannot be used as an output variable"),classinfuncerr:He("diagnostic.classinfuncerr","Functions cannot contain classes"),classuseerr:He("diagnostic.classuseerr","This class cannot be used as an output variable"),conflictserr:He("diagnostic.conflictserr","This {0} declaration '{2}' conflicts with an existing {1}"),declarationerr:He("diagnostic.declarationerr","Unexpected declaration"),defaultvalmissing:He("diagnostic.defaultvalmissing","Parameter default required. Specifically: '{0}'"),deprecated:He("diagnostic.deprecated","Using '{0}' instead of '{1}'"),didyoumean:He("diagnostic.didyoumean","Did you mean to use '{0}'?"),dupdeclaration:He("diagnostic.dupdeclaration","Duplicate declaration"),duplabel:He("diagnostic.duplabel","Duplicate label"),filenotexist:He("diagnostic.filenotexist","'{0}' does not exist"),funccallerr:He("diagnostic.funccallerr","Function calls require a space or '(', use comma only between parameters"),funccallerr2:He("diagnostic.funccallerr2","In the expression, the function call requires parentheses"),globalconflicts:He("diagnostic.globalconflicts","This global declaration conflicts with an existing {0}"),hotdeferr:He("diagnostic.hotdeferr","Hotkeys/hotstrings cannot be defined in functions/classes"),hotmissbrace:He("diagnostic.hotmissbrace","Hotkey or hotstring is missing its opening brace"),invaliddefinition:He("diagnostic.invaliddefinition","Invalid {0} definition"),invalidencoding:He("diagnostic.invalidencoding","'{0}' invalid file encoding"),invalidhotdef:He("diagnostic.invalidhotdef","Invalid hotkey definition"),invalidparam:He("diagnostic.invalidparam","Invalid parameter definition"),invalidprop:He("diagnostic.invalidprop","Invalid dynamic property"),invalidpropname:He("diagnostic.invalidpropname","Invalid property name in object literal"),invalidsymbolname:He("diagnostic.invalidsymbolname","Invalid symbol naming '{0}'"),invalidsuper:He("diagnostic.invalidsuper","'super' is valid only inside a class"),invalidscope:He("diagnostic.invalidscope","'{0}' cannot be used in functions/classes"),maybehavenotmember:He("diagnostic.maybehavenotmember","Class '{0}' might not have member '{1}'"),maybev1:He("diagnostic.maybev1","This appears be a v1 script, continue parsing?"),missing:He("diagnostic.missing","Missing '{0}'"),missingparam:He("diagnostic.missingparam","Missing a required parameter"),missingoperand:He("diagnostic.missingoperand","Missing operand"),missingretval:He("diagnostic.missingretval","The function missing a return value"),missingspace:He("diagnostic.missingspace","Missing space or operator before this"),objectliteralerr:He("diagnostic.objectliteralerr","Error in object literal"),outofloop:He("diagnostic.outofloop","Break/Continue must be enclosed by a Loop"),paramcounterr:He("diagnostic.paramcounterr","Expected {0} parameters, but got {1}"),pathinvalid:He("diagnostic.pathinvalid","Invalid file path"),propdeclaraerr:He("diagnostic.propdeclaraerr","Not a valid method, class or property definition"),propemptyparams:He("diagnostic.propemptyparams","Empty [] not permitted"),propnotinit:He("diagnostic.propnotinit","Property declaration is not initialized"),requirev1:He("diagnostic.requirev1","This script requires AutoHotkey v1, continue parsing?"),requireVerN:e=>ee.requireversion(jm(e)),requireversion:He("diagnostic.requireversion","This feature requires the AutoHotkey version: {0}"),requirevariable:He("diagnostic.requirevariable","'&' requires a variable"),reservedworderr:He("diagnostic.reservedworderr","The following reserved word '{0}' must not be used as a variable name"),resourcenotfound:He("diagnostic.resourcenotfound","No resource found or could not be resolved"),skipline:He("diagnostic.skipline","The line is skipped and not resolved"),syntaxerror:He("diagnostic.syntaxerror","Syntax error. Specifically: {0}"),tryswitchtov1:He("diagnostic.tryswitchtov1","Try switching to AutoHotkey v1."),typemaybenot:He("diagnostic.typemaybenot","This param should be a '{0}'"),unexpected:He("diagnostic.unexpected","Unexpected '{0}'"),unknown:He("diagnostic.unknown","Unknown {0}"),unknownoperatoruse:He("diagnostic.unknownoperatoruse","Unknown operator use"),unknowntoken:He("diagnostic.unknowntoken","Unknown token '{0}'"),unsupportinclude:He("diagnostic.unsupportinclude","#Include in functions and classes cannot correctly deduce scope and code completion"),unterminated:He("diagnostic.unterminated","Unterminated string text")},Gi={callwithoutparentheses:He("warn.callwithoutparentheses","This function or method call has no parentheses"),localsameasglobal:He("warn.localsameasglobal","This local variable '{0}' has the same name as a global variable"),notimplemented:He("warn.notimplemented","This feature has not been implemented"),varisunset:He("warn.varisunset","Variable '{0}' appears to never be assigned a value")},Xi={ahkpatherr:He("setting.ahkpatherr","The AutoHotkey interpreter does not exist, re-specify in'Settings-AutoHotkey2.InterpreterPath'"),getenverr:He("setting.getenverr","Failed to get script built-in variables, such as A_MyDocuments, ..."),valueerr:He("setting.valueerr","The value of 'Settings-AutoHotkey2.{0}' is not valid. Expect '{1}'. Specifically: {2}"),versionerr:He("setting.versionerr","The current AutoHotkey.exe is not the v2 version, and cannot get the correct syntax analysis, completion and other functions")},Ka={switchtov1:He("action.switchtov1","Switch to ahk v1"),skipline:He("action.skipline","Skip the line"),stopparsing:He("action.stopparsing","Stop parsing")},Su={cannotrename:He("response.cannotrename","The element can't be renamed."),cannotrenamestdlib:He("response.cannotrenamestdlib","Elements defined in the standard AutoHotkey library can't be renamed.")};function qm(){{let e=Km(`${Qi}/package.nls.<>.json`,"utf8");Fm=e?JSON.parse(e):{}}}function He(e,t){return(...n)=>n.length?hk(Mm(e,t),...n):Mm(e,t)}function Mm(e,t){return Fm[e]||t}function hk(e,...t){return e.replace(/\{(\d+)\}/g,(...n)=>{let r=parseInt(n[1]);return r<t.length?t[r]:" "})}var jr=(g=>(g[g.class=0]="class",g[g.function=1]="function",g[g.method=2]="method",g[g.module=3]="module",g[g.parameter=4]="parameter",g[g.variable=5]="variable",g[g.property=6]="property",g[g.keyword=7]="keyword",g[g.string=8]="string",g[g.number=9]="number",g[g.operator=10]="operator",g))(jr||{}),Eu={type:0},ja={type:7},ko={type:9},$m={type:10},gk={type:4},Wm={type:6},$a={type:8},rs=(s=>(s[s.static=1]="static",s[s.readonly=2]="readonly",s[s.definition=4]="definition",s[s.defaultLibrary=8]="defaultLibrary",s[s.deprecated=16]="deprecated",s))(rs||{});var yi;(t=>{function e(n,r,i,s,a,u,f){let l="",c=!1,g=!1,k=[];a.format?.(a);for(let d of a)k.push(l.length),l+=`, ${d.pass_by_ref?(c=!0,++k[k.length-1],"&"):""}${d.name}${d.defaultVal?` := ${d.defaultVal}`:d.defaultVal===null?"?":d.arr?(g=!0,"*"):""}`;return{assume:0,static:f,variadic:g,children:u,hasref:c,name:n,kind:r,range:i,selectionRange:s,params:a,param_offsets:k,param_def_len:l.length||2,full:`${f?"static ":""}${n}(${l.substring(2)})`,declaration:{},global:{},local:{},labels:{}}}t.create=e})(yi||={});var rn;(t=>{function e(n,r,i){return{name:n,kind:r,range:i,selectionRange:{...i}}}t.create=e})(rn||={});function Fn(e){return e<48?!1:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e>127}String.prototype.trim=function(){return this.replace(/^[ \t\r\n]+|[ \t\r\n]+$/g,"")};String.prototype.trimStart=function(){return this.replace(/^[ \t\r\n]+/,"")};String.prototype.trimEnd=function(){return this.replace(/[ \t\r\n]+$/,"")};var mk=new RegExp(/['" \t](c|background|#)?((0x)?[\da-f]{6}([\da-f]{2})?|(black|silver|gray|white|maroon|red|purple|fuchsia|green|lime|olive|yellow|navy|blue|teal|aqua))\b/i),_k=JSON.parse('{ "black": "000000", "silver": "c0c0c0", "gray": "808080", "white": "ffffff", "maroon": "800000", "red": "ff0000", "purple": "800080", "fuchsia": "ff00ff", "green": "008000", "lime": "00ff00", "olive": "808000", "yellow": "ffff00", "navy": "000080", "blue": "0000ff", "teal": "008080", "aqua": "00ffff" }'),Vn=` 	\r
`,Nu="% : + ++ - -- * ** / // & && | || ^ < << <= = == => > >> >>> >= ? ?? ! != !== ~ ~= := += -= *= /= //= &= |= ^= ??= <<= >>= >>>=".split(" "),Lu="export break case continue for global goto if local loop return static switch throw try while".split(" "),Mu=Lu.concat("as catch else false finally isset super true until and contains in is not or".split(" ")),rt={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",Conditional:"Conditional",Expression:"Expression"},Hm=/^(alttab|alttabandmenu|alttabmenu|alttabmenudismiss|shiftalttab|shift|lshift|rshift|alt|lalt|ralt|control|lcontrol|rcontrol|ctrl|lctrl|rctrl|lwin|rwin|appskey|lbutton|rbutton|mbutton|wheeldown|wheelup|wheelleft|wheelright|xbutton1|xbutton2|(0*[2-9]|0*1[0-6]?)?joy0*([1-9]|[12]\d|3[012])|space|tab|enter|escape|esc|backspace|bs|delete|del|insert|ins|pgdn|pgup|home|end|up|down|left|right|printscreen|ctrlbreak|pause|help|sleep|scrolllock|capslock|numlock|numpad0|numpad1|numpad2|numpad3|numpad4|numpad5|numpad6|numpad7|numpad8|numpad9|numpadmult|numpadadd|numpadsub|numpaddiv|numpaddot|numpaddel|numpadins|numpadclear|numpadleft|numpadright|numpaddown|numpadup|numpadhome|numpadend|numpadpgdn|numpadpgup|numpadenter|f1|f2|f3|f4|f5|f6|f7|f8|f9|f10|f11|f12|f13|f14|f15|f16|f17|f18|f19|f20|f21|f22|f23|f24|browser_back|browser_forward|browser_refresh|browser_stop|browser_search|browser_favorites|browser_home|volume_mute|volume_down|volume_up|media_next|media_prev|media_stop|media_play_pause|launch_mail|launch_media|launch_app1|launch_app2|vk[a-f\d]{1,2}(sc[a-f\d]+)?|sc[a-f\d]+|`[;{]|[\x21-\x7E])$/i,ot={type:"",content:"",offset:0,length:0,topofline:0,next_token_offset:-1},vo=[":=","??="],bk=Nu.indexOf(":="),yk=Mu.indexOf("and"),Pu=["[","{","=>"],zm="isset throw super false true".split(" "),Ir={collapse:2,expand:1,none:0},yn={start:{line:0,character:0},end:{line:0,character:0}},Ou=["__NEW","__INIT","__ITEM","__ENUM","__GET","__CALL","__SET","__DELETE"],sn=Yi("Any"),Ba=Yi("Float",D.SymbolKind.Number),Ha=Yi("Integer",D.SymbolKind.Number),Pi=Yi("Number",D.SymbolKind.Number),vi=Yi("String",D.SymbolKind.String),Wa=Yi("Array",D.SymbolKind.Class,"Array"),ki=Yi("Object",D.SymbolKind.Class),kk=Yi("unset",D.SymbolKind.Null),Ai=Yi("VarRef",D.SymbolKind.Class,"Any"),Iu={...vi},qu={...vi},za={...vi},Ro={def:!0,detail:zi.this(),is_param:!0,kind:D.SymbolKind.Variable,name:"this",range:yn,selectionRange:yn},ns={...Ro,name:"super",detail:zi.super()},$t=new RegExp("^[^\0-/:-@[-^`{-\x7F]+$"),es,Vm={$DIRPATH:qu,$DLLFUNC:Iu,$FILEPATH:za,ANY:sn,ARRAY:Wa,FLOAT:Ba,INTEGER:Ha,NUMBER:Pi,OBJECT:ki,STRING:vi,UNSET:kk,VARREF:Ai},Va=class{message;token;constructor(t,n){this.message=t,this.token=n}},Un=class e{actionwhenv1="Continue";actived=!1;beautify;checkmember;children=[];d=0;d_uri="";declaration={};diagnostics=[];diag_pending;diag_timer;last_diags=0;dlldir=new Map;dllpaths=[];document;find_token;foldingranges=[];fsPath="";get_token;need_scriptdir=!1;include={};includedir=new Map;isparsed=!1;is_virtual=!1;labels={};libdirs=[];linepos={};maybev1;object={method:{},property:{}};parseScript;scriptdir="";scriptpath="";STB=new D.SemanticTokensBuilder;symbolInformation;texts={};typedef={};tokenranges=[];tokens={};uri="";workspaceFolder="";hotstringExecuteAction=!1;constructor(t,n,r=0){let i,s,a,u,f,l,c,g,k,d,w,I,G,x,m,y,h,W,_=this,de=hn.parse(t.uri),ye=!0,pe=!0,Ve=!1,le=Zi,N=!1,V=0,Re=!1,Ce=!1,xe,R,pt,Ut,De,qt,fn,St,Ne,ft,wt,Lt,ct,H,ne,Ke,$e={TK_START_EXPR:hs,TK_END_EXPR:uc,TK_START_BLOCK:J,TK_END_BLOCK:v,TK_WORD:F,TK_RESERVED:F,TK_STRING:q,TK_EQUALS:T,TK_OPERATOR:X,TK_COMMA:b,TK_BLOCK_COMMENT:he,TK_INLINE_COMMENT:dn,TK_COMMENT:Yt,TK_DOT:ei,TK_HOT:ni,TK_SHARP:ni,TK_NUMBER:ti,TK_LABEL:Mt,TK_HOTLINE:ni,TK_UNKNOWN:sr};this.document=t,t.uri&&(ye=!1,this.uri=t.uri.toLowerCase(),this.setWorkspaceFolder(),this.scriptpath=(this.fsPath=de.fsPath).replace(/[\\/][^\\/]+$/,""),this.initLibDirs(n),de.scheme!=="file"&&de.fsPath.substring(1,3)===":\\"&&(this.is_virtual=!0)),this.get_token=function(C,P=!1){let A,L,ie;for(C!==void 0&&(A=h,ie=m,h=C);(L=gn()).type.endsWith("COMMENT")&&P;);return C!==void 0&&(h=A,m=ie),L},this.find_token=function(C,P=!1){let A=C,L=d[C],ie,$=_.tokens,o={...$[-1]??ot,type:""};if(!L)return o;if(Vn.includes(L)){for(;Vn.includes(L=d[++A]););if(ie=$[A])return ie;if(!L&&(ie=$[_.tokenranges[_.tokenranges.length-1]?.start])){if(ie.offset<=C&&C<ie.offset+ie.length)return ie;ie=void 0}}else{if(Fn(L.charCodeAt(0)))for(;Fn(d.charCodeAt(--A)););else for(;!Vn.includes(L=d.charAt(--A))&&!Fn(L.charCodeAt(0)););if(!(ie=$[++A]??$[A-1])&&d[A]==="."){for(;Fn(d.charCodeAt(--A)););ie=$[A+1]}}if(!ie&&d.slice(A=d.lastIndexOf(`
`,A)+1,C).trim()&&(ie=_.find_token(A)),ie){if(ie.offset<=C&&C<ie.offset+ie.length)return ie;for(;(ie=$[ie.next_token_offset])&&!(ie.offset>C);)if(C<ie.offset+ie.length)return ie}return!P&&_.findStrOrComment(C)||o},this.beautify=function(C,P){let A;for(!_.isparsed&&_.parseScript(),De={break_chained_methods:!1,ignore_comment:!1,indent_string:"	",max_preserve_newlines:3,preserve_newlines:!0,space_before_conditional:!0,space_after_double_colon:!0,space_in_empty_paren:!1,space_in_other:!0,space_in_paren:!1,wrap_line_length:0,...C},ct=H="",i=!0,m={...ot},x=-1,A=w,Ne=_.get_token(0),qt=d.substring(d.lastIndexOf(`
`,h=Ne.offset)+1,h),Ke=ne=!1,Ve=!0,fn=De.indent_string??"	",St=De.space_in_other??!0,xe=[O()],Ut=[],R=void 0,lt(rt.BlockStatement),De.symbol_with_same_case&&Tr({textDocument:_.document}),P&&(A=_.document.offsetAt(P.end),Ne=_.find_token(_.document.offsetAt(P.start)),P.start=_.document.positionAt(h=Ne.offset),qt=d.substring(d.lastIndexOf(`
`,h)+1,h).match(/^[ \t]*/)[0]);;){if(Lt=(Ne=gn()).type,wt=(ft=Ne.content).toLowerCase(),Ne.fat_arrow_end)for(;R.in_fat_arrow;)kt();if(Ne.offset>=A){if(P){let $=Ne.previous_token,o=h;if(ct==="TK_RESERVED"&&["try","else","finally"].includes(H)&&yt(),(!R.declaration_statement||!Ae())&&Se(),$?.type){for(;(Ne=_.find_token($.skip_pos??$.offset+$.length)).offset<A;)$=Ne;for(o=$.offset+$.length;" 	".includes(d[o]);o++);for(Vn.includes(d.charAt(o))||(o=$.offset+$.length);Ae();)xe.pop()}P.end=_.document.positionAt(o),C.indent_string=qt+fn.repeat(R.indentation_level)}for(;R.mode===rt.Statement;)kt();break}else if(Ke&&!(Ke=y?!ie(Ne):Lt!=="TK_START_BLOCK"||Ne.data))kt(),ct="TK_END_EXPR",R.last_text=")",I=y>0;else if(I=y>0){if(u!==!1){Se();for(let $=1;$<y;$++)xe.push(O())}else if(!Ke&&!R.in_expression&&(Ne.type.endsWith("COMMENT")||!bn(R.mode===rt.Statement?Ne.previous_token??ot:{},Ne))&&!(ct==="TK_RESERVED"&&["catch","else","finally","until"].includes(H))){De.max_preserve_newlines&&y>De.max_preserve_newlines&&(y=De.max_preserve_newlines),Ae()||xe.push(O());for(let $=1;$<y;$++)xe.push(O())}}$e[Lt](),Lt.endsWith("COMMENT")||(!Ke&&Lt==="TK_RESERVED"&&["if","for","while","loop","catch","switch"].includes(wt)&&(Ke=!0,lt(rt.Conditional),wt!=="switch"&&yt()),R.last_text=wt,R.had_comment=0,ct=Lt,H=wt)}let L=xe.map($=>$.text.join("")).join(`
`);return xe=[],Ve=!1,L;function ie($){if(![rt.Conditional,rt.Statement].includes(R.mode)||R.parent.mode===rt.ObjectLiteral)return!1;switch($.type){case"TK_DOT":case"TK_COMMA":case"TK_EQUALS":case"TK_COMMENT":case"TK_INLINE_COMMENT":case"TK_BLOCK_COMMENT":return!1;case"TK_OPERATOR":return/^(!|~|not|%|\+\+|--)$/i.test($.content)&&!bn($.previous_token??ot,$);case"TK_STRING":return!$.ignore&&!bn($.previous_token??ot,$);default:{let o=$.previous_token??ot;switch(o.type){case"TK_COMMA":case"TK_EQUALS":return!1;case"TK_OPERATOR":return/^(\+\+|--|%)$/.test(o.content)}}}return!0}};function Bt(C,P){De={max_preserve_newlines:1},St=!0,fn="	",Ve=!0,qt="",delete P.format;for(let A of P){if(!A.range_offset)continue;let[L,ie]=A.range_offset;for(ct=H="",xe=[O()],ne=!1,Ut=[],R=void 0,lt(rt.Expression),Ne=C[C[L].next_token_offset];Ne&&Ne.offset<ie;Ne=C[Ne.next_token_offset])Lt=Ne.type,ft=Ne.content,wt=ft.toLowerCase(),$e[Lt](),ct=Lt,R.last_text=H=wt;A.defaultVal=xe.map($=>$.text.join("")).join(`
`).trim()}Ve=!1,xe=[]}if(r||/\.d\.(ahk2?|ah2)$/i.test(this.fsPath))this.d=r||1,ye||=!0,this.parseScript=function(){let C=[],P=[],A=this.uri,L="",ie=0,$=0,o=0,p=0,ut=!1,U=we(0,0),Je=D.DocumentSymbol.create("",void 0,D.SymbolKind.Namespace,U,U,this.children),te=[],ce,S,Fe;for(this.clear(),l={region:[],bracket:[]},a={},W=[],d=this.document.getText(),w=d.length,g=this.scriptpath,m={...ot},i=!0,h=0,x=-1,f=G=void 0,k=this.include,Je.property=Je.$property=this.declaration;gn().length;);for(te=Object.values(this.tokens),o=te.length;ie<o;)switch((ce=te[ie]).type){case"TK_WORD":if(ce.topofline>0){if(ie<o-4&&ce.content==="class"){ce.type="TK_RESERVED";break}}else if(!ut){ie++;break}if($=ie+1,$<o){if(p&&((S=te[$]).topofline||["=>","?",":","[","{"].includes(S.content))){let Ue=rn.create(ce.content,D.SymbolKind.Property,U=we(ce.offset,ce.length)),_e=Ue,se={type:6,modifier:4|ut},Be=S.content==="=>";ce.symbol=ce.definition=Ue,_e.parent=Je,_e.has_this_param=!0;let ge=[];if(Ou.includes(L=Ue.name.toUpperCase())||(ce.semantic=se),Ue.static=ut,Ue.full=`(${P.join(".")}) ${ut?"static ":""}`+Ue.name,(Fe=a[Ue.selectionRange.start.line])&&Xe(Fe.symbol=Ue,Fe),Je.children?.push(Ue),Je.since||((ut?Je.property:Je.$property)[L]??=Ue,(this.object.property[L]??=[]).push(Ue)),S.content==="["){if(ge=tt("]"),ge.length){_e.children=_e.params=ge,_e.full+=`[${ge.full}]`,_e.param_offsets=ge.offset,_e.param_def_len=ge.full.length+2,_e.declaration=_e.local={};for(let qe of ge)_e.local[L=qe.name.toUpperCase()]??=qe}if(!(S=te[++$]))break}if(S.content==="{"){let qe=Ue;for(;(ce=te[++$]).content!=="}";)if(ce.content==="=>"){let ht=yi.create(S.content,D.SymbolKind.Function,U=we(S.offset,S.length),{...U},ge);L=S.content.toLowerCase(),ht.parent=Ue,S.symbol=S.definition=ht,Ze(ht),(L==="get"||L==="set")&&(ht.has_this_param=!0,qe[L]=ht)}else S=ce;Ue.type_annotations=qe.get?.type_annotations,Be=!!(qe.get&&!qe.set),Ue.range.end=this.document.positionAt(ce.offset+ce.length)}else if(S.content==="=>"){let qe=yi.create("get",D.SymbolKind.Function,U=we(S.offset,S.length),{...U},ge);qe.parent=Ue,Ue.get=qe,Be=!0,qe.has_this_param=!0,Ze(qe),Ue.type_annotations=qe.type_annotations,Ue.range.end=qe.range.end}else delete _e.has_this_param,S.content==="?"&&(S.ignore=!0,S=te[++$],Ue.defaultVal=null),S?.content===":"?Ze(Ue):(S=te[--$],Ue.range.end=this.document.positionAt(S.offset+S.length));Be&&(se.modifier|=2)}else if((S=te[$]).content==="("){let Ue=tt(),_e=_t(ce.content,Ue,we(ce.offset,ce.length),ut);if(te[$+1]?.content==="=>"?(++$,Ze(_e)):_e.range.end=this.document.positionAt(S.offset+S.length),_e.full+=` => ${ai(_e.type_annotations)||"void"}`,ce.symbol=ce.definition=_e,Ou.includes(L=_e.name.toUpperCase())||(ce.semantic={type:p?2:1,modifier:6|ut}),(Fe=a[_e.selectionRange.start.line])&&Xe(Fe.symbol=_e,Fe),Je.children?.push(_e),Je.since??_e.since)p||(Kr[L]=_e.since);else{p&&(_e.has_this_param=!0,_e.kind=D.SymbolKind.Method,_e.full=`(${P.join(".")}) ${_e.full}`,_e.parent=Je,(this.object.method[L]??=[]).push(_e));let se=ut?Je.property:Je.$property;se[L]?se[L].call=_e:se[L]=_e}}else if(!p&&(["=>",":",","].includes(S.content)||S.topofline)){let Ue=rn.create(ce.content,D.SymbolKind.Variable,U=we(ce.offset,ce.length));ce.symbol=ce.definition=Ue,Ue.assigned=Ue.def=!0,(Fe=a[Ue.selectionRange.start.line])&&Xe(Fe.symbol=Ue,Fe),["=>",":"].includes(S.content)?Ze(Ue):S.content!==","&&--$,L=Ue.name.toUpperCase(),Je.children.push(Ue),Ue.since?Kr[L]=Ue.since:Je.property[L]??=Ue}}ie=$+1,ut=!1;break;case"TK_RESERVED":if(ut=!1,ce.topofline!==1)ce.type="TK_WORD";else if((L=ce.content.toLowerCase())==="static")ut=!0,ie++;else if(L==="class"){let Ue="",_e=D.DocumentSymbol.create((ce=te[++ie]).content,void 0,D.SymbolKind.Class,we(te[ie-1].offset,0),we(ce.offset,ce.length),[]);if($=ie+1,P.push(_e.name),ce.semantic={type:0,modifier:6},ce.symbol=ce.definition=_e,_e.extends="",_e.uri??=this.uri,(S=te[$])?.content==="<"&&!S.topofline){let se={},Be=0;for(;(S=te[++$])?.type==="TK_WORD";){let ge=we(S.offset,S.length),qe={name:S.content,data:Be,kind:D.SymbolKind.TypeParameter,range:ge,selectionRange:ge};if(Be++,se[S.content.toUpperCase()]??=qe,(S=te[++$])?.content==="="&&(Ze(qe),S=te[++$]),S?.content!==",")break}S?.content===">"?(_e.type_params=se,S=te[++$]):At(">")}if(S?.content.toLowerCase()==="extends"){for((S=te[$+1])?.type==="TK_WORD"&&this.children.push(rn.create(S.content,D.SymbolKind.Variable,we(S.offset,S.length)));++$<o&&(S=te[$]).content!=="{";)Ue+=S.content;_e.extends=Ue}(Fe=a[_e.selectionRange.start.line])&&Xe(Fe.symbol=_e,Fe),_e.full=P.join("."),_e.property={},_e.prototype={..._e,detail:void 0,property:_e.$property={}},L=_e.name.toUpperCase(),Je.children.push(_e),_e.since?p||(Kr[L]=_e.since):(!p&&_e.name.startsWith("$")?_.typedef:Je.property)[L]??=_e,p++,C.push(Je),Je=_e,_e.type_annotations=[_e.full],ie=$+1}else L==="global"&&te[ie+1].type==="TK_WORD"?ie++:ce.type="TK_WORD";break;case"TK_END_BLOCK":p&&(Je.range.end=Je.prototype.range.end=this.document.positionAt(ce.offset+ce.length),Je.property.PROTOTYPE={...Je.prototype,children:void 0,name:"Prototype",kind:D.SymbolKind.Property,full:`(${Je.full}) Prototype`,selectionRange:yn,type_annotations:[Je.full]},Je.uri=A,(Je=Je.prototype).uri=A,this.addFoldingRangePos(Je.range.start,Je.range.end),Object.values(Je.property).forEach(Ue=>Ue.parent=Je),p--,P.pop(),Je=C.pop());default:ie++,ut=!1;break}if(this.d<0)return;if(this.d&2){let Ue=A.endsWith("/ahk2_h.d.ahk")?1:0,_e;for(let[se,Be]of Object.entries(this.declaration))switch(Be.kind){case D.SymbolKind.Function:Be.def=!1,Be.uri=A;case D.SymbolKind.Class:Be.overwrite??=Ue,Be.def??=!0,(!(_e=Wt[se])||Ue>=(_e.overwrite??0))&&(Wt[se]=Be);break;case D.SymbolKind.Variable:Be.def&&(Wt[se]=Be,Be.uri=A);break}}st(),Co({},this.children,this),this.isparsed=!0,l.region.forEach(Ue=>this.addFoldingRange(Ue,h-1,"region"));function Ze(Ue){let _e=se();if((S=te[--$])||(S=te[$=te.length-1]),_e.length){let Be=new Set(_e);Be.delete("void"),Ue.type_annotations=Array.from(Be)}return Ue.range.end=_.document.positionAt(S.offset+S.length),$;function se(){let Be,ge,qe,ht,Et=[];e:for(;S=te[++$];){switch(S.type){case"TK_WORD":for(qe=S.content,ht="TK_WORD",(ge=qe==="typeof")&&te[$+1]?.type===ht&&!te[$+1].topofline&&(S.semantic=$m,S=te[++$],qe=S.content),(qe.toLowerCase()!=="this"||Ue.kind===D.SymbolKind.Function&&Ue.parent?.kind!==D.SymbolKind.Property)&&(S.semantic=Eu);(S=te[++$])&&!S.topofline&&S.type!==ht&&(/^[.#~]$/.test(S.content)||S.type==="TK_WORD"&&(S.semantic=Eu));)qe+=S.content,ht=S.type;if(S?.content==="<"&&!S.topofline){let gt=[];for(;;){if(gt.push(se()),!S||S.content===">"){let nn={name:qe,kind:qe.toLowerCase()==="comobject"?D.SymbolKind.Interface:D.SymbolKind.Class,extends:qe,full:`${qe}<${gt.map(zt=>ai(zt)).join(", ")}>`,range:yn,selectionRange:yn};nn.generic_types=gt,ge?nn.prototype={...nn}:nn.data=Vm[qe.toUpperCase()],Et.push(nn),S=te[++$];break}if(S.content!==","){At(">"),S=te[++$];break}}}else qe&&Et.push(ge?`typeof ${qe}`:Vm[qe.toUpperCase()]??qe);break;case"TK_NUMBER":case"TK_STRING":Et.push(S.content),S=te[++$];break;case"TK_START_BLOCK":{let gt="",nn={},zt=S,Sn=["TK_NUMBER","TK_RESERVED","TK_WORD"];for(;Sn.includes((S=Kt())?.type);){let Pt=rn.create(S.content,D.SymbolKind.Property,we(S.offset,S.length));if(nn[S.content.toUpperCase()]??=Pt,S.semantic=Wm,gt+=", "+S.content,Fe&&Fe===a[Pt.selectionRange.start.line]&&Xe(Pt,Fe),(S=te[++$])?.content==="?"&&(S.ignore=!0,S=te[++$],Pt.defaultVal=null,gt+="?"),S?.content===":"&&(Ze(Pt),S=te[++$],gt+=`: ${ai(Pt.type_annotations)||"unknown"}`),S?.content!==",")break;Fe=void 0}if(S?.content==="}"){let Pt=D.DocumentSymbol.create("",void 0,D.SymbolKind.Class,yn,yn);Pt.property=nn,Pt.name=Pt.extends="",Pt.uri=_.uri,Et.push(zt.data=S.data=Pt),Pt.full=(gt=gt.substring(2))&&`{ ${gt} }`}else At("}"),zt.data=ki,S?.content==="}"&&(S.data=ki);S=te[++$];break}case"TK_COMMENT":case"TK_BLOCK_COMMENT":Fe=S;case"TK_INLINE_COMMENT":continue;default:if(S.content==="(")if(",:=?&*)[".includes((Be=te[$+2])?.content??"\0")||Be?.content==="=>"){let gt=S.offset,nn=tt(),zt=_t("",nn,we(gt,0));if($>=o)break e;te[$+1]?.content==="=>"?(++$,Ze(zt),S=te[++$]):zt.range.end=_.document.positionAt(S.offset+S.length),zt.full+=` => ${ai(zt.type_annotations)||"void"}`,Et.push(zt),zt.uri=_.uri,Fe&&Fe===a[zt.selectionRange.start.line]&&Xe(Fe.symbol=zt,Fe)}else Et.push(...se()),S?.content===")"&&(S=te[++$]);else if(S.content==="-"&&(S=te[++$])?.type==="TK_NUMBER")Et.push(`-${S.content}`),S=te[++$];else{S.content.toLowerCase()==="throw"&&S.previous_token?.content==="=>"&&(S=te[++$]);break e}break}if(S?.content!=="|")break;Fe=void 0}return Et}}function tt(Ue=")"){let _e=[],se=_e.offset??=[],Be=[],ge,qe,ht=!0,Et=0,gt="";e:for(;(S=te[++$])&&S.content!==Ue;)switch(S.type){case"TK_STRING":if(ht!==!0){At(Ue);break}ge=rn.create(S.content,D.SymbolKind.String,we(S.offset,S.length)),se.push(gt.length),gt+=S.content,_e.push(ge),ht=!1,(S=te[++$])?.content==="["?(Et++,S.ignore=!0,gt+=" ["):$--;break;case"TK_WORD":if(!ht){At(Ue);break e}if(ge=rn.create(S.content,D.SymbolKind.Variable,we(S.offset,S.length)),ht===1&&(_e.hasref=ge.pass_by_ref=!0,gt+="&",ht=!0),ge.assigned=ge.def=ge.is_param=!0,_e.push(ge),S.semantic=gk,se.push(gt.length),gt+=S.content,S=te[++$],Et&&(ge.defaultVal=!1),S?.content==="*"?(_e.variadic=ge.arr=!0,S=te[++$],gt+="*"):S?.content==="?"&&(ge.defaultVal=null,S.ignore=!0,S=te[++$],gt+="?"),S?.content===":"&&(S=te[$=Ze(ge)+1],gt+=`: ${ai(ge.type_annotations)||"unknown"}`),!S||S.content===":="&&(!(S=te[++$])||S.content===Ue||(ge.defaultVal=S.content,"-+".includes(S.content)&&te[$+1]?.type==="TK_NUMBER"&&(ge.defaultVal+=te[++$].content),gt+=` := ${ge.defaultVal}`,!(S=te[++$]))))break e;S.content==="["?(Et++,S.ignore=!0,S=te[++$],gt+=" ["):Et&&S.content==="]"&&(Et--,S.ignore=!0,S=te[++$],gt+="]"),S?.content===","?gt+=", ":($--,ht=!1);break;default:if(S.content===","){if(ht){At(Ue);break e}gt+=", ",ht=!0}else if(S.content==="*"){if(!ht){At(Ue);break e}ge=rn.create("",D.SymbolKind.Variable,we(S.offset,0)),_e.variadic=ge.arr=ge.assigned=ge.def=ge.is_param=!0,Et&&(ge.defaultVal=!1),ht=!1,Be.push(gt.length),gt+="*",qe?qe.data=_e.length%(qe.arr=2):qe=ge}else if(S.content==="[")Et++,S.ignore=!0,gt+="[";else if(Et&&S.content==="]")Et--,S.ignore=!0,gt=gt.trimEnd()+"] ";else if(ht===!0&&S.content==="&")ht=1,S.op_type=-1;else{At(Ue);break e}break}return _e.full=gt,qe&&(_e.push(qe),se.push(...Be)),_e}function _t(Ue,_e,se,Be=!1){let ge={assume:0,children:[],declaration:{},full:`${Be?"static ":""}${Ue}(${_e.full})`,global:{},local:{},hasref:_e.hasref,kind:D.SymbolKind.Function,labels:{},name:Ue,param_def_len:_e.full.length+2,param_offsets:_e.offset,params:_e,range:se,selectionRange:{...se},static:Be,variadic:_e.variadic};ge.local=ge.declaration;for(let qe of _e)ge.local[qe.name.toUpperCase()]=qe;return delete ge.local[""],ge}function Kt(){for(;(S=te[++$])?.type.endsWith("COMMENT")&&(Fe=S););return S}function At(Ue){let _e=1,se={">":"<",")":"(","]":"[","}":"{"}[Ue];for(ke(S??=te.at(-1));(S=te[++$])&&(S.content!==Ue||--_e);){if(S.topofline>0)return $--;S.content===se&&++_e}}};else{let C=this.fsPath.replace(/\.\w+$/,".d.ahk");this.fsPath.endsWith("2")||delete this.actionwhenv1,this.parseScript=function(){d=this.document.getText(),w=d.length,g=this.scriptpath,c="",i=!0,Re=!1,V=0,m={...ot},f=G=void 0,h=0,x=-1,l={region:[],bracket:[]},u=!1,le=Zi,this.clear(),k=this.include,a={},W=[],s=bt.Warn?.CallWithoutParentheses;try{let P=Ni.get_RCDATA("#2");P&&(k[P.uri]=P.path),this.children.push(...je())}catch(P){N=Re=Ce=!1,P instanceof Va?P.message&&this.addDiagnostic(P.message,P.token.offset,P.token.length,{severity:D.DiagnosticSeverity.Warning}):console.error(P)}{let P=this.d_uri&&Jt(Dt(this.d_uri))||Jt(C);P?k[this.d_uri=P.uri]=P.path:this.d_uri=""}st(),Co(this.declaration,this.children,this),this.isparsed=!0,l.region.forEach(P=>this.addFoldingRange(P,h-1,"region")),this.actived&&(this.actionwhenv1??="Continue")}}function ke(C){C.has_warned??=(_.addDiagnostic(ee.unexpected(C.content),C.offset,C.length),!0)}function dt(C){_.addDiagnostic(ee.unexpected("`n"),d.lastIndexOf(`
`,C.offset),1)}function st(){for(let C of Object.values(a))C.data!==null||!/^[ \t]*\*?[ \t]*@typedef\s/m.test(C.content)||nt(_,C.content,{})}function et(C,P=!1,A=ee.maybev1()){if(Re)return!1;switch(_.maybev1??=V=1,_.actionwhenv1??=bt.ActionWhenV1IsDetected){case"SkipLine":{if(!P)return!0;_.addDiagnostic(ee.skipline(),C.offset,C.length,{severity:D.DiagnosticSeverity.Warning});let L,ie,$="TK_UNKNOWN";if(C.type==="TK_WORD"||C.content==="="&&($="TK_STRING")){m=C,h=C.offset+C.length;do{if(ie=d.indexOf(`
`,h),ie<0&&(ie=w),L=d.substring(h,ie).trimStart()){let o=ie-L.length;m=it(L=L.trimEnd(),$,o,L.length,0)}for((C=_.find_token(h=ie,!0)).content==="("&&(delete _.tokens[C.offset],m={...ot}),Ce=!0,C=Zt();C.ignore&&C.type==="TK_STRING";)ie=d.indexOf(`
`,h),ie<0&&(ie=w),(L=d.substring(h,ie).trimEnd())&&(C.content+=L,C.length+=L.length),h=ie,C=Zt();Ce=!1}while(bn({},C));h=C.offset}return!0}case"SwitchToV1":if(!_.actived)break;console.info([_.document.uri,A,ee.tryswitchtov1()].join(" ")),A="",Fu(_.document.uri);break;case"Continue":return!1;case"Warn":{if(!_.actived)break;Hn?.window.showWarningMessage(`file: '${_.fsPath}', ${A}`,{title:Ka.switchtov1(),action:"SwitchToV1"},{title:Ka.skipline(),action:"SkipLine"},{title:Ka.stopparsing(),action:"Stop"}).then(L=>{(_.actionwhenv1=L?.action??"Continue")!=="Stop"&&(_.actionwhenv1==="SwitchToV1"?Fu(_.document.uri):_.update())});break}}throw _.clear(),h=w,new Va(A,C)}function je(C=0,P=_,A=""){let L=[],ie=_.document,$=_.tokens,o=_.tokens[h-1]??ot,p=o.previous_token??ot,ut=0,U=!0,Je="",te,ce,S,Fe,Ze,tt=f,_t=N,Kt=[],At=[];return pe=!0,C&3&&(Kt.push(h-1),delete o.data),f=P,N=!1,se(),f=tt,N=_t,o.type==="TK_EOF"&&ut>(C&3?-1:0)?_.addDiagnostic(ee.missing("}"),Kt[ut-(C&3?0:1)],1):Ze!==void 0&&_.addFoldingRange(Ze,p.offset,"region"),L;function Ue(){if(d[o.offset+o.length]!=="(")return!1;if(C===2)return!0;let M=p,Q=o,j=m,me=h,K={"(":-1,"[":0,"{":0},Z="",z="";pe=!1;e:for(;Me();)switch(z=o.content){case"(":case"[":case"{":K[z]++;break;case")":case"]":case"}":if(--K[{")":"(","]":"[","}":"{"}[z]]<0){z===")"&&!K["["]&&!K["{"]&&Me()&&(Z=o.content);break e}break}return p=M,o=Q,m=j,h=me,U=!0,Z==="=>"||Z==="{"}function _e(M){let Q=M.op_type??=j(M);return(Q>=0&&(M.topofline===1||!Oi(M.previous_token))||Q<=0&&!me(_.get_token(M.offset+M.length,!0)))&&_.addDiagnostic(ee.missingoperand(),M.offset,M.length),M.op_type;function j(K){switch(K.content.toLowerCase()){case"!":case"~":case"not":return-1;case"%":return K.previous_pair_pos===void 0?-1:1;case"&":case"+":case"-":return K.topofline<1&&Oi(K.previous_token??ot)?0:-1;case"++":case"--":return Oi(K)?1:-1;case":":return 0;case"?":return K.ignore?1:0;case"*":if(",([".includes(K.previous_token?.content??"\0")&&",),]()[]".includes(K.previous_token.content+(_.get_token(K.offset+1,!0).content||"\0")))return-1;default:return 0}}function me(K){switch(K?.type){case"TK_START_BLOCK":case"TK_START_EXPR":case"TK_NUMBER":case"TK_STRING":return!0;case"TK_WORD":return!(K.topofline===1&&$t.test(M.content)&&P.ranges);case"TK_RESERVED":return zm.includes(K.content.toLowerCase());case"TK_OPERATOR":return(K.op_type??=j(K))===-1;case"TK_END_EXPR":case"TK_EOF":if(M.op_type<1&&M.content==="*")return M.op_type=1;default:return!1}}}function se(M=0){for(o.type==="TK_START_BLOCK"&&(delete o.data,Me(),U=!1,!o.topofline&&!p.topofline&&ke(o));pe=!0,Me();){if(o.topofline===1){let Q;if(ce=o.offset,C===2)$t.test(o.content)&&(o.content.toLowerCase()!=="static"||".[(".includes(d[h])||(Q=_.get_token(h,!0)).topofline||!$t.test(Q.content))&&(o.type="TK_WORD");else{let j=At.length&&o.content.toLowerCase()==="default"&&(Q=_.get_token(h,!0)).content===":";if(j||d[h]===":"&&Vn.includes(d.charAt(h+1))&&$t.test(o.content)){if(Q?((o.next_token_offset=Q.next_token_offset)>0&&($[Q.next_token_offset].previous_token=o),delete $[Q.offset],o.skip_pos=h=Q.offset+1):h++,o.content+=":",o.length++,o.type="TK_LABEL",ce=void 0,delete o.semantic,j){let K=At.pop();At.push(o.offset),K&&_.addFoldingRange(K,p.offset,"case"),o.hover_word="default",Me(),U=!1,o.topofline||=-1;continue}o.symbol=S=D.DocumentSymbol.create(o.content,void 0,D.SymbolKind.Field,we(o.offset,o.length),we(o.offset,o.length-1)),S.data=Kt.at(-1),S.def=!0,L.push(S),(te=a[S.selectionRange.start.line])&&Xe(S,te);let me=P.labels[S.name.slice(0,-1).toUpperCase()]??=[];me[0]?.def?(_.addDiagnostic(ee.duplabel(),o.offset,o.length-1),me.splice(1,0,S)):me.unshift(S),Me(),U=!1,o.topofline||ke(o);continue}}}switch(o.type){case"TK_EOF":return;case"TK_WORD":if(o.topofline>0&&d[h]!=="%"){switch(Me(),p.content.toLowerCase()){case"class":if(!o.topofline&&qe())continue;break;case"import":if(un>=ts&&C===0&&" 	".includes(d[p.offset+p.length])){Et();continue}break;case"macro":if(le&&C!==2&&!o.topofline&&p.topofline===1&&$t.test(o.content)&&Ue()){p.type="TK_RESERVED",o.topofline=2,Me();let Q=Be(p,null);Q&&(Q.full=`macro ${Q.full}`);continue}break}if(C===2){if(d[p.offset+p.length]==="("){Be(p);break}if(Pu.includes(o.content,o.topofline)){let K=p,Z=L.length,z=[],re;if(ce=void 0,o.content==="["&&(z=nf("]")??[],Me(),z.length===0&&_.addDiagnostic(ee.propemptyparams(),K.offset,p.offset-K.offset+1),!Pu.includes(o.content,1))){_.addDiagnostic(ee.propdeclaraerr(),K.offset,K.length),U=!1;break}let ae=K.topofline===2,Ee=ae?K.previous_token?.offset:K.offset,Le=K.symbol=D.DocumentSymbol.create(K.content,void 0,D.SymbolKind.Property,re=we(K.offset,K.length),{...re});(te=a[Le.selectionRange.start.line])&&Xe(te.symbol=Le,te),Le.parent=ae?P:P.prototype,Le.has_this_param=!0,Le.static=ae,Le.children=L.splice(Z);let ve="";if(z.length){let be=yi.create("",D.SymbolKind.Function,re,re,z);ve=`[${be.full.slice(1,-1)}]`,Le.local=be.local,Le.declaration=be.declaration,Le.param_offsets=be.param_offsets,Le.params=z,Ri(Le)}if(L.push(Le),Bn(K,Le),Le.full=`(${A.slice(0,-1)}) ${ae?"static ":""}${K.content}${ve}`,K.semantic={type:6,modifier:4|ae},o.content==="{"){let be,Te,B,Pe,Ot=o.offset;for(o.previous_pair_pos=Ee,Me(),U=!1,C=1,o.type==="TK_END_BLOCK"&&!p.topofline&&!o.topofline&&ke(o);Me()&&o.type!=="TK_END_BLOCK";)if(o.topofline&&/^[gs]et$/.test(Pe=o.content.toLowerCase())){let en;if(Me(),be=p,o.content==="=>")B=yi.create(Pe,D.SymbolKind.Function,we(p.offset,h-p.offset),we(p.offset,p.length),[...z]),C=3,B.returns=[h,0],B.parent=Le,B.children=Pt(void 0,"return",1),C=2,B.range.end=ie.positionAt(B.returns[1]=p.offset+p.length),o.fat_arrow_end=!0,_.addFoldingRangePos(B.range.start,B.range.end,"line"),Pe==="set"?(B.params.unshift(en=rn.create("Value",D.SymbolKind.Variable,D.Range.create(0,0,0,0))),en.is_param=en.assigned=en.def=!0,en.detail=zi.value()):Le.returns=B.returns,B.has_this_param=!0,Ri(B),_.linepos[B.range.end.line]=be.offset;else if(o.content==="{")B=yi.create(Pe,D.SymbolKind.Function,we(be.offset,h-be.offset),we(be.offset,3),[...z]),Te=o,B.parent=Le,B.children=je(3,B,A),B.range.end=ie.positionAt(h),Pe==="set"?(B.params.unshift(en=rn.create("Value",D.SymbolKind.Variable,D.Range.create(0,0,0,0))),en.is_param=en.assigned=en.def=!0,en.detail=zi.value()):Le.returns=B.returns,B.has_this_param=!0,Ri(B),_.addSymbolFolding(B,Te.offset);else if(B=void 0,_.addDiagnostic(ee.invalidprop(),o.offset,o.length),o.content==="}"){U=!1;break}else{let of=0;for(;o.type!=="TK_EOF";){if(o.content==="{")of++;else if(o.content==="}"&&--of<0)break;Me()}U=!1}B&&B!==(Le[B.name]??=B)&&_.addDiagnostic(ee.dupdeclaration(),be.offset,be.length)}else{let en=0;for(_.addDiagnostic(ee.invalidprop(),o.offset,o.length),U=!1;Me();)if(o.content==="{")en++;else if(o.content==="}"&&--en<0)break;U=!1}Le.range.end=ie.positionAt(h-1),C=2,_.addSymbolFolding(Le,Ot),Le.get&&!Le.set&&(K.semantic.modifier|=2)}else if(o.content==="=>"){let be=h,Te;C=3,Te=yi.create("get",D.SymbolKind.Function,re=we(be,h-be),yn,z),Te.parent=Le,Le.get=Te,Le.returns=Te.returns=[h,0],Te.children=Pt(void 0,"return",1),C=2,Le.range.end=Te.range.end=ie.positionAt(Te.returns[1]=p.offset+p.length),_.addFoldingRangePos(Te.range.start,Te.range.end,"line"),Te.has_this_param=!0,Ri(Te),o.fat_arrow_end=!0,_.linepos[Le.range.end.line]=Ee,K.semantic.modifier|=2}break}o=p,p=ot,U=!1,h=o.offset+o.length;let Q=L.length,j=P;P=P.$property.__INIT;let me=Mi("");P.children.push(...L.splice(Q)),P=j,L.push(...me),me.forEach(K=>K.parent=j),ce!==void 0&&(_.linepos[(p.pos??=ie.positionAt(p.offset)).line]=ce)}else d[p.offset+p.length]==="("?zt(p,"(")||L.push(...Pt()):(gt(o),o=p,p=ot,h=o.offset+o.length,U=!0,nn(),ce!==void 0&&(_.linepos[(p.pos??=ie.positionAt(p.offset)).line]=ce));break}if(C===2){let Q=L.length,j=P;P=P.$property.__INIT;let me=Mi("");P.children.push(...L.splice(Q)),P=j,L.push(...me),me.forEach(K=>K.parent=j)}else o.topofline?(U=!0,nn()):(U=!1,L.push(...Pt())),ce!==void 0&&(_.linepos[(p.pos??=ie.positionAt(p.offset)).line]=ce);break;case"TK_SHARP":Fo();break;case"TK_RESERVED":ge();break;case"TK_START_BLOCK":C===2?ke(o):(ut++,Kt.push(h-1));break;case"TK_END_BLOCK":if(--ut>=0&&Kt.length){let Q=Kt.pop();_.addFoldingRange(o.previous_pair_pos=Q,h-1),$[Q].next_pair_pos=o.offset,o.topofline===1&&(x=o.offset,i=!0)}if(ut<M)if(!(C&3)&&M===0)ke(o),ut=Kt.length=0;else{!o.topofline&&ke(o),Kt.length&&o.previous_pair_pos===void 0&&($[o.previous_pair_pos=Kt.at(-1)].next_pair_pos=o.offset);return}break;case"TK_END_EXPR":ke(o),ce=void 0;break;case"TK_HOTLINE":{if(o.symbol=S=D.DocumentSymbol.create(o.content,void 0,D.SymbolKind.Event,we(o.offset,o.length),we(o.offset,o.length-2)),S.range.end=ie.positionAt(h-1),L.push(S),(te=a[S.selectionRange.start.line])&&Xe(S,te),C&3&&_.addDiagnostic(ee.hotdeferr(),o.offset,o.length),o.ignore){for(;Me()&&!(!o.ignore||o.type!=="TK_STRING"););S.range.end=ie.positionAt(p.offset+p.length),U=!1;break}Um(o.content)||_.addDiagnostic(ee.invalidhotdef(),o.offset,o.length);break}case"TK_HOT":{C&3?_.addDiagnostic(ee.hotdeferr(),o.offset,o.length):!o.ignore&&!Um(o.content)&&_.addDiagnostic(ee.invalidhotdef(),o.offset,o.length);let Q=o,j=D.DocumentSymbol.create(o.content,void 0,D.SymbolKind.Event,we(o.offset,o.length),we(o.offset,o.length-2));(te=a[j.selectionRange.start.line])&&Xe(j,te),o.symbol=j,Me();let me;for(j.declaration={},L.push(j),j.global={},j.local={},j.labels={};o.type==="TK_SHARP";)Fo(),Me();if(o.content==="{")o.previous_pair_pos=Q.offset,j.params=[me=rn.create("ThisHotkey",D.SymbolKind.Variable,we(0,0))],me.detail=zi.thishotkey(),j.children=je(1,j),j.range=we(Q.offset,h-Q.offset),_.addSymbolFolding(j,o.offset),Ri(j);else if(o.topofline){if(Ri(j),U=!1,o.type.startsWith("TK_HOT"))break;(o.type!=="TK_WORD"||!Ue())&&(et(Q),!V&&_.addDiagnostic(ee.hotmissbrace(),Q.offset,Q.length)),U=!1}else{j.params=[me=rn.create("ThisHotkey",D.SymbolKind.Variable,we(0,0))],me.detail=zi.thishotkey();let K=P,Z=C,z=o.content.toLowerCase(),re=L.length;P=j,C=1,z==="return"?j.children=Pt(void 0,"return"):["global","local","static"].includes(z)?(ge(),j.children=L.splice(re)):(U=!1,Sn(null,Q.offset),j.children=L.splice(re)),P=K,C=Z,Ri(j);let ae=p.offset+p.length;for(;" 	".includes(d[ae]);ae++);j.range=we(Q.offset,ae-Q.offset),_.linepos[j.range.end.line]=Q.offset}break}case"TK_UNKNOWN":_.addDiagnostic(ee.unknowntoken(o.content),o.offset,o.length);break;default:o.topofline===1&&(o.type==="TK_COMMA"?ke(o):p!==ot&&bn(p,o,P)?o.topofline=-1:p=ot),U=!1,C===2?(_.addDiagnostic(ee.propdeclaraerr(),o.offset,o.length),Pt()):(L.push(...Pt()),ce!==void 0&&(_.linepos[(p.pos??=ie.positionAt(p.offset)).line]=ce));break}}}function Be(M,Q=!1,j,me,K){let Z=C===2,z=C,re=P,ae=we(M.offset,M.length),Ee=P={},Le=M.semantic={type:1,modifier:6|Q},ve=L.length,be=Q?M.previous_token.offset:M.offset;if(Z?(C=3,Ee.has_this_param=!0,Ee.kind=D.SymbolKind.Method,Le.type=2,Ee.parent=Q?re:re.prototype,M.content[0]<="9"&&_.diagnostics.push({message:ee.invalidsymbolname(M.content),range:Ee.selectionRange})):(C=1,Ee.kind=D.SymbolKind.Function,z&3&&(Ee.parent=re),M.length?M.content[0]<="9"?_.diagnostics.push({message:ee.invalidsymbolname(M.content),range:Ee.selectionRange}):Mu.includes(M.content.toLowerCase())&&_.diagnostics.push({message:ee.reservedworderr(M.content),range:Ee.selectionRange}):$[M.offset].symbol=Ee),Object.assign(Ee,yi.create(M.content,Ee.kind,{start:M.pos=ae.start,end:{character:0,line:0}},ae,j??=nf()??(_.addDiagnostic(ee.invalidparam(),M.offset,o.offset+1-M.offset),[]),void 0,Q)),M.symbol=M.definition=Ee,M.topofline&&(te=a[Ee.selectionRange.start.line])&&Xe(te.symbol=Ee,te),Me()&&o.content==="=>"){let Te=L.splice(ve);Ee.returns=[h,0];let B=me?En(me,K):Pt(void 0,"return",1);o.fat_arrow_end=!0,L.push(Ee),(Ee.children=Te).push(...B),Ee.range.end=ie.positionAt(Ee.returns[1]=p.offset+p.length),_.addFoldingRangePos(Ee.range.start,Ee.range.end,"line"),o.topofline&&(_.linepos[Ee.range.end.line]=be)}else if(o.content==="{"){let Te=L.splice(ve),B=o;L.push(Ee),(Ee.children=Te).push(...je(C,Ee,A)),Ee.range.end=ie.positionAt(h),_.addSymbolFolding(Ee,B.offset),B.previous_pair_pos=be,o=_.tokens[o.next_pair_pos]??_.find_token(h-1),me&&(un<wn&&_.addDiagnostic(ee.requireVerN(wn),M.offset,B.offset-M.offset,{code:"function definition expressions"}),B.in_expr=o.in_expr=M.offset,i=!1)}else return _.diagnostics.push({message:ee.declarationerr(),range:Ee.selectionRange}),P=re,C=z,U=!1,void 0;return P=re,C=z,Z&&(Ee.full=`(${A.slice(0,-1)}) `+Ee.full,(_.object.method[M.content.toUpperCase()]??=[]).push(Ee)),Ri(Ee),Ee}function ge(){let M=o.content.toLowerCase(),Q=p,j=o.offset,me=h,K;if(pe=!1,d[o.offset-1]==="%"||d[me]==="%"){o.type="TK_WORD",U=!1;return}switch(M){case"global":case"static":case"local":if(Me(),o.topofline&&!bn(p,o,P))C===2?_.addDiagnostic(ee.propdeclaraerr(),p.offset,p.length):M==="local"||P.static===null||L.some(z=>z.kind===D.SymbolKind.Variable)?_.addDiagnostic(ee.declarationerr(),p.offset,p.length):P.assume=M==="static"?1:2;else if($t.test(o.content)){if(d[h]==="("){let Le=!1;!(C&3)||M!=="static"?_.addDiagnostic(ee.declarationerr(),p.offset,p.length):(Le=!0,o.topofline=2),o.type="TK_WORD",Me(),Be(p,Le);break}if(U=!1,!(C&3)){M!=="global"?_.addDiagnostic(ee.declarationerr(),p.offset,p.length):L.push(...Mi(""));break}if(C===2&&Pu.includes((K=_.get_token(h,!0)).content,K.topofline)){o.topofline=2,o.type="TK_WORD";break}let z=L.length,re=P;C===2&&(o.topofline=2,P=P.property.__INIT);let ae=P,Ee=Mi(M==="global"?"":M);if(M==="global")for(let Le of Ee)ae.global[Le.name.toUpperCase()]??=Le;else if(C===2){ae.children.push(...L.splice(z)),P=re;for(let Le of Ee)Le.static=!0,Le.parent=re,Le.full=Le.full.replace(") ",") static ")}else{let Le=M==="static";for(let ve of Ee)ve.static=Le,ae.local[ve.name.toUpperCase()]??=ve}L.push(...Ee)}else h=me,p.type="TK_WORD",o=p,p=Q,_.addDiagnostic(ee.reservedworderr(o.content),o.offset,o.length);U=!1;break;case"loop":{Me(),o.type==="TK_COMMA"&&(et(p),V&&Me());let z=0,re=1,ae="loop",Ee;if(o.type==="TK_EQUALS"){h=p.offset+p.length,p.type="TK_WORD",o=p,p=Q,U=!1,_.addDiagnostic(ee.reservedworderr(o.content),o.offset,o.length);break}else Q=p,(U=" 	,".includes(d[h])&&o.type==="TK_WORD"&&["parse","files","read","reg"].includes(Ee=o.content.toLowerCase()))&&(z=1,re=Ee==="parse"?3:2,o.type="TK_RESERVED",ae+=" "+Ee,p.hover_word=o.hover_word=ae,Me(),o.type==="TK_COMMA"&&Me()&&(o.topofline=0),U=!1);if((!o.topofline||o.type==="TK_COMMA")&&o.type!=="TK_START_BLOCK"?L.push(...Pt("{",ae,z,re)):z&&_.addDiagnostic(ee.acceptparams(ae,`${z}~${re}`),Q.offset,Q.length),Sn(!1,j,!0))return;o.type==="TK_RESERVED"&&o.content.toLowerCase()==="until"&&(U=!0,ce=o.offset,L.push(...Pt(void 0,"until",1)));break}case"for":{let z=Nn("("),re=[],ae=[],Ee=0;for(z&&(K=gn());Me();)switch(o.type){case"TK_COMMA":Ee++;break;case"TK_RESERVED":_.addDiagnostic(ee.reservedworderr(o.content),o.offset,o.length);break;case"TK_WORD":{let Le=Ln(o,0);Le&&(Le.def=Le.assigned=!0,Le.for_index=Ee,Le.returns=re,Le.data=ae);break}case"TK_OPERATOR":if(o.content.toLowerCase()==="in"){re.push(o.offset+2),L.push(...En(void 0,"{")),re.push(p.offset+p.length),K&&(o.content!==")"?_.addDiagnostic(ee.missing(")"),K.offset,K.length):(U=!0,Me())),ae.push(o.offset),!Sn(!1,j,!0)&&o.type==="TK_RESERVED"&&o.content.toLowerCase()==="until"&&(U=!0,ce=o.offset,L.push(...Pt(void 0,"until",1))),ae.push(o.offset,Ee+1);return}_.addDiagnostic(ee.unknownoperatoruse(),o.offset,o.length),U=!1;return;default:U=!1;case"TK_END_EXPR":ke(o);return;case"TK_EQUALS":_.addDiagnostic(ee.reservedworderr(p.content),p.offset,p.length);return}break}case"break":case"continue":case"goto":if(Me(),!N&&M!=="goto"&&_.addDiagnostic(ee.outofloop(),p.offset),o.type==="TK_COMMA"&&(ke(o),et(p)),o.topofline)U=!1,M==="goto"&&_.addDiagnostic(ee.acceptparams(M,1),p.offset,p.length);else{if($t.test(o.content))o.type==="TK_NUMBER"&&M!=="goto"?/[^\d]/.test(o.content)&&ke(o):(o.ignore=!0,o.type="TK_WORD",Z(o),delete o.semantic),Me(),U=!1;else if(d[p.offset+p.length]==="("){let z=[];ii("(",")",void 0,void 0,z),z.forEach(re=>{re.content.indexOf(`
`)<0&&Z({content:re.content.slice(1,-1),offset:re.offset+1,length:re.length-2,type:"",topofline:0,next_token_offset:-1})}),Me(),U=!1}else if(o.type==="TK_STRING")ke(o),Me(),U=!1;else{h=p.offset+p.length,p.type="TK_WORD",o=p,p=Q,U=!1,_.addDiagnostic(ee.reservedworderr(o.content),o.offset,o.length);break}o.topofline||ke(o)}break;case"as":case"catch":case"else":case"finally":case"until":ke(o);break;case"super":dc();break;case"case":if(At.length&&o.topofline){let z=At.pop();At.push(o.offset),z&&_.addFoldingRange(z,p.offset,"case"),Me(),U=!1,o.content!==":"&&!o.topofline?(L.push(...Pt(":","case",1,20)),o.content!==":"?(ke(o),U=!1):(U=!0,Me(),U=!1,o.type==="TK_START_BLOCK"?o.previous_pair_pos=j:o.topofline||=-1)):(U=o.content===":",ke(o))}else o.type="TK_WORD",_.addDiagnostic(ee.reservedworderr(o.content),o.offset,o.length);break;case"try":if(Me(),U=!1,o.type==="TK_COMMA"&&et(p),Sn(!0,j),o.type==="TK_RESERVED"&&o.content.toLowerCase()!=="else"){for(;o.content.toLowerCase()==="catch";)U=!0,ce=o.offset,ht();for(let z of["else","finally"])o.content.toLowerCase()===z&&(U=!0,ce=o.offset,Me(),U=!1,Sn(!0,p.offset))}break;case"isset":fc(d[o.offset+5]);break;case"false":case"true":_.get_token(h,!0).type==="TK_EQUALS"?_.addDiagnostic(ee.reservedworderr(o.content),o.offset,o.length):U=!1,o.type="TK_WORD";break;case"export":if(o.semantic=ja,C===0){let z=!1;if(o.semantic=ja,Me(),o.topofline||o.content!=="("&&!$t.test(o.content)){ke(p);break}if(_.addDiagnostic(Gi.notimplemented(),p.offset,p.length,{code:"module",severity:D.DiagnosticSeverity.Warning}),(M=o.content.toLowerCase())==="default"&&(K=_.get_token(h,!0),!K.topofline&&($t.test(K.content)||K.content==="(")&&(z=!0,o.semantic=ja,o.type="TK_RESERVED",Me(),M=o.content.toLowerCase())),M==="class"&&" 	".includes(d[h])&&!(K=_.get_token(h,!0)).topofline&&$t.test(K.content)){o.topofline=2,Me(),qe(z?"d":"e");break}if(d[h]==="("&&$t.test(M)?(K=o,Me()):K=void 0,o.content==="("){Be(K??{...ot,offset:o.offset});break}U=!1,o.topofline=2,z&&_.addDiagnostic(ee.declarationerr(),p.offset);let re=Mi("");for(let ae of re)ae.export=!0;L.push(...re)}else ke(o);break;case"throw":if(un>=wn){o.type="TK_WORD",U=!1;break}default:if(K=Zt(),K.type==="TK_EQUALS"||/^([<>]=?|~=|&&|\|\||[.|?:^]|\*\*?|\/\/?|<<|>>|!?==?)$/.test(K.content))o.type="TK_WORD",h=me,_.addDiagnostic(ee.reservedworderr(o.content),o.offset,o.length);else if(p=o,o=K,U=!1,M==="return"||M==="throw"){o.type==="TK_COMMA"&&et(p);let z=o.offset;L.push(...Pt(void 0,M)),C&1&&M==="return"&&z<=p.offset&&(P.returns??=[]).push(z,p.offset+p.length)}else if(M==="switch")if(L.push(...Pt("{",M,0,2)),o.content==="{"){o.previous_pair_pos=j,U=!0,Kt.push(h-1),At.push(0),se(++ut);let z=At.pop();z&&_.addFoldingRange(z,p.offset,"case"),Me(),U=!1}else ke(o);else(M==="if"||M==="while")&&(o.type==="TK_COMMA"&&et(p),L.push(...Pt("{",M,1)),Sn(!1,j,M==="while"));break}function Z(z){let re=P.labels;if(!re)return;re[M=z.content.toUpperCase()]??=[];let ae=we(z.offset,z.length);re[M].push(z.symbol=S=D.DocumentSymbol.create(z.content,void 0,D.SymbolKind.Field,ae,ae)),S.data=Kt.at(-1)}}function qe(M){if(!$t.test(o.content))return!1;let Q=o,j=p.offset,me="";if(p.type="TK_RESERVED",o.type!=="TK_WORD"?(o.type="TK_WORD",_.addDiagnostic(ee.reservedworderr(o.content),o.offset)):o.content[0]<="9"&&_.addDiagnostic(ee.invalidsymbolname(o.content),o.length),C&1&&_.addDiagnostic(ee.classinfuncerr(),o.offset,o.length),o=Zt(),!o.topofline&&o.content.toLowerCase()==="extends")if(o=gn(),!o.topofline&&o.type==="TK_WORD"){for(me=o.content,Ln(o,0,_.children);h<w&&d[h]==="."&&(gn(),o=gn(),!o.prefix_is_whitespace&&o.type==="TK_WORD");)me+="."+o.content,Bn(o);o.type==="TK_WORD"&&(o=Zt())}else o.content==="{"&&ke(o);if(o.content!=="{"){if(ke(o),o.topofline)return p=o.previous_token,!(U=!1);if(p=o,o=Zt(),o.content!=="{")return p=(o=p).previous_token,h=o.offset+o.length,!(U=!1)}o.previous_pair_pos=j;let K=D.DocumentSymbol.create(Q.content,void 0,D.SymbolKind.Class,yn,we(Q.offset,Q.length));Q.symbol=Q.definition=K,K.full=A+Q.content,K.extends=me,K.uri=_.uri,(te=a[K.selectionRange.start.line])&&Xe(K,te),K.prototype={...K,cache:[],detail:void 0,property:K.$property={}},K.children=[],K.cache=[],K.property={},K.type_annotations=[K.full];let Z=yi.create("__Init",D.SymbolKind.Method,we(0,0),we(0,0),[],[],!0);return(K.property.__INIT=Z).ranges=[],Z.parent=K,Z.full=`(${K.full}) static __Init()`,Z.has_this_param=!0,Z=yi.create("__Init",D.SymbolKind.Method,we(0,0),we(0,0),[],[]),(K.$property.__INIT=Z).ranges=[],Z.parent=K.prototype,Z.full=`(${K.full}) __Init()`,Z.has_this_param=!0,K.children=je(2,K,A+Q.content+"."),K.range=K.prototype.range=we(j,h-j),Q.semantic={type:0,modifier:6},Ri(K),_.addSymbolFolding(K,o.offset),L.push(K),!0}function ht(){let M,Q,j=o.offset;if(ce=j,p=Q=o,M=Zt(),M.topofline||M.content!=="("?(o=M,M=void 0):o=Zt(),o.topofline||o.type!=="TK_WORD"&&!$t.test(o.content))M?(h=M.offset-1,ke(o)):(U=!1,o.topofline||o.content==="{"?Sn(null,j):ke(o));else{let me=[];if(U=!0,o.content.toLowerCase()!=="as"){for(;;){let K="";if(o.type!=="TK_WORD"?ke(o):(Ln(o),K+=o.content),p=o,o=Zt(),o.type==="TK_DOT")for(Me();;){if(o.type==="TK_WORD")Bn(o),K+="."+o.content,Me();else if(o.content==="%")ke(o),ii("%","%"),Me(),K="@";else break;if(o.type!=="TK_DOT")break;Me()}if(!K.startsWith("@")&&me.push(K),o.content===","){if(p=o,o=Zt(),!$t.test(o.content))break}else break}if(M){if(o.content==="{")return _.addDiagnostic(ee.missing(")"),M.offset,1),Sn(null,j);if(o.content===")")return Me(),U=!1,Sn(null,j)}else if(o.content==="{"||o.topofline)return U=!1,Sn(null,j)}if(o.content.toLowerCase()==="as")if(p=o,o=Zt(),U=!1,o.type!=="TK_WORD"&&!$t.test(o.content))ke(Q);else if(o.type!=="TK_WORD")_.addDiagnostic(ee.reservedworderr(o.content),o.offset,o.length),o.type="TK_WORD";else{let K=Zt();if(h=o.offset+o.length,!K.topofline&&K.content!=="{"&&!(M&&K.content===")"))ke(Q),U=!1;else{let Z=Ln(o);Z&&(U=!0,Z.def=Z.assigned=!0,!me.length&&me.push("Error"),Z.type_annotations=me),M&&(K.content===")"?(h=K.offset+1,U=!0):_.addDiagnostic(ee.missing(")"),M.offset,1)),U&&(Me(),U=!1,Sn(null,j))}}else M&&(o.content===")"?(p=o,o=Zt()):_.addDiagnostic(ee.missing(")"),M.offset,1)),o.topofline?(U=!1,Sn(null,j)):ke(o)}}function Et(){let M=ja,Q={type:3},j=!0,me=!0,K,Z,z;if(p.type="TK_RESERVED",p.semantic=M,_.addDiagnostic(Gi.notimplemented(),p.offset,p.length,{code:"module",severity:D.DiagnosticSeverity.Warning}),o.content==="*")Me();else{if(o.topofline)return U=!1,dt(o);if(o.content==="{"){let re=o,ae={};for(re.data=ae;Me();){if(me&&(K=o).type==="TK_WORD"){if(Me(),o.content==="as"?(o.semantic=M,Me(),o.type==="TK_WORD"?(Z=o,Me()):(Z=void 0,ke(o))):Z=p,Z){let Ee=Z.content.toUpperCase();ae[Ee]?_.addDiagnostic(ee.dupdeclaration(),Z.offset,Z.length):(ae[Ee]=z=rn.create(Z.content,D.SymbolKind.Variable,we(Z.offset,Z.length)),K!==Z&&(z.alias=K.content,z.alias_range=we(K.offset,K.length)),z.decl=z.def=z.assigned=!0,L.push(z))}if(me=o.content===",")continue}if(o.content==="}"){i=!1,re.next_pair_pos=o.offset,o.previous_pair_pos=re.offset,_.addFoldingRange(re.offset,o.offset),Me();break}me=o.content===",",ke(o)}}else(j=!$t.test(o.content))&&ke(o)}if(j){if(o.content.toLowerCase()==="from"){if(o.topofline&&p.content!=="*"&&dt(o),o.type="TK_RESERVED",o.semantic=M,Me(),o.topofline)return U=!1,dt(o);$t.test(o.content)?(o.semantic=Q,o.type="TK_WORD"):U=!1}else if(U=!1,o.topofline)return dt(o)}if(Me(),!j){if((K=p).semantic=Q,p.type="TK_WORD",o.content.toLowerCase()==="as"){if(o.semantic=M,Me(),o.topofline)return U=!1,dt(o);$t.test(o.content)?((Z=o).semantic=Q,o.type="TK_WORD",Me()):(Z=void 0,U=!1)}else Z=p;Z&&(z=rn.create(Z.content,D.SymbolKind.Variable,we(Z.offset,Z.length)),K!==Z&&(z.alias=K.content,z.alias_range=we(K.offset,K.length)),z.decl=z.def=z.assigned=!0,L.push(z))}(U=!o.topofline||bn(p,o))&&(ke(o),Pt())}function gt(M){let Q=M.previous_extra_tokens;Q&&(Q.i=0)}function nn(){let M="",Q;if(Me(),U=!1,(Q=o.ignore&&o.content==="?")&&(o=gn()),o.type!=="TK_EQUALS"&&!/^(=[=>]?|\?\??|:)$/.test(o.content)&&(o.type==="TK_DOT"||`, 	\r
`.includes(M=d.charAt(p.offset+p.length))))if(o.type==="TK_DOT"){let j=Ln(p);for(U=!0,Q&&j&&(j.returns=null);Me();){if(o.type==="TK_WORD"){let me=!0;if(d[h]==="%")me=!1;else if(Bn(o),Me(),vo.includes(o.content))me=!1,ar(p,void 0,()=>{let K=h;return L.push(...En()),[K,p.offset+p.length]});else if(o.ignore&&o.content==="?"&&(o=gn()),o.type==="TK_DOT")continue;U=!1,me&&o.type!=="TK_EQUALS"&&!"=??".includes(o.content||" ")&&`, 	\r
`.includes(M=d.charAt(p.offset+p.length))?zt(p,M,D.SymbolKind.Method):L.push(...Pt())}else U=!1,L.push(...Pt());break}}else Ln(p),zt(p,M);else{let j,me;if(/^=>?$/.test(o.content)&&(j=o.content,me=o.offset),V&&j==="="&&et(o,!0)&&(U=!1,p=ot,o=Zt()))return;gt(o),o=p,p=ot,U=!1,h=o.skip_pos??o.offset+o.length,L.push(...Pt(void 0,j,me))}}function zt(M,Q,j,me,K){let Z={offset:M.offset,miss:[],comma:[],count:0,unknown:!1,name:M.content},z,re,ae;if("([".includes(Q||="\0")){let Le=o,ve=L.length,be=_.diagnostics.length;if(ii(Q,Q==="("?")":"]",o.offset,Z),j===void 0&&(ae=_.get_token(h,!0),re=ae.content,re==="=>"||re==="{"&&K!=="{"&&(M.topofline>0||!ae.topofline||C&8)))return L.splice(ve),_.diagnostics.splice(be),M.ignore&&d[M.offset-1]==="%"&&(delete M.ignore,_.addDiagnostic(ee.missingspace(),M.offset)),p=M,o=Le,h=o.offset+o.length,U=!0,Be(M,M.topofline===2,void 0,me,K);Z.offset=Le.offset,z=we(M.offset,M.length)}else{if(Q===","||V){if(!j&&Nm.includes(M.content.toLowerCase())&&et(M,!0)&&(U=!1,p=ot,o=Zt()))return;Q===","&&_.addDiagnostic(ee.funccallerr(),o.offset,1)}(re=o.type)==="TK_OPERATOR"&&!/^(not|\+\+?|--?|!|~|%|&)$/i.test(o.content)&&ke(o),M.paraminfo=Z,L.push(...Pt(void 0,void 0,void 0,void 0,Z)),z=we(M.offset,M.length),(s===!0||s&&re==="TK_START_EXPR")&&_.diagnostics.push({code:"call statement",range:z,message:Gi.callwithoutparentheses(),severity:D.DiagnosticSeverity.Warning})}if(M.ignore)return delete M.semantic,void 0;let Ee=D.DocumentSymbol.create(M.content,void 0,j??=D.SymbolKind.Function,{...z},z);if(Ee.paraminfo=Z,Ee.offset=M.offset,M.callsite=Ee,p===M){let Le=d.indexOf(`
`,M.offset);Z.end=Le<0?w:Le}else Z.end=p.offset+p.length;switch(Ee.range.end=ie.positionAt(Z.end),j){case D.SymbolKind.Method:ar(M,Z.method=!0),M.semantic={type:2};break;case D.SymbolKind.Function:M.semantic={type:1};case D.SymbolKind.Variable:Ln(M);break}}function Sn(M,Q,j=!1){let me=N,K=C;if(N||=j,U=!0,C|=4,pe=!1,o.type==="TK_START_BLOCK")o.previous_pair_pos=Q,Kt.push(h-1),se(++ut),Me(),U=o.type==="TK_RESERVED"&&o.content.toLowerCase()==="else";else{if(o.type==="TK_RESERVED"&&Lu.includes(o.content.toLowerCase())){let Z=o;ge(),(Z===o||Z===p&&!U&&!o.topofline)&&(Z===o&&Z.type==="TK_WORD"?(U=!0,nn()):L.push(...Pt()))}else if(o.type==="TK_WORD"){if(o.topofline>0&&o.content.toLowerCase()==="class"){if(Me()&&qe())return C=K,M;U=!1}nn()}else o.type!=="TK_EOF"&&(p=ot,U=!1,L.push(...Pt()));ce!==void 0&&(_.linepos[(p.pos??=ie.positionAt(p.offset)).line]=ce),U=o.type==="TK_RESERVED"&&o.content.toLowerCase()==="else"}if(N=me,C=K,typeof M=="boolean"){if(M)U=!1;else if(U)return ce=o.offset,Me(),U=!1,Sn(!0,p.offset),!0}else U=!1;return!1}function Pt(M,Q,j=0,me=1,K){let Z,z=0,re=0,ae,Ee,Le=[],ve=K??{offset:0,count:0,comma:[],miss:[],unknown:!1};if(pe=!1,U){let be=_.get_token(h,!0);Z=be.content?be.offset:h+1,be.type==="TK_COMMA"?ve.miss.push(ve.count++):(!be.topofline||bn(o,be))&&(++ve.count,ae=be)}else Z=o.content?o.offset:p.offset+p.length+1,o.type==="TK_COMMA"?ve.miss.push(ve.count++):(!o.topofline||bn(p,o))&&(++ve.count,ae=o);for(;;){if(Le.push(...En(void 0,M)),Ee??=o.offset,o.type==="TK_COMMA")U=!0,++z,++ve.count,p.type==="TK_COMMA"||p.type==="TK_START_EXPR"?ve.miss.push(ve.comma.length):p.type==="TK_OPERATOR"&&!p.ignore&&!/(--|\+\+|%)/.test(p.content)&&ke(o),ve.comma.push(o.offset),K&&(o.paraminfo=K);else if(o.topofline){U=!1;break}else{if(M===o.content)break;re!==h&&(ke(o),U=!1)}if(re===h&&(!u||o.length))break;re=h}if(Q==="="||Q==="=>"){let be=_.find_token(Z),Te=!0,B=_.tokens;if(be.offset<Ee){for(;be&&be.offset<Ee;){if(!be.ignore&&be.content==="?"){Te=!1;break}be.symbol?be=_.find_token(_.document.offsetAt(be.symbol.range.end),!0):be=B[be.next_pair_pos??be.next_token_offset]}if(Te){if(Q==="="&&et(B[ae.next_token_offset],!0)&&(U=!1,p=ot,be=Zt()))return[];_.addDiagnostic(`${ee.unexpected(Q)}, ${ee.didyoumean(":=")}`,j,Q.length,{code:"expect",data:":="})}}}else Q&&(z>=me||ve.count-(o===ae?1:0)<j)&&_.addDiagnostic(ee.acceptparams(Q,me===j?j:`${j}~${me}`),Z,p.offset+p.length-Z);return p.content==="*"&&(ve.unknown=!0,ve.count--),Le}function Fo(){let M=!1,Q,j=o.data??{content:"",offset:o.offset+o.length,length:0};switch(Q=o.content.toLowerCase()){case"#dllload":M=!0;case"#include":case"#includeagain":Ht(j.content.replaceAll("`;",";"),j,C,M);break;case"#dllimport":if(Fe=j.content.match(/^((\w|[^\x00-\x7f])+)/i)){let me=we(j.offset,Fe[0].length),K=D.Range.create(0,0,0,0),Z={t:"ptr",i:"int",s:"str",a:"astr",w:"wstr",h:"short",c:"char",f:"float",d:"double",I:"int64"},z=Fe[0],re=[],ae,Ee="",Le=0,ve="i";le=!0,Fe=j.content.substring(Fe[0].length).match(/^[ \t]*,[^,]+,([^,]*)/),Fe=Fe?.[1].replace(/[ \t]/g,"").toLowerCase().replaceAll("i6","I")??"";for(let Te of Fe.replace(/^(\w*)[=@]?=/,(B,Pe)=>(ve=Pe||ve,"")))if(Te==="u")Ee="u";else if(Z[Te])re.push(ae=rn.create(`p${++Le}_${Ee+Z[Te]}`,D.SymbolKind.Variable,K)),ae.defaultVal=null,Ee="";else if(ae&&(Te==="*"||Te==="p"))ae.name+="p",ae=void 0;else{_.addDiagnostic(ee.invalidparam(),j.offset,j.length);return}let be=yi.create(z,D.SymbolKind.Function,me,me,re);be.type_annotations=["fd".includes(ve)?"Float":"asw".includes(ve)?"String":"Integer"],L.push(be)}break;case"#requires":Q=j.content.toLowerCase(),le||=Q.startsWith("autohotkey_h"),(Fe=Q.match(/^\w+[ \t]+v(1|2)/))&&(Fe[1]==="2"?Re=!0:(_.maybev1=3,!et(j,!1,ee.requirev1())&&ke(j)));break;case"#hotif":C&3?_.addDiagnostic(ee.invalidscope(o.content),o.offset,o.length):(Ze!==void 0&&_.addFoldingRange(Ze,o.offset),Me(),U=!1,Ze=o.topofline?void 0:p.offset);break;case"#hotstring":Q=j.content?.trim().toLowerCase()??"",Q!=="nomouse"&&Q!=="endchars"&&(_.hotstringExecuteAction=/x(?!0)/.test(Q));break;case"#module":un<ts?_.addDiagnostic(ee.requireVerN(ts),o.offset,o.length,{code:"module"}):_.addDiagnostic(Gi.notimplemented(),o.offset,o.length,{code:"module",severity:D.DiagnosticSeverity.Warning});break;default:/^#(if|hotkey|(noenv|persistent|commentflag|escapechar|menumaskkey|maxmem|maxhotkeysperinterval|keyhistory)\b)/i.test(Q)&&!et(o)&&ke(o);break}}function Mi(M){let Q=[],j=C,me=j===2,K;pe=!1,me&&(C=3);e:for(;Me();){if(o.topofline===1&&!bn(p,o,P)){U=!1;break}switch(o.type){case"TK_OPERATOR":if(!$t.test(o.content)){ke(o),En(",");break}case"TK_RESERVED":me||_.addDiagnostic(ee.reservedworderr(o.content),o.offset,o.length),o.type="TK_WORD";case"TK_WORD":if(Me()&&o.type==="TK_EQUALS"){let Z=o.content,z=h,re=Ln(p,j,Q);me&&(M&&(p.semantic.modifier=1),Z!==":="&&_.addDiagnostic(`${ee.unexpected(Z)}, ${ee.didyoumean(":=")}`,o.offset,o.length,{code:"expect"})),(K=a[re.selectionRange.start.line])&&Xe(re,K),L.push(...En());let ae=[z,p.offset+p.length];P.ranges?.push(ae),Z===":="||Z==="??="&&(re.assigned??=1)?re.returns=ae:re.cached_types=[Z===".="?vi:Pi],re.assigned??=!0,re.decl=re.def=!0,re.range.end=ie.positionAt(p.offset+p.length)}else if(me){let Z=ee.propnotinit(),z=0,re=p,ae=Ln(p,2,Q);if(ae.def=!1,M&&(p.semantic.modifier=1),o.type==="TK_DOT")for(Z=ee.propdeclaraerr();!o.prefix_is_whitespace&&Me()&&o.type==="TK_WORD"&&Me();){if(o.type==="TK_EQUALS"){let Ee=h,Le=p,ve=vo.includes(o.content);ve&&o.content!==":="&&_.addDiagnostic(`${ee.unexpected(o.content)}, ${ee.didyoumean(":=")}`,o.offset,o.length,{code:"expect"}),Bn(p),L.push(...En());let be=[Ee,p.offset+p.length];if(P.ranges?.push(be),!z&&ve&&P.static&&re.content.toLowerCase()==="prototype"){let Te=rn.create(Le.content,D.SymbolKind.Property,we(Le.offset,Le.length)),B=P.parent.prototype;(te=a[Te.selectionRange.start.line])&&Xe(Te,te),Te.parent=B,Te.returns=be,B.cache.push(Te)}continue e}if(o.type==="TK_DOT")Bn(p),z++;else break}else if(!M&&o.content===":"){let Ee=o.offset+1,Le="",ve=!1,be,Te=P,B=f.property.__INIT,Pe=B.children.length;if(delete ae.def,ae.typed=!0,p=o,o=gn(),Z="",$t.test(o.content))be=o,Le+=o.content,Me();else if(o.type==="TK_START_EXPR"){let Ot=L.length;P=B,ve=!0,ii(o.content,o.content==="("?")":"]"),B.children.push(...L.splice(Ot)),P=Te,Me()}else o.content===":="||o.type==="TK_COMMA"||o.topofline&&$t.test(o.content)?(ke(o),U=!1):Z=ee.propdeclaraerr();if(un<wn&&_.addDiagnostic(ee.requireVerN(wn),re.offset,p.offset+p.length-re.offset,{code:"typed properties"}),!Z){for(;;)if(o.content==="."&&o.type!=="TK_OPERATOR")o.type!=="TK_DOT"&&ke(o),Me()&&o.type==="TK_WORD"&&(Le+="."+o.content,Bn(o),Me());else if(o.type==="TK_START_EXPR"&&!o.prefix_is_whitespace&&$t.test(p.content)){let Ot=L.length,en=p.previous_token?.type==="TK_DOT";P=B,ve=!0,zt(p,o.content,o.content==="["?en?D.SymbolKind.Property:D.SymbolKind.Variable:en?D.SymbolKind.Method:D.SymbolKind.Function),B.children.push(...L.splice(Ot)),P=Te,Me()}else break;if(be&&(o.previous_token===be&&/^([iu](8|16|32|64)|f(32|64)|[iu]ptr)$/i.test(be.content)?(ae.type_annotations=[/^f/i.test(be.content)?"Float":"Integer"],be.semantic=Eu):be.type==="TK_WORD"&&Ln(be,3,B.children)),ae.type_annotations??=ve||!Le?["Any"]:[Le],o.content===":="){B.ranges?.push([Ee,o.offset-1]),Ee=o.offset+2,L.push(...En()),P.ranges?.push([Ee,p.offset+p.length]);continue e}if(o.content===","||(o.content==="}"||o.topofline&&$t.test(o.content))&&!(U=!1)){B.ranges?.push([Ee,o.offset-1]);continue e}Z=ee.propdeclaraerr(),B.children?.splice(Pe),ae.def=!1}}if(Z&&_.addDiagnostic(Z,re.offset),o.content==="}"||o.topofline&&$t.test(o.content)){p=ot,U=!1;break e}o.content!==","&&(ke(o),En())}else if(o.content===","||o.topofline&&!bn(p,o,P)){let Z=Ln(p,j,Q);if(Z.decl=Z.def=!0,(K=a[Z.selectionRange.start.line])&&Xe(Z,K),o.content!==","){U=!1;break e}}else ke(o),En(",");break;case"TK_COMMA":p.content===","&&ke(o);continue;case"TK_END_BLOCK":U=!1;break e;default:ke(o),En(",")}}return C=j,Q}function En(M=",",Q){let j=L.length,me=[],K;for(pe=!1;Me();){if(o.topofline===1)if(M===","&&!bn(p,o,P)){p.type==="TK_WORD"&&d[p.offset-1]==="."&&Bn(p),U=!1;break}else p!==ot&&(o.topofline=-1);switch(o.type){case"TK_WORD":{if(d[h]==="(")continue;let Z=d[o.offset-1]===".";if(Me(),o.type==="TK_COMMA"){if(Z)Bn(p),K&&(p.__ref=!0);else if(d[p.offset-1]!=="%"){let z=Ln(p);z&&K!==void 0&&(z.def=z.assigned=!0,K?z.pass_by_ref=!0:z.cached_types=[Pi])}else p.ignore=!0;return U=!1,L.splice(j)}else if(o.type==="TK_OPERATOR"&&(!o.topofline||!/^(!|~|not|\+\+|--)$/i.test(o.content))){let z=!o.topofline&&["++","--"].includes(o.content);if(d[p.offset-1]!=="%"&&d[p.offset+p.length]!=="%")if(Z){if(Bn(p),K){if(o.ignore&&_.get_token(h,!0).type==="TK_DOT")continue;p.__ref=!0}}else{let re=Ln(p);re&&(K!==void 0&&(re.def=re.assigned=!0,K?re.pass_by_ref=!0:re.cached_types=[Pi]),z?(re.def=re.assigned=!0,re.cached_types=[Pi]):o.content==="??"||o.ignore?re.returns=null:K===void 0&&o.content==="=>"&&Be({...ot,offset:p.offset},U=!1,L.splice(-1),M,Q??(me.length?":":void 0)))}else Z?(ar(p,null),o=p,p=o.previous_token??ot,gs(M),Me(),z||=!o.topofline&&["++","--"].includes(o.content)):p.ignore=!0;U=!1;break}else if(o.topofline&&o.type!=="TK_EQUALS"&&o.type!=="TK_DOT"){if(U=!1,Z)d[p.offset-1]!=="%"?(Bn(p),K&&(p.__ref=!0)):p.ignore=!0;else if(d[p.offset-1]!=="%"){let z=Ln(p);z&&K!==void 0&&(z.def=z.assigned=!0,K?z.pass_by_ref=!0:z.cached_types=[Pi])}else p.ignore=!0;return Ui(me),L.splice(j)}if(Z){if(Bn(p),U=o.type==="TK_EQUALS")vo.includes(o.content)&&ar(p,void 0,()=>{let z=h;return L.push(...En(M,Q??(me.length?":":void 0))),[z,p.offset+p.length]});else if(K){if(o.type==="TK_DOT"||o.ignore&&o.content==="?"&&_.get_token(h,!0).type==="TK_DOT")continue;p.__ref=!0}}else{let z;if(d[p.offset-1]!=="%"&&(z=Ln(p))){if(K)if(o.type!=="TK_DOT")z.assigned=z.def=z.pass_by_ref=!0;else if(un<wn+7)_.addDiagnostic(ee.requireVerN(wn+7),p.previous_token.offset,1,{code:"virtual references"});else{o.topofline&&=-1;continue}else K===!1&&o.type!=="TK_DOT"&&(z.def=z.assigned=!0,z.cached_types=[Pi]);if(o.type==="TK_EQUALS"){(te=a[z.selectionRange.start.line])&&Xe(z,te);let re=o.content,ae=h;U=!0,L.push(...En(M,Q??(me.length?":":void 0))),z.range.end=ie.positionAt(p.offset+p.length),re===":="||re==="??="&&(z.assigned??=1)?z.returns=[ae,p.offset+p.length]:z.cached_types=[re===".="?vi:Pi],z.assigned??=!0,z.def=!0}else U=!1}else U=!1,p.ignore=!0}break}case"TK_START_EXPR":if(o.content==="[")ii("[","]");else{let Z,z;p.type==="TK_WORD"&&p.offset+p.length===o.offset?(Z=p).previous_token?.type==="TK_DOT"?z=D.SymbolKind.Method:d[p.offset-1]==="%"&&Z.previous_token?.op_type===1&&(Z.ignore=delete Z.semantic):Z={...ot,offset:o.offset,ignore:!0},zt(Z,"(",z,M,Q??(me.length?":":void 0))}continue;case"TK_START_BLOCK":if(!o.data){let Z=_.diagnostics.length,z=o.offset,re;if(Q==="{"?p.topofline&&p.type==="TK_RESERVED"?p.content.toLowerCase()==="switch"?!o.topofline&&!_.get_token(h,!0).topofline&&(re=!0):_.addDiagnostic(ee.unexpected("{"),z,1):p.op_type===1||Oi(p)||(re=!1):(re=!0,Oi(p)&&_.addDiagnostic(ee.unexpected("{"),z,1)),re!==void 0){if(rf(re))break;_.diagnostics.splice(Z),!re&&(p.type==="TK_EQUALS"||(p.op_type??1)<1)&&_.addDiagnostic(ee.unexpected("{"),z,1)}}return Ui(me),U=!1,L.splice(j);case"TK_NUMBER":case"TK_STRING":break;case"TK_END_BLOCK":case"TK_END_EXPR":case"TK_COMMA":return U=!1,Ui(me),L.splice(j);case"TK_LABEL":ke(o);break;case"TK_UNKNOWN":_.addDiagnostic(ee.unknowntoken(o.content),o.offset,o.length);break;case"TK_RESERVED":{let Z=d[o.offset+o.length];if(Z==="%"||d[o.offset-1]==="%"){o.ignore=!0,o.type="TK_WORD";continue}switch(Je=o.content.toLowerCase()){case"false":case"true":o.type="TK_WORD",K!==void 0||_.get_token(h,!0).type==="TK_EQUALS"?_.addDiagnostic(ee.reservedworderr(o.content),o.offset):U=!1;continue;case"isset":fc(Z);continue;case"super":dc();continue}if(un>=wn&&Je==="throw"){U=!1,o.type="TK_WORD";continue}if(o.topofline&&!")]".includes(M)&&Lu.includes(Je))return o.topofline=1,U=!1,dt(o),Ui(me),L.splice(j);_.addDiagnostic(ee.reservedworderr(o.content),o.offset,o.length);break}case"TK_OPERATOR":if(o.content==="%"){if(M==="%")return U=!1,Ui(me),L.splice(j);d[o.offset-1]==="."?(ar(o,null),gs()):ii("%","%");continue}else if(o.content==="=>")ke(o);else{if($t.test(o.content)&&(d[o.offset-1]==="%"||d[h]==="%")){o.ignore=!0,o.type="TK_WORD";continue}if(o.content===":"){if(me.pop()===void 0){if(Q===":")return U=!1,L.splice(j);ke(o)}}else if(o.content==="?")if(!o.ignore)me.push(o.offset);else continue;if(_e(o)===-1){if(o.content==="&"){K=!0;continue}if(["++","--"].includes(o.content)){K=!1;continue}}}break;case"TK_EQUALS":break;case"TK_DOT":continue}K=void 0}return Ui(me),L.splice(j)}function nf(M=")"){let Q=h-1,j=[],me=[",",M===")"?"(":"["],K=o,Z=!1,z=!0,re=h,ae=o,Ee=!1,Le=!1,ve,be={offset:Q,count:0,comma:[],miss:[],unknown:!1};for(pe=!1,ae.paraminfo=be,p.type==="TK_WORD"&&ae.prefix_is_whitespace===void 0&&(be.name=p.content,Ee=p.topofline>0);Me();)if(o.topofline===1&&(o.topofline=-1),o.content===M){p.type==="TK_COMMA"&&ke(o);break}else if(o.type==="TK_WORD")if(be.count++,me.includes(p.content)||p===ot)if(Me(),o.content===","||o.content===M){let Te=rn.create(p.content,D.SymbolKind.Variable,we(p.offset,p.length));if((te=a[Te.selectionRange.start.line])&&Te.selectionRange.start.line>(ve??=_.document.positionAt(Q).line)&&Xe(Te,te),Z&&(Z=!1,Te.pass_by_ref=Te.def=Te.assigned=!0),j.push(Te),re=h,ae=o,o.content===",")be.comma.push(o.offset),o.paraminfo=be;else break}else if(o.content===":="||o.content==="="){o.content==="="&&(Ee&&et(p),_.addDiagnostic(`${ee.unexpected("=")}, ${ee.didyoumean(":=")}`,o.offset,o.length,{code:"expect",data:":="}));let Te=o,B=rn.create(p.content,D.SymbolKind.Variable,we(p.offset,p.length));if((te=a[B.selectionRange.start.line])&&B.selectionRange.start.line>(ve??=_.document.positionAt(Q).line)&&Xe(B,te),B.def=!0,B.defaultVal=null,j.push(B),L.push(...En(",")),U=!0,re=h,ae=o,p!==Te){B.returns=[Te.offset+Te.length,p.offset+p.length],B.range.end=_.document.positionAt(p.offset+p.length);let Pe=o.previous_token,Ot=[];for(;Pe&&Pe!==Te&&Ot.unshift(Pe)<3;)Pe=Pe.previous_token;Ot.length===1?Ot[0].content.toLowerCase()!=="unset"&&(B.defaultVal=Ot[0].content):Ot.length===2&&"-+".includes(Ot[0].content)?B.defaultVal=`${Ot[0].content}${Ot[1].content}`:(B.range_offset=[Te.offset,o.offset],Le=!0)}if(Z&&(Z=!1,B.pass_by_ref=B.assigned=!0),o.type==="TK_COMMA"){be.comma.push(o.offset),o.paraminfo=be;continue}else{z=o.content===M;break}}else if(o.type==="TK_OPERATOR")if(o.content==="*"){let Te=p;if(Me(),o.content===M){let B=rn.create(Te.content,D.SymbolKind.Variable,we(Te.offset,Te.length));j.push(B),B.arr=!0,be.unknown=!0,re=h,ae=o;break}else{z=!1,be.count--;break}}else if(o.content==="?"&&o.ignore){let Te=rn.create(p.content,D.SymbolKind.Variable,we(p.offset,p.length));if(Te.def=!0,Te.defaultVal=null,j.push(Te),Z&&(Z=!1,Te.pass_by_ref=Te.assigned=!0),Me(),o.type==="TK_COMMA"){be.comma.push(o.offset),re=h,ae=o;continue}else{(z=o.content===M)||(j.pop(),be.count--);break}}else{z=!1,be.count--;break}else{if(p.type==="TK_WORD"&&p.content.toLowerCase()==="byref"&&o.type==="TK_WORD"){Ee&&et(p),_.addDiagnostic(ee.deprecated("&","ByRef"),p.offset,o.topofline?p.length:o.offset-p.offset,{code:"expect",data:"&"}),U=!1,p=ot;continue}z=!1,be.count--;break}else{z=!1,be.count--;break}else if(me.includes(p.content)){let Te=o;if(o.content==="*"){let B;if(Me(),o.content===M){j.push(B=rn.create("",D.SymbolKind.Variable,we(Te.offset,0))),B.arr=!0;break}else ke(Te)}else if(o.content==="&")if(o=Zt(),o.type==="TK_WORD"){Z=!0,U=!1;continue}else ke(Te);z=!1;break}else{z=!1;break}if(be.comma.forEach(Te=>$[Te].paraminfo=be),z)return Le&&(j.format=Bt.bind(void 0,_.tokens)),o.previous_pair_pos=Q,K.next_pair_pos=o.offset,_.addFoldingRange(Q,h,"block"),j;{let Te=L.length;h=re,o=ae,ii(M===")"?"(":"[",M,Q,be),L.splice(Te);return}}function gs(M){for(U=!1,h=o.offset+o.length;Me();)switch(o.type){case"TK_OPERATOR":if(o.content==="%"){if(M==="%")return U=!1;if(ii("%","%"),Fn(d.charCodeAt(h)))break;return}case"TK_NUMBER":if(!$t.test(o.content))return U=!1;case"TK_RESERVED":case"TK_WORD":if(o.type="TK_WORD",o.semantic={type:6},d[h]==="%"&&(o.ignore=!0))break;p.content==="%"&&(o.ignore=!0);return;default:return U=!1}}function rf(M=!1){let Q=p,j=o,me=L.length,K=C,Z=[],z={},re=!0,ae,Ee;for(pe=!1,U=!0,o.data=ki,C|=8;re;)if(!Le()||ve()){if(M&&!re){for(Ee=p,re=!0;!",}".includes(o.content);)En("}"),U=!0;if(U=!0,_.addDiagnostic(ee.objectliteralerr(),Ee.offset,p.offset+p.length-Ee.offset),o.content===",")continue}break}if(re||M)for(let be of Z)(ae=$[be]).type="TK_WORD",ae.semantic=Wm;if(re)(p.content===":"||p.type==="TK_LABEL")&&ke(o);else return p=Q,o=j,L.splice(me),C=K,h=o.skip_pos??o.offset+o.length,U=!1;if(j.data=ki,o.type==="TK_END_BLOCK"){if(i=!1,_.addFoldingRange(o.previous_pair_pos=j.offset,o.offset),j.next_pair_pos=o.offset,Object.keys(z).length){let be=D.DocumentSymbol.create("",void 0,D.SymbolKind.Class,yn,yn);j.data=be,be.property=z,be.name=be.full=be.extends=""}o.data=j.data}else _.addDiagnostic(ee.missing("}"),j.offset,1);return C=K,!0;function Le(){for(;Me();)switch(ae=void 0,o.topofline===1&&(o.topofline=-1),o.type){case"TK_OPERATOR":if(o.content==="%"){if(ii("%","%"),Fn(d.charCodeAt(h)))break;return Me(),o.content===":"?!0:re=!1}case"TK_NUMBER":if(!$t.test(o.content))return re=!1;case"TK_RESERVED":case"TK_WORD":{if(Z.push(o.offset),d[h]==="%")break;let be=p;return Me(),o.content===":"?(be.content!=="%"&&(ae=p),!0):re=!1}case"TK_STRING":return Me(),o.content===":"?(ae={...p},ae.content=ae.content.slice(1,-1),ae.offset++,ae.length-=2,!le&&(!p.content.startsWith('"')||!et(p))&&_.addDiagnostic(`${ee.invalidpropname()}, ${ee.didyoumean(ae.content)}`,p.offset,p.length,{code:"expect",data:ae.content}),!0):re=!1;case"TK_LABEL":return/^(\w|[^\x00-\x7f])+:$/.test(o.content)?(ae={...o},ae.content=ae.content.slice(0,-1),ae.length--,!0):re=!1;case"TK_END_BLOCK":if(p.type==="TK_START_BLOCK"||p.type==="TK_COMMA")return!1;case"TK_START_EXPR":return re=!1;case"TK_COMMA":if(p.type==="TK_COMMA"||p.type==="TK_START_BLOCK")return!0;default:return re=!1}return!1}function ve(){let be=o.offset;return L.push(...En(",")),ae&&(Bn(ae),(z[ae.content.toUpperCase()]=rn.create(ae.content,D.SymbolKind.Property,we(ae.offset,ae.length))).returns=[be+1,p.offset+p.length]),o.type==="TK_COMMA"?!(U=!0):o.type==="TK_END_BLOCK"?U=!0:o.type==="TK_EOF"?!0:!(re=!1)}}function ii(M,Q,j,me,K){let Z=0,z=!1,re,ae,Ee=[j??=o.offset],Le=[L.length],ve=_.tokens[j],be=C,Te=[];if(me??={offset:j,count:0,comma:[],miss:[],unknown:!1},M!=="%"){C|=8;let Pe=ve.previous_token;ve.paraminfo=me,(me.name||!ve.topofline&&Pe&&ve.prefix_is_whitespace===void 0&&((Pe.previous_pair_pos??Pe.in_expr)!==void 0||Pe.type==="TK_WORD"||Pe.type==="TK_DOT"))&&(z=!0)}else ve.op_type=-1;for(;Me();){if(o.topofline){if(M==="%"&&!(["TK_COMMA","TK_OPERATOR","TK_EQUALS"].includes(o.type)&&!/^(!|~|not)$/i.test(o.content))){et(ve),ve.next_pair_pos=-1,_.addDiagnostic(ee.missing("%"),j,1),U=!1,C=be,Ui(Te);return}o.topofline===1&&(o.topofline=-1)}if(o.content===Q){if($[o.previous_pair_pos=Ee.pop()].next_pair_pos=o.offset,Q!=="%"?_.addFoldingRange(o.previous_pair_pos,o.offset+1,"block"):o.op_type=1,--Z<0)break;re=Le.pop()}else if(o.content===M){if(M==="("){if(d[o.offset-1]===")"){ii("(",")");continue}Le.push(L.length)}Z++,Ee.push(h-1)}else if(o.content==="(")zt({...ot,offset:o.offset,ignore:!0},"(",void 0,Q,Te.length?":":void 0);else switch(o.type){case"TK_WORD":if(d[o.offset-1]!==".")if(d[h]!=="(")if(M==="%"||d[o.offset-1]!=="%"&&d[o.offset+o.length]!=="%"){let Pe=Ln(o);if(Pe){if(Me(),U=!1,o.type==="TK_EQUALS"){(te=a[Pe.selectionRange.start.line])?.offset>Ee.at(-1)&&Xe(Pe,te);let Ot=o.content,en=h;U=!0,L.push(...En(Q,Te.length?":":void 0)),Pe.range.end=ie.positionAt(p.offset+p.length),Ot===":="||Ot==="??="&&(Pe.assigned??=1)?Pe.returns=[en,p.offset+p.length]:Pe.cached_types=[Ot===".="?vi:Pi],Pe.assigned??=!0,Pe.def=!0}else ae||(o.type==="TK_DOT"?ae||=void 0:!o.topofline&&["++","--"].includes(o.content)&&(ae=!1));if(ae)if(o.type!=="TK_DOT")Pe.assigned=Pe.def=Pe.pass_by_ref=!0;else if(un<wn+7)_.addDiagnostic(ee.requireVerN(wn+7),p.previous_token.offset,1,{code:"virtual references"});else{o.topofline&&=-1;continue}else ae===!1?(Pe.def=Pe.assigned=!0,Pe.cached_types=[Pi]):o.content==="??"||o.ignore&&o.content==="?"?Pe.returns=null:o.content==="=>"&&Be({...ot,offset:p.offset},!1,L.splice(-1),Q,Te.length?":":void 0)}}else o.ignore=!0;else d[o.offset-1]==="%"&&p.op_type===1&&(o.ignore=!0),p=o,o=gn(),zt(p,"(",void 0,Q,Te.length?":":void 0);else if(d[h]==="(")p=o,o=gn(),zt(p,"(",D.SymbolKind.Method);else if(M!=="%"&&d[h]==="%")ar(o,null),gs(),Me(),U=!1;else if(Bn(o),Me(),U=!1,o.type==="TK_EQUALS")vo.includes(o.content)&&ar(p,void 0,()=>{let Pe=h;return L.push(...En(Q,Te.length?":":void 0)),[Pe,p.offset+p.length]});else if(ae){if(o.type==="TK_DOT"||o.ignore&&o.content==="?"&&_.get_token(h,!0).type==="TK_DOT")continue;p.__ref=!0}break;case"TK_START_BLOCK":if(["TK_WORD","TK_STRING","TK_NUMBER"].includes(p.type))ke(o);else if(p.content===")"&&p.previous_pair_pos!==void 0){o=$[p.previous_pair_pos],h=o.offset+1,p=o.previous_token??ot,L.splice(re),Be({...ot,offset:o.offset},!1,void 0,Q,Te.length?":":void 0);continue}rf(!0);break;case"TK_STRING":K?.push(o),M==="["&&Nn("]")&&!/\n|`n/.test(o.content)&&B_(o.content.substring(1,o.content.length-1));break;case"TK_END_BLOCK":case"TK_END_EXPR":ke(o),B(),U=!1,C=be,Ui(Te);return;case"TK_RESERVED":{let Pe=d[h];if(M!=="%"&&(Pe==="%"||d[o.offset-1]==="%")){o.ignore=!0,o.type="TK_WORD";continue}switch(Je=o.content.toLowerCase()){case"false":case"true":o.type="TK_WORD",ae!==void 0||_.get_token(h,!0).type==="TK_EQUALS"?_.addDiagnostic(ee.reservedworderr(o.content),o.offset):U=!1;continue;case"isset":fc(Pe);continue;case"super":dc();continue}if(un>=wn&&Je==="throw"){U=!1,o.type="TK_WORD";continue}_.addDiagnostic(ee.reservedworderr(o.content),o.offset,o.length);break}case"TK_COMMA":Z===0&&M!=="%"&&(++me.count,p.type==="TK_COMMA"||p.type==="TK_START_EXPR"?me.miss.push(me.comma.length):!p.ignore&&p.type==="TK_OPERATOR"&&!/(--|\+\+|%)/.test(p.content)&&ke(o),me.comma.push(o.offset),z&&(o.paraminfo=me));break;case"TK_OPERATOR":switch(o.content){case"%":p.type==="TK_DOT"?(ar(o,null),gs(Q)):ii("%","%");continue;case":":Te.pop()??ke(o);break;case"?":if(o.ignore)continue;Te.push(o.offset);break;case"=>":ae!==void 0||p.content!==")"||p.previous_pair_pos===void 0?(ae=void 0,ke(o)):(o=$[p.previous_pair_pos],h=o.offset+1,p=o.previous_token??ot,L.splice(re),Be({...ot,offset:o.offset},!1,void 0,Q,Te.length?":":void 0));continue;default:if($t.test(o.content)&&(d[o.offset-1]==="%"||d[h]==="%")){o.ignore=!0,o.type="TK_WORD";continue}}if(_e(o)===-1){if(o.content==="&"){ae=!0;continue}if(["++","--"].includes(o.content)){ae=!1;continue}}break;case"TK_UNKNOWN":_.addDiagnostic(ee.unknown(o.content),o.offset,o.length);break;default:if(o.content==="[")ii("[","]");else if(o.content===".")_e(o);else break;continue}ae=void 0}o.type==="TK_EOF"&&Z>-1?(Q==="%"&&et(ve),B()):$[o.previous_pair_pos].next_pair_pos=o.offset,M!=="%"&&(p.content===","?me.miss.push(me.count++):p.type!=="TK_START_EXPR"&&(me.count++,p.content==="*"&&(me.unknown=!0,me.count--)),me.end=o.offset),C=be,Ui(Te);function B(){let Pe;for(;(Pe=Ee.pop())!==void 0;)_.addDiagnostic(ee.missing(Q),Pe,1)}}function fc(M){let Q=L.length;if(o.definition=Wt.ISSET,o.ignore=!0,o.type="TK_WORD",o.semantic=$m,M==="("){let j=o;Ln(o),Me(),ii("(",")");let me=$[o.previous_pair_pos]?.paraminfo?.count??0;if(me!==1)bt.Diagnostics.ParamsCheck&&_.addDiagnostic(ee.paramcounterr(1,me),j.offset,h-j.offset);else if(L.length>Q&&p.type==="TK_WORD"){let K=L.at(-1);p.content===K.name&&p.offset===_.document.offsetAt(K.range.start)&&(K.assigned??=1,K.returns??=null)}return!0}_.addDiagnostic(ee.missing("("),o.offset,5)}function dc(){if((C&3)===3){if(d[h]!=="("){let M=_.get_token(h,!0);if(M.type!=="TK_DOT"&&M.content!=="["&&!(M.topofline&&o.topofline))return _.addDiagnostic(ee.syntaxerror(o.content),o.offset,o.length)}o.type="TK_WORD",U=!1}else _.addDiagnostic(ee.invalidsuper(),o.offset,o.length)}function Ui(M){let Q;for(;(Q=M.pop())!==void 0;){let j=_.tokens[Q],me=_.tokens[j.next_token_offset]??ot;me.previous_pair_pos!==void 0&&(j.ignore=!0)||(d[me.offset]==="."?un<wn-1?_.addDiagnostic(ee.requireVerN(wn-1),Q,1,{code:"optional chaining"}):j.ignore=!0:_.addDiagnostic(ee.missing(":"),Q,1))}}function ar(M,Q=!1,j){if(A==="")return;let me,K,Z=!1,z=M.previous_token?.previous_token;if(!z||d[z.offset-1]==="."&&(z.content.toLowerCase()!=="prototype"||(Z=!0,!(z=z.previous_token?.previous_token)||d[z.offset-1]==="."))||(Je=z.content.toLowerCase(),Je!=="this"&&Je!=="super"||!(K=re())||Z&&!(K=K.prototype)||!K.cache))return;if(Q){let ae=M.callsite?.paraminfo;if(ae&&M.content.toLowerCase()==="defineprop"&&ae.count>1&&ae.miss[0]!==0){let Ee=ae.comma[0],Le=!!K.prototype,ve=$[M.next_token_offset];if(d[M.offset+M.length]==="("&&(ve=$[ve.next_token_offset]),ve.type!=="TK_STRING"||ve.next_token_offset!==Ee)K.checkmember=!1;else{let be=$[$[Ee].next_token_offset],Te=ve.content.slice(1,-1),B,Pe,Ot;me=we(ve.offset+1,Te.length),(be.type!=="TK_START_BLOCK"||!(Pe=be.data?.property)||Pe.GET||Pe.VALUE||Pe.SET)&&(B=rn.create(Te,D.SymbolKind.Property,me),B.full=`(${A.slice(0,-1)}) ${(B.static=Le)?"static ":""}${Te}`,B.parent=K,Ot=B,(B.returns=Pe?.GET?.returns)?B.eval=!0:B.returns=Pe?.VALUE?.returns),(Pe=Pe?.CALL)&&(B=rn.create("",D.SymbolKind.Variable,we(0,0)),B.arr=!0,B=yi.create(Te,D.SymbolKind.Method,me,me,[B],void 0,Le),B.full=`(${A.slice(0,-1)}) ${B.full}`,B.returns=Pe.returns,B.eval=!0,B.parent=K,Ot?(Ot={...Ot,[Ot.eval?"get":Ot.returns?"val":"set"]:Ot},Ot.val?Ot=B:Ot.call=B):Ot=B),Ot&&K.cache.push(Ot)}}}else{if(Q===null)return K.checkmember=!1,void 0;let ae=rn.create(M.content,D.SymbolKind.Property,me=we(M.offset,M.length));ae.static=!!K.prototype,K.cache.push(ae),ae.def=!1,ae.parent=K,ae.returns=j?.(),(te=a[ae.selectionRange.start.line])&&Xe(ae,te)}return;function re(){let ae=P;for(;ae&&ae.kind!==D.SymbolKind.Class;)ae=ae.parent;return ae}}function Ln(M,Q=0,j){let me=we(M.offset,M.length),K=rn.create(M.content,D.SymbolKind.Variable,me);return Q===2&&(K.kind=D.SymbolKind.Property,Bn(M,K),A&&(K.full=`(${A.slice(0,-1)}) ${K.name}`,M.symbol=K)),(j??L).push(K),K}function Bn(M,Q){let j=_.object.property[M.content.toUpperCase()]??=[];M.semantic??={type:6},Q?j.unshift(Q):j[0]??=rn.create(M.content,D.SymbolKind.Property,we(M.offset,M.length))}function B_(M){_.texts[M.toUpperCase()]=M}function Ri(M){let Q=_.diagnostics,j,me=!1,K={};if(M.decl=M.def=!0,M.kind===D.SymbolKind.Class){let Z=M,z=Z.$property,re=Z.property??={},ae=Z.children??=[],Ee=[re.__INIT],Le=Z.prototype;Le.checkmember??=Z.checkmember,Ri(re.__INIT),z.__INIT?.ranges?.length?(Ri(z.__INIT),Ee.push(z.__INIT)):delete z.__INIT,re.PROTOTYPE={...Le,children:void 0,name:"Prototype",kind:D.SymbolKind.Property,full:`(${Z.full}) Prototype`,selectionRange:yn,type_annotations:[Z.full]},ae.forEach(ve=>{if(Je=ve.name.toUpperCase(),Ou.includes(Je)&&delete($[ie.offsetAt(ve.selectionRange.start)]??{}).semantic,ve.children){let be=ve.static||ve.kind===D.SymbolKind.Class?re:z,Te=be[Je];if(!Te)be[Je]=ve;else if(Te.kind===D.SymbolKind.Property&&!(Te.get??Te.set))(ve.children.length||ve.kind!==D.SymbolKind.Property)&&(be[Je]=ve);else{if(Te.kind!==ve.kind&&![ve.kind,Te.kind].includes(D.SymbolKind.Class)){let B,Pe=Te.kind===D.SymbolKind.Property?(B=ve,Te):(B=Te,ve);if(!Pe.call)return Pe.call=B,be[Je]=Pe}Q.push({message:ee.dupdeclaration(),range:ve.selectionRange})}}}),ae.forEach(ve=>{if(ve.children)return;let be=ve.static?re:z;if(!(j=be[Je=ve.name.toUpperCase()]))return ve.def===!1||(be[Je]=ve);if(!(j.typed===!0&&(ve.typed||!ve.children&&(j.typed=1)))){if(j.children&&(!ve.typed||ve.range.start.line<j.range.start.line)){let Te=j;if(!Te.val)return Te.val=ve}ve.def!==!1&&Q.push({message:ee.dupdeclaration(),range:ve.selectionRange})}}),ae.push(...Ee,...Z.cache??[],...Z.prototype.cache??[]),Z.cache?.forEach(ve=>re[ve.name.toUpperCase()]??=ve),Z.prototype.cache?.forEach(ve=>z[ve.name.toUpperCase()]??=ve),delete Z.cache,delete Z.prototype.cache}else{let Z=M,z=Z.has_this_param,re=Z.declaration,ae=Z.local??{},Ee=Z.global??{},Le={},ve={},be,Te=[];z&&(K.THIS=re.THIS=Ro,K.SUPER=re.SUPER=ns,Z.kind===D.SymbolKind.Function&&(Te=void 0));for(let B of Z.params??[])B.decl=B.def=B.assigned=B.is_param=!0,B.name&&(Te?.push(B),B.defaultVal!==void 0||B.arr?me=!0:me&&Q.push({message:ee.defaultvalmissing(B.name),range:B.selectionRange}),(j=K[Je=B.name.toUpperCase()])?Q.push({message:ee.conflictserr("parameter","parameter",j.name),range:B.selectionRange}):K[Je]=re[Je]=Le[Je]=B);for(let[B,Pe]of Object.entries(ae))(j=K[B])?Q.push({message:ee.conflictserr(Pe.static?"static":"local","parameter",j.name),range:Pe.selectionRange}):(re[B]=Pe,Pe.assigned||=!!Pe.returns);for(let[B,Pe]of Object.entries(Ee)){if(j=re[B]){if(K[B]){Q.push({message:ee.conflictserr("global","parameter",j.name),range:Pe.selectionRange});continue}let Ot=Pe.static?"static":"local";if(Q.push({message:ee.conflictserr(...j.selectionRange.start.line<Pe.selectionRange.start.line?(j=Pe,["global",Ot]):[Ot,"global"],j.name),range:j.selectionRange}),Pe!==j)continue;delete ae[B]}re[B]??=Pe,_.declaration[B]??=Pe,Pe.assigned||=!!Pe.returns,Pe.is_global=!0}for(let B of Z.children??=[])if(Je=B.name.toUpperCase(),B.kind===D.SymbolKind.Function){let Pe=B;if(Pe.static||(Pe.closure=!0),!Je)continue;if(re[Je]){if(j=K[Je]){Q.push({message:ee.conflictserr("function","parameter",j.name),range:B.selectionRange});continue}else if(j=Ee[Je]){if(Q.push({message:ee.conflictserr(...j.selectionRange.start.line<B.selectionRange.start.line||j.selectionRange.start.line===B.selectionRange.start.line&&j.selectionRange.start.character<B.selectionRange.start.character?(j=B,["function","global"]):["global","function"],j.name),range:j.selectionRange}),B===j)continue;delete Ee[Je],delete j.is_global,_.declaration[Je]===j&&delete _.declaration[Je]}else if(j=ae[Je])if(j.selectionRange.start.line<B.selectionRange.start.line||j.selectionRange.start.line===B.selectionRange.start.line&&j.selectionRange.start.character<B.selectionRange.start.character){Q.push({message:ee.conflictserr("function",j.kind===D.SymbolKind.Function?"Func":j.static?"static":"local",B.name),range:B.selectionRange});continue}else j.static&&Q.push({message:ee.conflictserr(j.kind===D.SymbolKind.Function?"function":"static",B.kind===D.SymbolKind.Function?"Func":"static",j.name),range:j.selectionRange})}re[Je]=ae[Je]=B}else B.kind===D.SymbolKind.Variable&&(((be=B).def?Le:ve)[Je]??=(be.assigned||=!!be.returns,B));if(Z.children.unshift(...Te??[]),Z.parent?.assume===2&&(Z.assume??=2),Z.assume===2){for(let[B,Pe]of Object.entries(Object.assign(ve,Le)))(j=re[B])?j.kind===D.SymbolKind.Function&&Pe.def?Pe.assigned!==1&&Q.push({message:ee.assignerr("Func",j.name),range:Pe.selectionRange}):j.kind===D.SymbolKind.Variable&&Pe.def&&Pe.kind===j.kind&&(j.def=!0,j.assigned||=!!Pe.returns):(_.declaration[B]??=Ee[B]=Pe,Pe.is_global=!0);ve={}}else if(Z.static!==null){let B=Z.assume===1,Pe=Z.kind!==D.SymbolKind.Function||!Z.parent;for(let[Ot,en]of Object.entries(Le))delete ve[Ot],(j=re[Ot])?j.kind===D.SymbolKind.Function?en.assigned!==1&&Q.push({message:ee.assignerr("Func",j.name),range:en.selectionRange}):j.kind===D.SymbolKind.Variable&&en.def&&en.kind===j.kind&&(j.def=!0,j.assigned||=!!en.returns):(re[Ot]=en,Pe?(ae[Ot]=en,en.static=B):B&&(en.static=null))}else{for(let[B,Pe]of Object.entries(Object.assign(ve,Le)))(j=re[B])?Pe.def&&Pe.assigned!==1&&j.kind===D.SymbolKind.Function&&Q.push({message:ee.assignerr("Func",j.name),range:Pe.selectionRange}):(re[B]=Pe).has_warned=!0;ve={}}Le=ve,ve={};for(let B in Le)re[B]||((ve[B]=Le[B]).def=!1);Z.unresolved_vars=ve;for(let B of Object.values(ae))B.def=!0;K=Object.assign(ae,K),z&&(delete K.THIS,delete K.SUPER,delete re.THIS,delete re.SUPER);for(let B of Object.keys(re))B.substring(0,2)==="A_"&&Wt[B]&&((be=re[B]).decl?Q.push({message:ee.conflictserr(be.params?"function":be.is_param?"parameter":"variable","built-in variable",be.name),range:be.selectionRange}):(delete re[B],delete ae[B]))}}function Me(){return U?(p=o,U=(o=Zt()).type!=="TK_EOF"):U=o.type!=="TK_EOF"}}function We(C,P){C.extends=(P=P.trim()).replace(/^(.+[\\/])?/,A=>{if(A=A.slice(0,-1)){let L;if(A=A.replaceAll("\\","/").toLowerCase(),A.endsWith(".ahk")||(A+=".d.ahk"),A.startsWith("~/"))L=hn.file(Qi+A.slice(1));else if(/^([a-z]:)?\//.test(A))L=hn.file(A);else if(A.includes(":"))L=hn.parse(A);else{let ie=(de.path+"/../"+A).split("/"),$=[];ie.shift();for(let o of ie)if(o!=="..")$.push(o);else if(!$.pop())return"";L=de.with({path:$.join("/")})}C.extendsuri=L.toString().toLowerCase()}return""}),!C.extendsuri&&C.extends.startsWith("#")&&(C.extendsuri=Wt[(C.extends=C.extends.substring(1)).toUpperCase()]?.uri??an.ahk2)}function Dt(C){return C.replace(/%a_(\w+)%/gi,(P,A)=>(A=A.toLowerCase(),A==="linefile"?_.fsPath:"scriptdir,initialworkingdir".includes(A)?(_.need_scriptdir=!0,_.scriptdir):"scriptname,icontip".includes(A)?(0,wo.basename)(_.fsPath):P))}function Ht(C,P,A=0,L=!1){let ie,$=!1,o=C[0];if(`'"`.includes(o)&&C.endsWith(o)&&(C=C.slice(1,-1)),ie=C.match(/^(\*[iI][ \t])?(.*)$/))if($=!!ie[1],ie=Dt(ie[2]),P&&_[L?"dlldir":"includedir"].set((P.pos??=_.document.positionAt(P.offset)).line,L?c:g),!ie.trim())L?c="":P&&_.addDiagnostic(ee.pathinvalid(),P.offset,P.length,{code:"include"});else if(L)(0,ci.existsSync)(ie)&&(0,ci.statSync)(ie).isDirectory()?c=ie.endsWith("/")||ie.endsWith("\\")?ie:ie+"\\":(/\.\w+$/.test(ie)||(ie=ie+".dll"),ie=Au(ie,[],c||_.scriptpath,!0)?.path??ie,ie.includes(":")?_.dllpaths.push(ie.replaceAll("\\","/")):_.dllpaths.push((c&&(0,ci.existsSync)(c+ie)?c+ie:ie).replace(/\\/g,"/")));else{let p=ie.startsWith("<");if(P){if(ie.startsWith("*")){let ut=Ni.get_RCDATA(P.content.substring(1));ut?(k[ut.uri]=ut.path,P.data=[void 0,ut.uri]):_.addDiagnostic(ee.resourcenotfound(),P.offset,P.length,{code:"include",severity:D.DiagnosticSeverity.Warning});return}else!(ie=Au(ie,_.libdirs,g))||!(0,ci.existsSync)(ie.path)?$||_.addDiagnostic(ie?ee.filenotexist(ie.path):ee.pathinvalid(),P.offset,P.length,{code:"include",data:ie?.path}):(0,ci.statSync)(ie.path).isDirectory()?_.includedir.set(P.pos.line,g=ie.path):(k[ie.uri]=ie.path,P.data=[ie.path,ie.uri]);A&3&&_.addDiagnostic(ee.unsupportinclude(),P.offset,P.length,{code:"include",severity:D.DiagnosticSeverity.Warning})}else(ie=Jt(ie))&&(k[ie.uri]=ie.path);_.need_scriptdir||=p&&(!ie||ie.path.toLowerCase().startsWith(_.libdirs[0].toLowerCase()))}else C&&P&&_.addDiagnostic(ee.pathinvalid(),P.offset,P.length,{code:"include"})}function Jt(C){C.startsWith("<")?C=C.replace(/(\.d)?>$/i,".d>"):C=C.replace(/(\.d\.ahk)?$/i,".d.ahk");let P=Au(C,_.libdirs,_.scriptpath,!0,{...Wn,locale:ss});if(P&&!(0,ci.statSync)(P.path).isDirectory())return P}function Ct(C,P){return P?(C&&C+`

`)+P:C}function Xe(C,P){let A=P.content;if(A.startsWith(";")){C.detail=P.data??=A.replace(/^[ \t]*; ?/gm,"");return}if(!/^\/\*\*(?!\/)/.test(A)){C.detail=P.data??=A.replace(new RegExp(`^${d.substring(d.lastIndexOf(`
`,P.offset)+1,P.offset)}`,"gm"),"").replace(/^\/\*\s*\n|\s*\*+\/$/g,"");return}if(!P.data)P.data=nt(_,A,C);else{let{detail:L,ignore:ie,tags:$,vars:o}=P.data,p=o&&(o[C.name.toUpperCase()]??o[""]);ie&&(C.ignore=ie),$&&(C.tags=$),C.markdown_detail=Ct(p?.detail??"",L),p&&(C.type_annotations=p.type_annotations??=Fr(p.type_str))}}function nt(C,P,A){if(A.detail=P,P=P.replace(/^[ \t]*(\*?[ \t]*(?=@)|\* ?)/gm,"").replace(/^\/\*+\s*|\s*\**\/$/g,""),!P)return{detail:A.markdown_detail=A.detail=""};let L=[],ie=[],$,o="",p,ut=A,U={},Je={},te=se=>{},ce,S,Fe,Ze={[D.SymbolKind.Variable]:"var",[D.SymbolKind.Property]:"prop"}[A.kind];if(ut.params){let se=ut.params;te=Be=>{if(!/^d/.test(Be))return Je[Be]??=se.find(ge=>Be===ge.name.toUpperCase()&&!(ge.markdown_detail=""))??((ut.overload_params??={})[Be]={type_annotations:!1,markdown_detail:""})}}for(let se of P.split(/\n(?=@)/)){if(!(ce=se.match(/^@(\w*)/))){L.push(se);continue}switch(p=ce[1].toLowerCase(),se=se.substring(p.length+1),Fe&&!p.startsWith("prop")&&(Fe=void 0),p){case"arg":case"argument":p="param";case"param":case"prop":case"property":case"var":if(se=_e(se),ce=se.match(/^\s*(\[(\w|[^\x00-\x7f]|(\[\])?\.)*.*?\]|(\w|[^\x00-\x7f]|(\[\])?\.)*)/)){let Be="",ge=ce[1]??="",qe=!1,ht=()=>qe?`<u>\`${ge}\`</u>`:`\`${ge}\``;if(se=se.substring(ce[0].length),ge.startsWith("[")&&(ge.slice(1,-1).replace(/^((\w|[^\x00-\x7f]|(\[\])?\.)*)(.*)$/,(...Et)=>((ge=Et[4].trimStart()).startsWith("=")&&(Be=ge.substring(1).trim()),ge=Et[1])),qe=!0),p==="param"){if(S=te(ge.replace(/(\[\])?\..*$/,"").toUpperCase()),S?.name?.length===ge.length)qe=S.defaultVal!==void 0,S.type_annotations??=Fr(o);else if(S?.name){let Et=ge.split(".");Ue(At(S,Et.shift()),Et,o,`*@param* ${ht()}${o&&`: *\`${o}\`*`}${se.trim()&&`
___
${se}`}`),S.markdown_detail||(S=void 0)}p=`*@param* ${ht()}${o&&`: *\`${o}\`*`}${Be&&` := \`${Be}\``}${tt(se)}`,L.push(p),S&&(S.markdown_detail+=`${p}

`);continue}else if(p.startsWith("prop"))p="property",Fe??=U[""]??=_t(),Ue(At(Fe,Fe.name),ge.split("."),o,`*@${p}* ${ht()}${o&&`: *\`${o}\`*`}${Be&&` := \`${Be}\``}${se.trim()&&`
___
${se}`}`);else if(Ze==="var"){se=se.trimStart(),A.name.toLowerCase()===ge.toLowerCase()?(A.type_annotations??=Fr(o),($??={})[ge.toUpperCase()]??={detail:se,type_annotations:A.type_annotations},A.markdown_detail??=se):($??={})[ge.toUpperCase()]??={detail:se,type_str:o};continue}se=tt(se),L.push(p=`*@${p}* \`${ge}\`${o&&`: *\`${o}\`*`}${Be&&` := \`${Be}\``}${se}`)}continue;case"return":case"returns":case"type":se=_e(se),L.push(`*@${p}*${o&&` *\`${o}\`*`}${tt(se)}`),!Ze||A.get?(Ze||p!=="type")&&(A.type_annotations??=Fr(o)):p==="type"&&(($??={})[""]??={detail:se,type_annotations:Fr(o)},L.pop());continue;case"enum":case"throws":se=_e(se),L.push(`*@${p}*${o&&` *\`${o}\`*`}${tt(se)}`);continue;case"typedef":se=_e(se),ce=se.match(/^\s*(\$?(\w|[^\x00-\x7f])*)/),(p=ce[1])&&(C.typedef[p.toUpperCase()]??=Fe={name:p,kind:D.SymbolKind.TypeParameter,range:yn,selectionRange:yn,type_annotations:Fr(o)}),L.push(`*@typedef* \`${p}\`: *\`${o||"Any"}\`*${tt(se.substring(ce[0].length))}`);continue;case"overload":if(!(ce=se.match(/^\s*(\w|[^\x00-\x7f])*(?=[([])/)))break;ie.push(`${A.name||"_"}${se.substring(ce[0].length).trimEnd()}`);continue;case"example":L.push("*@example*"),(se=se.replace(/^\s*<caption>(.*?)<\/caption>/,(Be,ge)=>(L.push(ge),"")).replace(/^[ \t\r\n]+/,""))&&L.push("```ahk2\n"+se+"\n```");continue;case"extends":p="*@extends* ",(ce=se.match(/^\s*{([^{}]+)}/))&&(A.kind===D.SymbolKind.Class&&We(A,ce[1]),p+=`\`${ce[1]}\``,se=se.substring(ce[0].length)),L.push(`${p}${tt(se)}`);continue;case"ignore":A.ignore=!0;break;case"deprecated":A.tags??=[1];break;case"since":_.d&2&&!Zm(se=se.trim())&&(A.since=se||"unknown");break;case"alias":if(A.kind===D.SymbolKind.Class&&(o=se.trim()).endsWith(">")&&o.startsWith(A.name+"<")){let Be=new e(Gn.create("","ahk2",0,`class ${o}{
}`),void 0,1);Be.parseScript();let ge=Be.declaration[A.name.toUpperCase()]?.type_params;ge&&(A.type_params=ge,Object.values(ge).forEach(qe=>qe.range=qe.selectionRange=yn))}break}L.push(`*@${p}*${tt(se)}`)}if(Ze){let se=$?.[""]?.type_annotations;!se&&(p=U[""])&&((($??={})[""]??={detail:""}).type_annotations=se=[p]),A.type_annotations??=se}else ut.params&&(p=ie.join(`
`))&&(A.overloads=p);return P=L.join(`

`),A.markdown_detail=Ct(A.markdown_detail??"",P),{detail:P,ignore:A.ignore,tags:A.tags,vars:$};function tt(se){se=se.replace(/^[ \t]*[-—]/,"");let Be=0,ge=0,qe=0;for(let ht of se)switch(qe++,ht){case`
`:if(Be>1||++ge===2)return se;case"	":Be=0;break;case" ":Be++;break;case"\r":break;default:if(ge){let Et=!1;if(ht==="|"||ht===">"||"-+*".includes(ht)&&" 	".includes(se[qe])||se.substring(qe-1,qe+2)==="```")Et=!0;else if(ht==="#"){for(;se[qe]==="#";qe++);Et=" 	".includes(se[qe])}else if(ht!=="."){for(;ht>="0"&&ht<="9";ht=se[qe++]);Et=ht==="."&&" 	".includes(se[qe])}if(Et)return`
${se}`}return` \u2014 ${se}`}return""}function _t(se=""){return{kind:D.SymbolKind.Class,name:se,full:"",extends:"",uri:"",property:{},range:yn,selectionRange:yn}}function Kt(se,Be,ge){for(let qe=se.length-1;qe>=0;qe--)Be.includes(se[qe])&&se.splice(qe,1);return ge&&se.push(ge),ge}function At(se,Be){let ge=Be.endsWith("]")&&(Be=Be.slice(0,-2),!0),qe=U[Be=Be.toUpperCase()]??=Kt(se.type_annotations||=[],[ki],_t(se.name));return ge?U[`${Be}[]`]??=(qe.extends||="Array",Kt(se.type_annotations||[],[Wa]),Kt((qe.generic_types??=[])[0]??=[],[ki],_t())):qe}function Ue(se,Be,ge,qe){let ht=se.name.toUpperCase(),Et=Be.length;for(let gt of Be){let nn=0,zt;for(;gt.endsWith("]");)gt=gt.slice(0,-2),nn++;if(ht+=`.${zt=gt.toUpperCase()}`,Et--,se=U[ht]??=se.property[zt]??={kind:D.SymbolKind.Property,name:gt,range:yn,selectionRange:yn},nn||Et)do se=U[ht+"."]??=Kt(se.type_annotations||=[],[ki],_t()),nn&&(se=U[ht+="[]"]??=(se.extends||="Array",Kt((se.generic_types??=[])[0]??=[],nn>1?[ki,Wa]:[ki],_t())),nn--);while(nn)}se.property||(se.markdown_detail??=qe,se.type_annotations??=Fr(ge))}function _e(se){let Be=se.match(/^\s*\{/);if(o="",!Be)return se;let ge=1,qe=Be[0].length,ht=qe;for(;ge;)switch(se[qe++]){case"{":ge++;continue;case"}":ge--;continue;case void 0:return se;case'"':case"'":{let Et=se[qe-1],gt;for(;(gt=se[qe++])!==Et;)if(gt==="`")qe++;else if(!gt||gt===`
`)return se;break}}return o=se.substring(ht,qe-1).trim(),se.substring(qe)}}function we(C,P){return D.Range.create(_.document.positionAt(C),_.document.positionAt(C+P))}function it(C,P,A,L,ie){let $=d.charAt(A-1),o={content:C,type:P,offset:A,length:L,topofline:ie,previous_token:m,next_token_offset:-1,prefix_is_whitespace:Vn.includes($)?$:void 0};return _.tokens[A]=o,m.next_token_offset=A,o}function An(C,P){let A=0,L=0,ie,$="",o="",p,ut,U=[rt.ArrayLiteral,rt.Expression,rt.ObjectLiteral].includes(P);return C&&(A=C.indentation_level,L=C.had_comment,$=C.last_text,o=C.last_word,U||=C.in_expression,p=C.array_style,ut=C.object_style),{array_style:p,case_body:!1,catch_block:!1,declaration_statement:!1,else_block:!1,finally_block:!1,had_comment:L,if_block:!1,in_case_statement:!1,in_case:!1,in_expression:U,indentation_level:A,last_text:$,last_word:o,loop_block:0,mode:P,object_style:ut,parent:C,start_line_index:xe.length,ternary_depth:ie,try_block:!1}}function O(){return{text:[],indent:0}}function ue(){if(u!==!1)return;let C=xe.pop();for(;C?.text.length===0;)C=xe.pop();C&&xe.push(C),R.had_comment&&xe.push(O())}function Ae(){return xe.at(-1).text.length===0}function Ge(C=!1){if(De.wrap_line_length&&!C){let P=xe.at(-1),A=0;P.text.length>0&&(A=P.text.join("").length+ft.length+(ne?1:0),A>=De.wrap_line_length&&(C=!0))}(De.preserve_newlines&&I||C)&&!Ae()&&Se(!0)}function Se(C=!1){if(!C&&(C===null||!bn(Ne.previous_token??ot,ot))){for(;R.mode===rt.Statement;)kt();R.if_block=R.try_block=R.catch_block=!1,R.loop_block=0}Ae()||xe.push(O())}function Qe(C){let P=xe.at(-1);P.text.length?ne&&P.text.push(" "):(qt&&P.text.push(qt),R.indentation_level=A(R.indentation_level)),ne=void 0,P.text.push(C??ft);function A(L){if(L){for(let ie=xe.length-2;ie>=0;ie--)if(xe[ie].text.length){L=Math.min(xe[ie].indent+1,L);break}P.text.push(fn.repeat(P.indent=L))}return L}}function yt(){R.indentation_level+=1}function Ft(){R.indentation_level>0&&(!R.parent||R.indentation_level>R.parent.indentation_level)&&(R.indentation_level-=1)}function lt(C){R?(Ut.push(R),pt=R):pt=An(void 0,C),R=An(pt,C)}function kt(){Ut.length>0&&(pt=R,R=Ut.pop())}function It(){return R.parent.mode===rt.ObjectLiteral&&R.mode===rt.Statement&&R.last_text===":"&&!R.ternary_depth}function Qt(){if(ct==="TK_RESERVED"&&["try","else","finally"].includes(R.last_text)||ct==="TK_END_EXPR"&&pt.mode===rt.Conditional||ct==="TK_WORD"&&R.mode===rt.BlockStatement&&(!I&&Ne.previous_token?.callsite||!R.in_case&&!["TK_WORD","TK_RESERVED","TK_START_EXPR"].includes(Lt)&&!["--","++","%"].includes(ft))||R.declaration_statement&&(!y||bn(Ne.previous_token??ot,Ne))||R.mode===rt.ObjectLiteral&&R.last_text===":"&&!R.ternary_depth){switch(lt(rt.Statement),yt(),R.last_word){case"if":case"for":case"loop":case"while":case"catch":Se(!0);case"try":case"finally":case"else":R.declaration_statement=!0;break}return!0}return!1}function Rn(C){return["break","continue","global","goto","local","return","static","throw"].includes(C)}function Nn(C){let P=h,A=d[P];for(;A!==C&&Vn.includes(A)&&++P<w;)A=d[P];return A===C?P:0}function Zt(C=0){let P;do P=gn(C);while(P.type.endsWith("COMMENT"));return P}function gn(C=0){let P,A,L,ie,$=0,o=h;for(y=0;Vn.includes(A=d[h++]);)A===`
`&&(x=h-1,y+=1,i=!0);if(!A)return Je(),U(),_.tokens[-1]??={content:"",type:"TK_EOF",offset:w,length:0,topofline:bn(m,ot)?-1:1,next_token_offset:-1,previous_token:m};let p=h-1,ut=_.tokens[p];if(ut&&ut.length){let te=!1;if((i=!!(ut.topofline&&ut.type.endsWith("_BLOCK")))&&(x=p),h=ut.skip_pos??p+ut.length,m=ut,ut.ignore?ut.type==="TK_START_EXPR"?(u=!0,te=!Ve):ut.type==="TK_END_EXPR"?(u=null,te=!Ve):ut.type.endsWith("COMMENT")&&(m=ut.previous_token??ot):ut.type.endsWith("COMMENT")&&(m=ut.previous_token??ot),!Ve){let ce=ut.previous_extra_tokens,S=ut;if(ce&&(o<p&&(ce.i=0),ce.i<ce.len?(ut=ce.tokens[ce.i++],h=p):ce.i=0),te&&S===ut)return gn()}return ut}if(i){i=!1,$=1;let te=d.indexOf(`
`,h);te<0&&(te=w);let ce=d.substring(x+1,te).trim().replace(/(^|[ \t]+);.*$/,"");if(ce.includes("::")&&(pe||!`"'`.includes(ce[0])||!["TK_EQUALS","TK_COMMA","TK_START_EXPR"].includes(m.type))){if(L=ce.match(/^(:([^:]*):(`.|[^`])*?::)(.*)$/i)){let S;if((S=/x(?!0)/i.test(L[2]))||/^[ \t]*\{?$/.test(L[4])||(S=_.hotstringExecuteAction&&!/x0/i.test(L[2]))?(h+=L[1].length-1,m=it(L[1],"TK_HOT",p,L[1].length,1)):(x=te,h=p+L[0].length,m=it(L[1],"TK_HOTLINE",p,L[1].length,1),p+=L[1].length,m.skip_pos=h,m.data={content:d.substring(p,h),offset:p,length:h-p},_.tokenranges.push({start:p,end:h,type:3,previous:m.offset})),m.ignore=!0,U(),L[3]||_.addDiagnostic(ee.invalidhotdef(),m.offset,m.length),m.type==="TK_HOTLINE"||!S&&!/^[ \t]*\{/.test(L[4])){if(C>5)return delete _.tokens[m.offset],m;Ce=S=!0;let Fe=m,Ze=Zt(C+1),tt;for(;Ze.ignore&&Ze.type==="TK_STRING";){if((h=d.indexOf(`
`,tt=h))<0&&(h=w),tt<h){let _t=d.substring(tt,h).trimEnd();Ze.content+=_t,Ze.length+=_t.length}_.tokenranges.push({start:Ze.offset,end:Ze.offset+Ze.length,type:3}),S=!1,Ze=Zt(C+1)}Ce=!1,m=Fe,!S&&m.type==="TK_HOT"?(m.type="TK_HOTLINE",m.skip_pos=h=p+L[0].length,p+=L[1].length,m.data={content:d.substring(p,h),offset:p,length:h-p},_.tokenranges.push({start:p,end:h,type:3,previous:m.offset})):h=Fe.skip_pos??Fe.offset+Fe.length}return m}else if(L=ce.match(/^(((([<>$~*!+#^]*?)(`?;|[\x21-\x3A\x3C-\x7E]|[^\x00-\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\x7f]+))|~?(`?;|[\x21-\x3A\x3C-\x7E]|[^\x00-\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\x7f]+)[ \t]*&[ \t]*~?(`?;|[\x21-\x3A\x3C-\x7E]|[^\x00-\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\x7f]+))([ \t]+up)?[ \t]*::)(.*)$/i)){let S=L[9].match(/^([ \t]*)(([<>~*!+#^]*?)(`[{;]|[a-z]\w+|[^{]))$/i);if(U(),S){let Fe=S[4].toLowerCase();if(Fe.length===1||!/^joy|^pause$/.test(Fe)&&Hm.test(Fe))return x=te,h=p+L[0].length,m=it(L[1].replace(/[ \t]+/g," "),"TK_HOTLINE",p,L[1].length,1),p+=m.length+S[1].length,m.skip_pos=h,m.data={content:L[9].trim(),offset:p,length:h-p,data:S[2]},_.tokenranges.push({start:p,end:h,type:3,previous:m.offset}),m}return h=d.indexOf("::",h)+2,m=it(L[1].replace(/[ \t]+/g," "),"TK_HOT",p,L[1].length,1)}}A!=="#"&&U()}if(Fn(A.charCodeAt(0))||A==="$"&&ye){let te="TK_WORD";for(;h<w&&Fn(d.charCodeAt(h));)A+=d[h],h+=1;if(d[p-1]!=="."){if(L=A.match(/^(\d+[Ee](\d+)?|(0[Xx][\da-fA-F]+)|(\d+))$/)){if(L[2]||L[3])return m=it(A,"TK_NUMBER",p,A.length,$),m.data=!!L[2],m.semantic=ko,m;if(L[4]){let ce;if(h<w&&d[h]==="."){let S="",Fe="",Ze=h+1;for(;Ze<w&&Fn(d.charCodeAt(Ze));)S+=d[Ze],Ze+=1;if(/^\d*([Ee]\d+)?$/.test(S))return A+="."+S,h=Ze,m=it(A,"TK_NUMBER",p,A.length,$),m.data=!0,m.semantic=ko,m;if(/^\d*[Ee]$/.test(S)&&Ze<w&&"-+".includes(d[Ze])){for(S+=d[Ze],Ze+=1;Ze<w&&Fn(d.charCodeAt(Ze));)Fe+=d[Ze],Ze+=1;/^\d+$/.test(Fe)&&(A+="."+S+Fe,h=Ze)}ce=!0}return m=it(A,"TK_NUMBER",p,A.length,$),m.data=ce,m.semantic=ko,m}else if(h<w&&"-+".includes(d[h])){let ce=d[h],S=h,Fe;if(h+=1,Fe=gn(C+1),delete _.tokens[Fe.offset],Fe.type==="TK_NUMBER"&&/^\d+$/.test(Fe.content))return A+=ce+Fe.content,m=it(A,"TK_NUMBER",p,A.length,$),m.data=!0,m.semantic=ko,m;h=S}}-1<(ie=Mu.indexOf(A.toLowerCase(),Qa))&&(te=ie<yk?"TK_RESERVED":"TK_OPERATOR")}return m=it(A,te,p,A.length,$)}if(A==="("||A==="["){if(A==="("&&$&&!u){let te=h,ce=te,S;for(;te<w;)if((S=d[te++])===`
`)if(Ce){let Fe=d.indexOf(`
`,te),Ze=null,tt=x+1,_t=[];for(;Fe>0&&!(Ze=d.substring(te,Fe).match(/^[ \t]*\)/));)_t.push(Fe-te),Fe=d.indexOf(`
`,te=Fe+1);return Fe<0&&(_t.push(w-te),Ze=d.substring(te,w).match(/^[ \t]*\)/)),h=Ze?te+Ze[0].length:w,_t.push(h-te),P=d.substring(p,h).trimEnd(),m=it(d.substring(tt,p)+P,"TK_STRING",p,P.length,1),_.addFoldingRange(tt,h,"block"),m.data=_t,m.ignore=!0,m}else{let Fe=!m.type||m.type==="TK_START_BLOCK"&&m.topofline>0;for(m=it(A,"TK_START_EXPR",p,1,1),m.ignore=!0,h=te-1,u=!0;" 	".includes(d[++p]););let Ze=d.substring(p,h).trimEnd();m.data={content:Ze,offset:p,length:h-p},m.skip_pos=h,_.tokenranges.push({start:p,end:h,type:3,previous:m.offset});let tt=Ze.match(/(^|[ \t])join([^ \t]*)/i),_t=/(^|[ \t])[Cc]/.test(Ze),Kt=m,At=Ve,Ue=m,_e=!1,se=h,Be=0,ge,qe=()=>{};if(tt){let ht=tt[2].replace(/`[srn]/g,"  "),Et=new e(Gn.create("","ahk2",-10,ht)),gt=!1;Et.parseScript(),delete Et.tokens[-1];let nn=Object.values(Et.tokens);p+=4+tt[1].length+tt.index,nn.length&&(gt=Vn.includes(ht.slice(-1)),nn.forEach(zt=>{zt.offset+=p,zt.length=0,zt.next_token_offset=-1}),qe=(zt,Sn)=>{let Pt=[];for(let Fo=0;Fo<zt;Fo++){Sn=d.indexOf(`
`,Sn+1);for(let Mi of nn)Mi={...Mi},Mi.offset=Sn,Pt.push(Mi)}return{i:0,len:Pt.length,tokens:Pt,suffix_is_whitespace:gt}},",)]}".includes(nn[0].content)&&(_e=!0))}for(Ve=!0,ge=gn(),u&&ge.type!=="TK_EOF"&&(_t&&ge.topofline&&ge.type.endsWith("COMMENT")?Be=y-2:(y>1&&(ge.previous_extra_tokens=qe(y-1,se)),ge.topofline=Fe?1:0),se=x,Ue=ge,ge=gn());u&&ge.type!=="TK_EOF";)ge.topofline&&(_t&&ge.type.endsWith("COMMENT")?Be+=y-1:((Be+=y)&&(ge.previous_extra_tokens=qe(Be,se)),ge.topofline=Be=0,_e&&Ue.content==="?"&&(Ue.ignore=!0)),se=x),Ue=ge,ge=gn();return ge.ignore&&ge.type==="TK_END_EXPR"&&(y>1&&(ge.previous_extra_tokens=qe(y-1,se)),Kt.next_pair_pos=ge.offset,ge.previous_pair_pos=Kt.offset,_.addFoldingRange(Kt.offset,ge.offset,"block")),h=Kt.skip_pos,m=(Ve=At)?Kt:gn()}else if(S===")"||S==="("){if(te-ce<5||d.substring(ce,ce+4).toLowerCase()!=="join")break}else(S===" "||S==="	")&&(ce=te)}return m=it(A,"TK_START_EXPR",p,1,$)}if(A===")"||A==="]")return m=it(A,"TK_END_EXPR",p,1,$),A===")"&&$&&u?(u=!1,m.ignore=!0,Ve?m:gn()):m;if(A==="{"&&(P="TK_START_BLOCK")||A==="}"&&(P="TK_END_BLOCK"))return $&&(x=p,i=!0),m=it(A,P,p,1,$);if(A===",")return m=it(A,"TK_COMMA",p,1,$);if(A==='"'||A==="'"){let te=A,ce=p,S=!1,Fe,Ze;for(P="",` 	\r
+-*/%:?~!&|^=<>[({,.]`.includes(A=d.charAt(p-1))||(te===A?A==="'"||!et(m)?_.addDiagnostic(ee.didyoumean(A=`\`${A}`),p-1,d[p+1]===te?2:1,{code:"expect",data:A}):(p=m.offset,m=m.previous_token,_.tokenranges.pop()):_.addDiagnostic(ee.missingspace(),p,1));A=d[h++];)if(A==="`")h++;else{if(A===te)return P+=d.substring(p,h),m=it(P,"TK_STRING",p,h-p,$),_.tokenranges.push({start:p,end:h,type:2}),S&&(m.data=null,m.semantic=$a),Fe&&(m=Fe,h=m.offset+m.length),Fn(d.charCodeAt(h))&&_.addDiagnostic(ee.missingspace(),h),m;if(u){if(A===`
`){let tt=h-1;for(;" 	".includes(A=d[h]);)h++;if(A===")"){P=d.substring(p,tt).trimEnd(),m=it(P,"TK_STRING",p,P.length,$=0),Fe??=m,P="",_.tokenranges.push({start:p,end:p+m.length,type:3});let _t=m.previous_token;for(;_t&&(!_t.ignore||_t.content!=="(");)_t=_t.previous_token;for(_.addFoldingRange(p,tt,"string"),m=it(")","TK_END_EXPR",h,1,1),m.ignore=!0,_t&&(_t.next_pair_pos=h,m.previous_pair_pos=_t.offset),u=!1,S=!0,p=++h;" 	".includes(A=d[h]);)h++;P=d.substring(p,h),p=h}}}else if(A===`
`||A===";"&&" 	".includes(d[h-2])){P=(P+d.substring(p,h-(A===";"?2:1))).trimEnd(),--h,P&&(m=it(P,"TK_STRING",p,P.trimStart().length,$),_.tokenranges.push({start:p,end:p+m.length,type:3}),S&&(m.data=null,m.semantic=$a),Fe??=m,P="");break}}if(A){if(C>5)return m=Fe,h=m.offset+m.length,delete _.tokens[m.offset],m;Ce=pe=!0;let tt=Zt(C+1);e:for(;tt.ignore&&tt.type==="TK_STRING";){let _t=h,Kt=tt.data;for(S&&(tt.semantic=$a);A=d[h++];)if(A==="`")h++;else if(A===te){let At=d.substring(_t,h);tt.content+=At,tt.length+=At.length,Kt[Kt.length-1]+=At.length,_.tokenranges.push({start:tt.offset,end:tt.offset+tt.length,type:3}),Fn(d.charCodeAt(h))&&_.addDiagnostic(ee.missingspace(),h);break e}else if(A===`
`||A===";"&&" 	".includes(d[h-2])){let At=d.substring(_t,h-(A===";"?2:1)).trimEnd();At&&(tt.content+=At,tt.length+=At.length,Kt[Kt.length-1]+=At.length),_.tokenranges.push({start:tt.offset,end:tt.offset+tt.length,type:3}),h--;break}if(!A){let At=d.substring(_t,--h);At&&(tt.content+=At,tt.length+=At.length),_.tokenranges.push({start:tt.offset,end:tt.offset+tt.length,type:3})}tt=Zt(C+1)}return(!tt.ignore||tt.type!=="TK_STRING")&&((Ze=tt.previous_token)?_.addDiagnostic(ee.unterminated(),Ze.offset+Ze.length,1):_.addDiagnostic(ee.missing(te),ce,1)),Ce=!1,m=Fe,h=m.offset+m.length,m}else return _.addDiagnostic(ee.unterminated(),w,1),P+=d.substring(p,w),m=it(P,"TK_STRING",p,w-p,$),_.tokenranges.push({start:p,end:w,type:3}),S&&(m.data=null,m.semantic=$a),u&&(_.addFoldingRange(p,w,"string"),u=!1),m}if(A==="."){let te=d[h];if(te==="=")return h++,m=it(".=","TK_EQUALS",p,2,$);if(Vn.includes(te)&&Vn.includes(d[h-2]))return m=it(A,"TK_OPERATOR",p,1,$);if(/\d/.test(te)&&["TK_EQUALS","TK_OPERATOR","TK_COMMA","TK_START_EXPR"].includes(m.type)){let ce=h+1,S="";for(;ce<w&&Fn(d.charCodeAt(ce));)te+=d[ce],ce+=1;if(/^\d+([Ee]\d+)?$/.test(te))return h=ce,A+=te,m=it("0"+A,"TK_NUMBER",p,A.length,$),m.data=!0,m.semantic=ko,m;if(ce<w&&/^\d+[Ee]$/.test(te)&&"-+".includes(d[ce])){for(te+=d[ce],ce+=1;ce<w&&Fn(d.charCodeAt(ce));)S+=d[ce],ce+=1;if(/^\d+$/.test(S))return h=ce,A+=te+S,m=it("0"+A,"TK_NUMBER",p,A.length,$),m.data=!0,m.semantic=ko,m}}return m=it(A,/[%([]|[^\x00-\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\x7f]/.test(te)?"TK_DOT":"TK_UNKNOWN",p,1,$)}if(A===";"){let te=$&&`
`.includes(d.charAt(x))?"TK_COMMENT":($=0,"TK_INLINE_COMMENT"),ce="",S,Fe,Ze,tt=p-1,_t,Kt=0,At=!0;for(;;){if(h=tt,tt=d.indexOf(`
`,h+1),_t=d.substring(h+1,tt=tt<0?w:tt).trim(),_t.startsWith(";")){if(Kt++,S=_t.match(/^;\s*@/)){if(Kt>1)break;let _e=_t.substring(S[0].length).replace(/\s+;.*$/,"").toLowerCase();if(S=_e.match(/^([-.\w]+)(?=(\s|$))/))switch(S[1]){case"include":(_e=_e.substring(S[1].length).trimStart())&&Ht(_e);break;case"include-winapi":le&&(S=oe[an.winapi])&&Object.defineProperty(k,an.winapi,{value:S.fsPath,enumerable:!1});break;case"reference":_.d_uri||=_e.substring(S[1].length).trimStart();break;case"lint-disable":case"lint-enable":_e=_e.substring(S[1].length).trimStart(),_e==="class-non-dynamic-member-check"&&(S[1]==="lint-enable"?delete(f??_).checkmember:(f??_).checkmember=!1);break}Ze=!0}else if(S=_t.match(/^;+\s*([{}])/)){if(At=!1,S[1]==="{"?l.bracket.push(h+1):(S=l.bracket.pop())!==void 0&&_.addFoldingRange(S,h+1,"block"),Kt===1&&(Ze=!0),$&&!Ze)continue;h=tt;break}if((S=_t.match(/^;\s*(~?\s*|@)(todo|fixme)(:?\s*)(.*)/i))&&(_.children.push(D.DocumentSymbol.create(`${S[2].toUpperCase()}: ${S[4].trim()}`,void 0,D.SymbolKind.Null,Fe=we(h+1,tt-h-1),Fe)),$))continue;if($){if(S=_t.match(/^;\s*[@#](end)?region\b/i))Ze=!0,At=!1,Je(),S[1]?(S=l.region.pop())!==void 0&&_.addFoldingRange(S,h+1,"region"):(l.region.push(h+1),(_t=_t.substring(S[0].length).trim())&&_.children.push(D.DocumentSymbol.create(_t,void 0,D.SymbolKind.Null,Fe=we(h+1,tt-h-1),Fe)));else if(es&&(S=_t.match(es))){let _e=S.groups;for(let se in _e)if(se.startsWith("tag")&&(S=_e[se]?.trim()))break;typeof S!="string"&&(S=S[1]?.trim()),S&&(_.children.push(D.DocumentSymbol.create(S,void 0,D.SymbolKind.Null,Fe=we(h+1,tt-h-1),Fe)),Ze=!0)}if(!Ze)continue}h=tt}break}ce=d.substring(p,h).trimEnd(),_.tokenranges.push({start:p,end:h,type:1});let Ue=_.tokens[p]={type:te,content:ce,offset:p,length:ce.length,next_token_offset:-1,topofline:$,ignore:Ze,skip_pos:h,previous_token:m};if(!$)Vn.includes(d[p-1])||ke(Ue);else{let _e=_.document.positionAt(h).line;!Ce&&!Ze&&_t[0]&&!_t.startsWith("/*")&&(a[_e+1]=Ue),G&&(m.pos??=_.document.positionAt(m.offset)).line>G.endLine&&Je(),G?G.endLine=_e:At&&(G=D.FoldingRange.create(_.document.positionAt(p).line,_e,void 0,void 0,"comment"))}return Ue}if(A==="/"&&$&&d[h]==="*"){let te=d.indexOf(`
`,--h),ce=0,S="";for(;!(L=d.substring(h,te>0?te:w).match(/(^[ \t]*\*\/)|\*\/([ \t]*\r?)$/))&&te>0;)x=te,te=d.indexOf(`
`,h=te+1),ce++;L?.[1]?(h=d.indexOf("*/",x)+2,i=!0,x=h-1):h=(te<0?w:te)-(L?.[2].length??(S="*/",0)),_.tokenranges.push({start:p,end:h,type:1});let Fe={type:"TK_BLOCK_COMMENT",content:d.substring(p,h)+S,offset:p,length:h-p,next_token_offset:-1,previous_token:m,topofline:$,skip_pos:h};if(!Ce){let Ze=h,tt=0;for(;" 	\r".includes(A=d[Ze]??"\0")||A===`
`&&++tt<2;Ze++);(d[p+2]==="*"&&d[p+3]!=="/"&&!(Fe.data=null)||!`
\0`.includes(A))&&(a[_.document.positionAt(Ze).line]=Fe)}return Je(),_.tokens[p]=Fe,ce&&_.addFoldingRange(p,h,"comment"),Fe}if(-1<(ie=Nu.indexOf(A))){if(ye&&"<>".includes(A))return m=it(A,A==="<"?"TK_START_EXPR":"TK_END_EXPR",p,A.length,$);for(;h<w&&-1<(L=Nu.indexOf(A+d[h],ie));)A+=d[h++],ie=L;if(A==="?"){m=it(A,"TK_OPERATOR",p,1,$);let te=h,ce=m,S=Zt(C+1);return h=te,(")]},:??".includes(S.content)||S.content==="."&&S.type!=="TK_OPERATOR")&&(ce.ignore=!0,S.content==="."&&un<wn-1&&_.addDiagnostic(ee.requireVerN(wn-1),ce.offset,ce.length,{code:"optional chaining"})),m=ce}else A==="??="&&un<wn-1&&_.addDiagnostic(ee.requireVerN(wn-1),p,A.length,{code:"maybe-assign"});return m=it(A,ie>=bk?"TK_EQUALS":"TK_OPERATOR",p,A.length,$)}if(A==="#"){let te="#";for(;Fn(d.charCodeAt(h));)te+=d[h++];if(W.push(p),m=it(te,"TK_SHARP",p,te.length,$),wt=te.toLowerCase(),$&&Vn.includes(A=d.charAt(h))&&(wt==="#hotif"||le&&wt==="#initexec"))return m;if(x=d.indexOf(`
`,p=h),h=x<0?w:x,$&&Vn.includes(A)){if(A===" "||A==="	"){for(;" 	".includes(d[p]);)p++;let ce=d.substring(p,h).trimEnd().replace(/(^|[ \t]+);.*$/,"");m.data={content:ce,offset:p,length:ce.length},h=p+ce.length,ce&&(m.skip_pos=h,_.tokenranges.push({start:p,end:p+ce.length,type:3,previous:m.offset}))}}else m.type="TK_UNKNOWN",m.content+=d.substring(p,h).trimEnd(),m.length+=h-p;return m}return m=it(A,"TK_UNKNOWN",p,A.length,$);function U(){W.length>1&&_.addFoldingRange(W[0],W.pop(),"imports"),W.length=0}function Je(){G&&(G.endLine>G.startLine&&_.foldingranges.push(G),G=void 0)}}function or(C=R.start_line_index){let P=xe[C-1];return P?.text.length?P.indent:R.indentation_level}function zr(){if(R.mode===rt.ObjectLiteral)return R.object_style??De.object_style;if(R.mode===rt.ArrayLiteral)return R.array_style??De.array_style}function hs(){Qt()?R.last_word="_":(Dr()||I&&!bn(Ne.previous_token??ot,Ne))&&Se(null);let C=rt.Expression;if(ft!=="("){if(Ne.ignore){lt(C),ne=Ne.previous_token?.content!=="(",Qe(),R.last_word="";return}if(Ne.topofline<1&&Oi(Ne.previous_token??ot)){lt(C),Qe(),R.last_word="",R.indentation_level=or()+1,De.space_in_paren&&(ne=!0);return}(!I&&Ne.previous_token?.callsite||ct==="TK_RESERVED")&&(ne=!0),C=rt.ArrayLiteral}else Ne.ignore?Se(!0):ct==="TK_END_EXPR"||ct==="TK_WORD"?ne=Vn.includes(Ne.prefix_is_whitespace||"\0"):ct==="TK_STRING"?ne=!0:ct==="TK_RESERVED"&&(/^(break|continue|goto)$/i.test(H)?ne=!1:["if","for","while","loop","case","catch","switch"].includes(H)?ne=!!De.space_before_conditional:ne=St);if(It()||(I&&De.preserve_newlines?Se(!0):(ct==="TK_EQUALS"||ct==="TK_COMMA"||ct==="TK_OPERATOR")&&Ge()),lt(C),R.last_word="",R.indentation_level=or(),R.indentation_level<pt.indentation_level&&(pt.indentation_level=R.indentation_level,R.indent_after=!0),Qe(),Ne.ignore){let P=Ne.data.content;P&&Qe(P)}else De.space_in_paren&&(ne=!0);yt(),ft==="["&&(R.array_style??De.array_style)===Ir.expand&&Se(!0)}function uc(){for(;R.mode===rt.Statement;)kt();let C=ft==="]"&&R.mode===rt.ArrayLiteral;if(kt(),R.had_comment=pt.had_comment,C){let P=R.array_style??De.array_style;P===Ir.collapse||H==="["||R.indentation_level>=pt.indentation_level?ue():(P||I&&De.preserve_newlines)&&Se(!0)}else(ct==="TK_END_EXPR"||ct==="TK_END_BLOCK")&&R.indentation_level>=pt.indentation_level?ue():ct!=="TK_START_EXPR"&&Ge();ne=!!(De.space_in_paren&&!(ct==="TK_START_EXPR"&&!De.space_in_empty_paren)),Qe(),pt.indent_after&&yt(),u??=!1}function J(){if(Ne.data)lt(rt.ObjectLiteral),R.indentation_level=or(),pt.mode!==rt.Conditional&&(R.indent_after=R.indentation_level<pt.indentation_level,pt.indentation_level=R.indentation_level),ne||=St&&ct!=="TK_START_EXPR",Qe(),yt(),(R.object_style??De.object_style)===Ir.expand?Se(!0):ne=St;else{let C;if(Ne.in_expr)C=or();else if(["try","if","for","while","loop","catch","else","finally","switch"].includes(R.last_word))C=or();else for(;R.mode===rt.Statement;)kt();R.declaration_statement=!1,lt(rt.BlockStatement),R.in_expression=!1,R.indentation_level=C??=R.indentation_level,ne??=St,pt.in_case_statement&&ct==="TK_LABEL"&&/^(default)?:$/.test(H)?(R.case_body=null,Se(),R.indentation_level--):(De.brace_style===0||I&&De.preserve_newlines&&!De.brace_style)&&(Ne.in_expr===void 0||R.mode===rt.Expression)&&Se(!0);let P=!Ae();Qe(),R.indentation_level<pt.indentation_level&&(pt.indentation_level=R.indentation_level,R.indent_after=!0),De.switch_case_alignment&&R.last_word==="switch"||yt(),P||De.brace_style!==void 0?Se(!0):ne=St}R.last_word=""}function v(){for(;R.mode===rt.Statement;)kt();let C=R.mode===rt.ObjectLiteral,P=C||Ne.in_expr!==void 0;if(C){let A=R.object_style??De.object_style;A===Ir.collapse||H==="{"?ue():(A||I&&De.preserve_newlines)&&Se(!0),ne=St&&H!=="{"}else(De.brace_style!==void 0||I)&&Se(!0);kt(),Qe(),pt.indent_after&&yt(),P||(pt.case_body===null&&yt(),De.brace_style!==void 0&&Se(!0),ne=St)}function F(){let C=!1;if(ne||=/^(TK_NUMBER|TK_WORD|TK_RESERVED|TK_STRING|TK_END_)/.test(ct),Qt()&&(C=R.declaration_statement,!I&&["try","else","finally"].includes(R.last_word)&&["if","while","loop","for","try","switch"].includes(wt)&&Ft()),Lt==="TK_RESERVED"){if(De.keyword_start_with_uppercase!==void 0&&(ft=De.keyword_start_with_uppercase?wt.replace(/^./,P=>P.toUpperCase()):wt),Rn(wt))I&&Se(C);else{let P=!1;switch(wt){case"else":for(;R.mode===rt.Statement&&!R.if_block&&!R.loop_block&&!(R.catch_block&&!R.else_block);)kt();break;case"finally":for(;R.mode===rt.Statement&&!R.catch_block&&!R.try_block&&!(R.else_block&&R.catch_block);)kt();break;case"catch":for(;R.mode===rt.Statement&&!R.try_block&&!(R.catch_block&&!R.else_block);)kt();break;case"until":for(;R.mode===rt.Statement&&R.loop_block!==1;)kt();break;case"case":case"class":for(;R.mode===rt.Statement;)kt();break;case"if":case"for":case"loop":case"while":case"try":case"switch":if(!C)if(I&&R.mode===rt.Statement&&!R.declaration_statement&&!R.in_expression)Se(!1);else for(;R.mode===rt.Statement&&R.declaration_statement;)kt();break}if(R.if_block?wt==="else"?(R.if_block=!1,R.else_block=!0,P=!0):R.if_block=!1:R.loop_block?R.loop_block===1&&wt==="until"?(R.loop_block=0,P=!0):wt==="else"?(R.else_block=!0,R.loop_block=0,P=!0):R.loop_block=0:R.try_block?wt==="catch"?(R.try_block=!1,R.catch_block=!0,P=!0):wt==="finally"?(R.try_block=!1,R.finally_block=!0,P=!0):R.try_block=!1:R.catch_block?wt==="finally"?(R.catch_block=R.else_block=!1,R.finally_block=!0,P=!0):wt==="else"?(R.else_block=!0,P=!0):wt==="catch"?P=!0:R.catch_block=R.else_block=!1:R.else_block=R.finally_block=!1,wt==="class"){Ne.topofline===1&&Se(),Qe(),R.last_word=wt,R.start_line_index=xe.length,lt(rt.Statement),Ke=!0;return}else if(wt==="case"){Se(),R.case_body&&(Ft(),R.case_body=!1),Qe(),R.in_case=!0,R.in_case_statement=!0;return}switch(P?(ue(),R.last_text!=="}"||De.brace_style<1||I&&De.preserve_newlines&&!De.brace_style?Se(!0):ne=St):I&&(H==="else"&&!De.preserve_newlines&&["if","for","loop","while","try","switch"].includes(wt)?Ft():Se(C)),wt){case"loop":R.loop_block=1;break;case"while":case"for":R.loop_block=2;break;case"if":R.if_block=!0;break;case"try":R.try_block=!0;break}}R.last_word=wt,R.start_line_index=xe.length}else I&&R.mode===rt.Statement&&!R.in_expression&&!bn(Ne.previous_token??ot,Ne)?Se(C):I&&(De.preserve_newlines||Ne.symbol)?(Ne.symbol||zr()!==Ir.collapse)&&Se(!Ne.symbol):["TK_COMMA","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"].includes(ct)&&(It()||Ge()),!Ke&&R.mode===rt.BlockStatement&&Ne.symbol?.children&&(lt(rt.Statement),Ke=!0),R.last_word="_",De.symbol_with_same_case&&(ft=Ne.definition?.name||ft);Qe()}function q(){if(Qt())if(I&&De.preserve_newlines)Se(!0);else if(R.declaration_statement)ne=ct!=="TK_OPERATOR";else{let C=Ne.previous_token;ne=C.op_type!==-1&&!C.next_pair_pos&&St}else ct==="TK_RESERVED"||ct==="TK_WORD"?I?Se():ne=!0:ct==="TK_COMMA"||ct==="TK_START_EXPR"||ct==="TK_EQUALS"||ct==="TK_OPERATOR"?It()||Ge():(I&&Se(),Ne.ignore||Ne.data!==void 0?ne=!1:ne=!0);if(Ne.ignore){let C;if(Se(!0),De.ignore_comment&&ft.trimStart().startsWith("(")&&(C=ft.indexOf(`
`))>0){let P=ft.slice(0,C).trimEnd().replace(/[ \t]+;.*$/,"");/(^[ \t]*\(|[ \t])c(om(ments?)?)?/i.test(P)?ft=`${P}
${ft.slice(C+1).replace(/^[ \t]*;.*\r?\n/gm,"").replace(/[ \t]+;.*/gm,"")}`:ft=`${P}
${ft.slice(C+1)}`}Qe(),xe[xe.length-1].text=[ft];return}Qe()}function T(){Qt(),ne=St,Qe(),ne=St}function b(){delete R.ternary_depth,(R.mode===rt.BlockStatement||R.declaration_statement)&&(lt(rt.Statement),yt()),ct==="TK_WORD"&&Vn.includes(Ne.prefix_is_whitespace||"\0")&&Ne.previous_token?.callsite?I&&De.preserve_newlines?Se(!0):ne=!0:(ne=St&&ct==="TK_COMMA"||H==="for"&&ct==="TK_RESERVED",R.mode===rt.Statement&&R.parent.mode===rt.ObjectLiteral&&kt(),I&&De.preserve_newlines?Se(!0):Ae()||(I=!1));let C=zr();C&&ue(),Qe(),C===Ir.expand?Se(!0):ne=St}function X(){let C=!!(St||/^\w/.test(ft)),P=C;if(Ne.previous_token?.callsite&&(ne=!0),Qt()){if(R.declaration_statement&&/^(\+\+|--|%|!|~|not)$/.test(wt)){ne=!0,R.last_word="_",Qe(),wt==="not"&&(ne=!0);return}}else if(ft==="=>")Ke&&R.mode===rt.Statement&&R.parent.mode===rt.BlockStatement&&(Ke=!1),lt(rt.Statement),yt(),R.in_fat_arrow=!0;else if(/^(\+\+|--|%|!|~|not)$/.test(wt)&&Dr()){Se(),Qe(),wt==="not"&&(ne=!0);return}if(ct==="TK_RESERVED"&&(ne=!0),ft==="%"){P=!!(Ne.previous_pair_pos!==void 0&&" 	".includes(d[Ne.offset+1])),ne||=!!(Ne.next_pair_pos&&" 	".includes(Ne.prefix_is_whitespace||"\0")),I&&De.preserve_newlines&&R.mode===rt.Statement&&bn(Ne.previous_token??ot,Ne)&&Se(!0),Qe(),ne=P;return}if(ft===":"&&(R.in_case||R.mode===rt.Statement&&R.parent.in_case)){R.in_case||kt(),yt(),Qe(),Nn(`
`)?Se():ne=St,R.in_case=!1,R.case_body=!0,lt(rt.Statement),R.case_body=!0,Lt="TK_LABEL";return}I&&De.preserve_newlines?Se(!0):ct==="TK_OPERATOR"&&!/^(--|\+\+|%|!|~|not)$/.test(H)&&Ge(),["--","++","!","~"].includes(ft)||"-+".includes(ft)&&(["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR","TK_COMMA","TK_RESERVED"].includes(ct)||Ne.previous_token?.callsite)?(P=!1,C=ft==="!"&&ct==="TK_WORD",!ne&&(ft==="++"||ft==="--")&&["TK_END_EXPR","TK_WORD"].includes(ct)&&(P=!0)):ft===":"?R.ternary_depth?(kt(),Ft(),R.ternary_depth--):(C=!1,zr()&&ue()):ft==="?"?Ne.ignore?(C=!1,P=_.tokens[Ne.next_token_offset]?.content.startsWith("?")??!1):(R.ternary_depth===void 0?R.ternary_depth=1:R.ternary_depth++,yt(),lt(rt.Expression),R.ternary_depth=R.parent.ternary_depth):ft==="."?P=C=!0:ft==="&"?((ct!=="TK_WORD"&&ct!=="TK_END_EXPR"||Ne.previous_token?.callsite)&&(P=!1),(ct==="TK_COMMA"||ct==="TK_START_EXPR")&&(C=!1)):ft==="*"&&(H===","?P=!1:_.tokens[Ne.next_token_offset]?.type==="TK_END_EXPR"&&(C=P=!1)),ne||=C,Qe(),ne=P}function he(){if(R.mode===rt.Statement){let L=_.tokens[Ne.previous_token?.next_token_offset];!L||!R.in_expression&&!bn(L.previous_token??ot,L)?Se():R.had_comment<2&&ue()}if(De.ignore_comment)return;let C=ft.split(`
`),P=/^\/\*\*(?!\/)/.test(ft),A="";P||(A=new RegExp(`^${d.substring(d.lastIndexOf(`
`,Ne.offset)+1,Ne.offset)}`)),Se(!0),Qe(C[0].trimEnd());for(let L=1,ie=C.length-1;L<ie;L++)Se(!0),Qe(P?C[L].replace(/^(\s*(\*?\s*(?=@)|\* ?))?/," * "):C[L].trimEnd().replace(A,""));C.length>1&&(Se(!0),Qe((P?" ":"")+C.at(-1).trim())),Se(!0),R.had_comment=3}function vt(C){let P=C.match(/^;\s*@format\b/i);if(!P)return;let A=ju(Object.fromEntries(C.substring(P[0].length).split(",").map(L=>{let ie=L.indexOf(":");return[L.substring(0,ie).trim(),L.substring(ie+1).trim()]})));for(let L of["array_style","object_style"])L in A&&(R[L]=A[L],delete A[L]);Object.assign(De,A)}function dn(){if(vt(ft),De.ignore_comment)return;Ae()&&xe.length>1&&xe.pop();let C;xe[xe.length-1].text.push(De.white_space_before_inline_comment||((C=Ne.previous_token)?d.substring(C.skip_pos??C.offset+C.length,Ne.offset):"	"),ft),Se(!0),R.had_comment=1}function Yt(){if(R.mode===rt.Statement){let C=_.tokens[Ne.previous_token?.next_token_offset];!C||!R.in_expression&&!bn(C.previous_token??ot,C)?Se():R.had_comment<2&&ue()}vt(ft),!De.ignore_comment&&(ft.split(`
`).forEach(C=>{Se(!0),Qe(C.trim())}),Se(!0),R.had_comment=2)}function ei(){Qt(),Ge(R.last_text===")"&&De.break_chained_methods),Qe()}function ti(){Lt="TK_WORD",F()}function ni(){if(Se(),De.symbol_with_same_case&&Lt==="TK_SHARP"&&(ft=So[wt]?.[0]||ft),wt==="#hotif"&&De.indent_between_hotif_directive){R.hotif_block&&(Ft(),R.hotif_block=!1),Qe(),_.tokens[Ne.next_token_offset]?.topofline===0&&(yt(),R.hotif_block=!0),ne=!0;return}Qe();let C=Ne.data?.content;C?Qe(Lt==="TK_HOTLINE"?C:" "+C):Lt==="TK_HOT"?ne=!!De.space_after_double_colon:ne=St||Lt==="TK_SHARP"}function Mt(){if(Se(null),wt==="default:"&&(R.in_case_statement||R.mode===rt.BlockStatement&&R.last_word==="switch")){R.case_body?Ft():R.case_body=!0,Qe(),yt(),R.in_case=!1,R.in_case_statement=!0,ne=St,lt(rt.Statement),R.case_body=!0;return}Qe();let C=xe.at(-1).text;C[0].trim()===""?xe[xe.length-1].text=C.slice(1):yt()}function sr(){Qe(),_.tokens[Ne.next_token_offset]?.topofline===1&&Se()}function Dr(){return I&&(R.parent.mode===rt.BlockStatement&&["TK_END_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_WORD","TK_STRING"].includes(ct)||ct==="TK_OPERATOR"&&/^(\+\+|--|%)$/.test(H)||ct==="TK_RESERVED"&&/^(break|continue|goto|global|local|loop|return|static|throw)$/.test(H))}}clear(){this.texts={},this.declaration={},this.include={},this.tokens={},this.linepos={},this.labels={},this.typedef={},this.object={method:{},property:{}},this.need_scriptdir=this.hotstringExecuteAction=this.isparsed=!1,this.children.length=this.dllpaths.length=this.tokenranges.length=0,this.diagnostics.length=this.foldingranges.length=0,this.includedir.clear(),this.dlldir.clear(),this.d_uri="",delete this.maybev1,delete this.checkmember,delete this.symbolInformation}get included(){return qr[this.uri]??{}}get relevance(){let t=this.uri,n={...Ji[t]};for(let r in qr[t])Object.assign(n,Ji[r]);return delete n[t],n}findSymbol(t,n,r){let i,s,a=this.uri;if(n===D.SymbolKind.Field){let k=this.tokens,d=r?this.document.offsetAt(r):-1,w;s=r&&this.searchScopedNode(r);for(i of(s??this).labels?.[t.endsWith(":")?t.slice(0,-1):t]??[]){if(!i.def)break;if((w=i.data)===-1||w<d&&(!(w=k[k[w].next_pair_pos]?.offset)||d<w))return{node:i,uri:a,scope:s}}return s&&null}let u,f,l=!0;if(t.startsWith("$"))return(i=g(this.d?a:this.d_uri)??this.typedef[t])&&{node:i,uri:a,is_global:!0};if(s=r&&this.searchScopedNode(r)){if(s.kind===D.SymbolKind.Class)s=void 0;else if(s.kind===D.SymbolKind.Property&&t==="THIS")return{node:s.parent,uri:a,scope:s,is_this:!0}}let c=s;for(;c?.local;){if(u=c.local[t]){i=u,f=c,l=!1,i.is_param&&c.parent?.kind===D.SymbolKind.Property&&(f=c.parent);break}if(c.has_this_param&&(t==="THIS"||t==="SUPER")){for(i=c;i.kind!==D.SymbolKind.Class;)if(!(i=i.parent))return null;return t==="THIS"?{node:i,uri:a,scope:s,is_this:!0}:(i=Ga(i,this))?{node:i,uri:a,scope:s,is_this:!1}:null}if(((u=c.global?.[t])&&(i=u)||c.assume===2)&&(l=!0))break;if((u=c.declaration?.[t])?(i=u,f=c,l=!1):i??=(f=c,c.unresolved_vars?.[t]),c.static&&c.kind===D.SymbolKind.Function){(u=c.parent?.local[t])?.static&&(i=u,f=c.parent),i?.def&&(l=!1);break}c=c.parent}return l&&(i=g(this.d_uri)??this.declaration[t]??(l=1,i)??(l=!0,this.typedef[t])),i&&{node:i,uri:a,scope:s,is_global:l,parent:f};function g(k){let d=oe[k];if(!d)return;let w=d.declaration[t]??d.typedef[t];return w&&(a=w.uri=k,w)}}getContext(t,n=!1){let r,i,s,a,u,f,l=this.document,c=this.tokens,{line:g}=t,k=l.getText(D.Range.create(g,0,g+1,0)).trimEnd(),{character:d}=t;for(a=d;--a>=0&&Fn(k.charCodeAt(a)););if(!n)for(;Fn(k.charCodeAt(d));d++);let w=D.Range.create(g,a+=this.d&&k[a]==="$"?0:1,g,d),I=f=k.slice(a,d),G=l.offsetAt(w.start),x=(s=c[G])?s.previous_token:c[G-1];if(x?.content==="."&&!s?.prefix_is_whitespace&&x.type!=="TK_OPERATOR"||(u=x&&Oi(x)&&s?.type==="TK_START_EXPR"&&s.topofline<1&&(s.content==="["||s.prefix_is_whitespace===void 0))){let m=x,y=u?x:x.previous_token,h=!!s?.paraminfo||k[d]==="(";for(;y;)switch(y.type){case"TK_DOT":m=y,y=y.previous_token;break;case"TK_END_EXPR":if(!(y=c[y.previous_pair_pos]))break;m=y,!y.next_pair_pos||y.topofline>0?y=void 0:y.prefix_is_whitespace===void 0||y.content==="["&&!y.previous_token?.callsite?(y=y.previous_token)&&(y.type==="TK_NUMBER"||y.type==="TK_STRING"||y.content==="%"&&(y=ot)?(m=y,y=void 0):y.type==="TK_WORD"||y.type==="TK_DOT"||y.type.startsWith("TK_END_")||(y=void 0)):y=void 0;break;case"TK_END_BLOCK":if(y.in_expr!==void 0){m=c[y.in_expr],y=void 0;break}if(m=y,!(y=c[y.previous_pair_pos]))break;case"TK_START_BLOCK":m=y.data?y:ot,y=void 0;break;case"TK_NUMBER":case"TK_STRING":m=y,y=void 0;break;case"TK_WORD":if(m=y,y=y.previous_token){if(y.type==="TK_DOT")break;if(y.type==="TK_START_BLOCK"){y=void 0;break}m.prefix_is_whitespace===void 0&&y.previous_pair_pos!==void 0&&y.content==="%"&&(m=ot),y=void 0}break;case"TK_OPERATOR":if(y.ignore&&y.content==="?"){m=y,y=y.previous_token;break}default:y=void 0;break}/TK_WORD|TK_NUMBER|TK_STRING|TK_START_/.test(m.type)?(s=m,w.start=l.positionAt(m.offset),w.end=l.positionAt(x.offset+(u?1:0))):(s=ot,r=D.SymbolKind.Null),f="",r??=u?D.SymbolKind.Variable:h?D.SymbolKind.Method:D.SymbolKind.Property}else if(s)if(s.type==="TK_WORD"){let m=s.semantic,y=(i=s.symbol)??s.definition,h;if(y)r=y.kind,h=y,r===D.SymbolKind.Class?f=h.full:(r===D.SymbolKind.Property||r===D.SymbolKind.Method)&&(f=h.full.replace(/^\(([^ \t]+)\).*$/,(...W)=>`${W[1]}${h.static?".":"#"}${h.name}`));else if(m)switch(m.type){case 1:r=D.SymbolKind.Function;break;case 2:r=D.SymbolKind.Method;break;case 0:r=D.SymbolKind.Class;break;case 6:r=D.SymbolKind.Property;break;case 5:if(s.ignore)break;case 4:r=D.SymbolKind.Variable;break}else{let W;(!s.ignore||!((W=c[G-1])?.op_type===1&&W.content==="%"||(W=c[G+s.length])?.op_type===-1&&W.content==="%"))&&(r=D.SymbolKind.Variable)}}else s.type==="TK_LABEL"&&!s.hover_word&&(r=D.SymbolKind.Field);else if(x?.content.startsWith("#"))s=x,f=x.content;else if(s=this.find_token(w.start.character===k.length?G-1:G),s.type==="TK_STRING")f=s.content;else if(s.type.endsWith("COMMENT")){let m=k.substring(0,d),y=m.match(/(@see|\{@link(code|plain)?|@param(\s+\{[^}]*\})?)\s+((\[[ \t]*)?[^ \t]+)$/);if(y){if(m=y[4],y[1].startsWith("@param")){m=m.replace(/^\[[ \t]*/,"");let h=s.symbol;h?.params&&$t.test(m)&&(m=`${Ku(h)}~${m}`)}else k[d]===":"&&/^[a-zA-Z]+$/.test(m)&&(m="");(y=m.match(/^(([\w.$#~]|[^\x00-\x7f])+)(\(\))?$/))&&(f=y[1],r=f.includes(".")?y[3]?D.SymbolKind.Method:D.SymbolKind.Property:y[3]?D.SymbolKind.Function:D.SymbolKind.Class)}else(y=m.match(/(([\w.]|[^\x00-\x7f])+)$/))&&(f=y[1]+I)}return r??=D.SymbolKind.Null,{text:f,word:I,range:w,kind:r,linetext:k,token:s,symbol:i}}searchScopedNode(t,n){let{line:r,character:i}=t,s,a,u,f;for(let l of n??this.children)if(!(!(s=l.children)||r>l.range.end.line||r<l.selectionRange.start.line||r===l.selectionRange.start.line&&i<l.selectionRange.start.character||r===l.range.end.line&&i>l.range.end.character)){if(t.line>l.selectionRange.start.line||t.character>l.selectionRange.end.character){switch(l=this.searchScopedNode(t,s)??l,l.kind){case D.SymbolKind.Property:return this.searchScopedNode(t,[l.get,l.set].filter(Boolean))??l;case D.SymbolKind.Class:f=this.document.offsetAt(t),a=l;for(u of[a.property.__INIT,a.$property?.__INIT])for(let c of u?.ranges??[]){if(f<c[0])break;if(f<=c[1])return this.searchScopedNode(t,u.children)??u}}return l}return}}getScopeSymbols(t){if(!t||t.kind===D.SymbolKind.Class||t.kind===D.SymbolKind.Property)return{};let n=t,r=[n];for(;(n=n.parent)&&n.kind!==D.SymbolKind.Class;)r.push(n);let i=n?.kind===D.SymbolKind.Class?{THIS:Ro,SUPER:ns}:{};for(;n=r.pop();)n.kind!==D.SymbolKind.Property&&(n.assume===2?i={}:n.assume===1&&Object.entries(i).forEach(([s,a])=>!a.static&&a.static!==null&&delete i[s]),Object.assign(i,n.local??{}),Object.entries(n.declaration??{}).forEach(([s,a])=>i[s]??=a),Object.entries(n.unresolved_vars??{}).forEach(([s,a])=>i[s]??=a),Object.keys(n.global??{}).forEach(s=>delete i[s]));return i}initLibDirs(t){let n;if(!t){for(n of bt.WorkingDirs)if(this.uri.startsWith(n)){t=li(hn.parse(n).fsPath.replace(/[\\/]$/,""));break}}t?this.scriptdir=t:(n=(0,wo.resolve)()).toLowerCase()!==this.scriptpath.toLowerCase()&&n.toLowerCase()!==process.argv0.toLowerCase()&&this.scriptpath.toLowerCase().startsWith(n.toLowerCase())&&!/\\lib(\\.+)?$/i.test(this.scriptpath)?(0,ci.existsSync)(this.scriptpath+"\\Lib")&&(0,ci.statSync)(this.scriptpath+"\\Lib").isDirectory()?this.scriptdir=this.scriptpath:this.scriptdir=n:this.scriptdir=this.scriptpath.replace(/\\Lib(\\.+)?$/i,""),this.libdirs=[t=this.scriptdir+"\\Lib\\"],t=t.toLowerCase();for(let r of wr)t!==r.toLowerCase()&&this.libdirs.push(r)}getColors(){let t=this.tokenranges,n=this.document,r=n.getText(),i=[];for(let s of t)if(s.type===2){let a=s.start,u="",f=s.end,l=mk.exec(r.substring(a,f));if(!l||!l[1]&&f-a!==l[2].length+2)continue;let c=D.Range.create(n.positionAt(a+=l.index+1+(l[1]?.length??0)),n.positionAt(a+l[2].length));u=l[5]?_k[l[5].toLowerCase()]:l[3]===void 0?l[2]:l[2].substring(2);let g={red:0,green:0,blue:0,alpha:1},k=["red","green","blue"];l[4]!==void 0&&k.unshift("alpha");for(let d of k)g[d]=parseInt("0x"+u.substring(0,2))/255,u=u.slice(2);i.push({range:c,color:g})}return i}addDiagnostic(t,n,r=0,i){let s=this.document.positionAt(n),a=r?this.document.positionAt(n+r):s;this.diagnostics.push({message:t,range:D.Range.create(s,a),...i})}addFoldingRange(t,n,r="block"){let i=this.document.positionAt(t).line,s=this.document.positionAt(n).line-(r==="block"?1:0);i<s&&this.foldingranges.push(D.FoldingRange.create(i,s,void 0,void 0,r))}addFoldingRangePos(t,n,r="block"){let i=t.line,s=n.line-(r==="block"?1:0);i<s&&this.foldingranges.push(D.FoldingRange.create(i,s,void 0,void 0,r))}addSymbolFolding(t,n){let r=bt.SymbolFoldingFromOpenBrace?this.document.positionAt(n).line:t.range.start.line,i=t.range.end.line-1,s=this.foldingranges;r<i&&(s[s.length-1]?.startLine===r&&s.pop(),s.push(D.FoldingRange.create(r,i,void 0,void 0,"block")))}update(){let t=this.uri,n=this.include;this.parseScript(),this.foldingranges.reverse(),In[t]&&(In[t].length=0,In[t].push(...Object.values(this.declaration).filter(g=>g.kind===D.SymbolKind.Class||g.kind===D.SymbolKind.Function)));let r=this.include,i=Object.keys(r).length,s=0;for(let g in n)if(!(g in r)){s=2;break}if(!s&&(i>Object.keys(n).length||""in n)&&(s=1),!s)return this.sendDiagnostics(!0);if(xo(this,this.scriptdir),s===1){let g=vr(this);for(let k in this.included)Object.assign(Ji[k],g)}else is();let a=this.scriptpath,u=Object.keys(Ji[t]).length;for(let g in qr[t])i=Object.keys(Ji[g]).length,(i>u||i===u&&oe[g].scriptpath.length<a.length)&&(a=oe[g].scriptpath,u=i);let f,l=a.toLowerCase(),c=this.relevance;(l+"\\").startsWith(this.scriptdir.toLowerCase()+"\\lib\\")?(a=this.scriptdir,l=a.toLowerCase()):l!==this.scriptdir.toLowerCase()&&this.initLibDirs(a);for(let g in c)delete n[g],!(!(f=oe[g])||f.scriptdir.toLowerCase()===l)&&(f.initLibDirs(a),f.need_scriptdir&&f.parseScript());for(let g in n){let k=oe[g];k&&!k.actived&&k.close()}this.sendDiagnostics(!0,!0)}clearDiagnostics(){this.last_diags&&(this.include={},this.diagnostics=[],this.last_diags=0,Hn?.sendDiagnostics({uri:this.document.uri,diagnostics:[]}))}sendDiagnostics(t=!1,n=!1){let r=this.last_diags;if((r!==this.diagnostics.length||t&&r)&&(this.last_diags=this.diagnostics.length,Hn&&(this.diag_pending=!0,this.diag_timer?.refresh()||(this.diag_timer=setTimeout(async()=>{this.diag_pending=!1,await Hn.sendDiagnostics({uri:this.document.uri,diagnostics:this.diagnostics}),this.diag_pending||=void 0},500)))),!!n)for(let i in this.relevance)oe[i]?.sendDiagnostics(t)}setWorkspaceFolder(){let t=this.uri;for(let n of $i)if(t.startsWith(n))return this.workspaceFolder=n;return this.workspaceFolder=""}keepAlive(){if(this.actived)return!0;let{uri:t,d:n}=this;if(!oe[t])return!1;if(n&&n>2&&!t.includes("?"))return!0;for(let r in this.relevance)if(oe[r]?.actived)return!0;return!1}close(t=!1,n=!0){if(this.actived=!1,!t&&this.keepAlive())return;let r=n?this.relevance:void 0;if(delete this.diag_timer,this.clearDiagnostics(),(t||!this.workspaceFolder)&&(delete oe[this.uri],delete Ji[this.uri],!this.actived&&oe[this.d_uri]?.close(!1,!1)),!n)return;let i=!0;for(let s in r)i=!1,oe[s]?.close(!1,!1);i?oe[this.uri]||delete qr[this.uri]:is()}findStrOrComment(t){let n=this.tokenranges,r=0,i=n.length-1,s=0,a;for(;r<=i;)if(a=n[s=r+i>>1],t<a.start)i=s-1;else if(t>=a.end)r=s+1;else break;if(r<=i&&a)return this.tokens[a.start]??((a=this.tokens[a.previous])?.data&&{...a.data,previous_token:a,type:""})}};function Yi(e,t=0,n=""){return{name:e,full:e,kind:t,extends:n,range:yn,selectionRange:yn,uri:""}}function Um(e){let t=e.match(/^((([<>$~*!+#^]*?)(`?;|[\x21-\x3A\x3C-\x7E]|\w+|[^\x00-\x7f]))|~?(`?;|[\x21-\x3A\x3C-\x7E]|\w+|[^\x00-\x7f])[ \t]+&[ \t]+~?(`?;|[\x21-\x3A\x3C-\x7E]|\w+|[^\x00-\x7f]))([ \t]+up)?::$/i);if(!t)return!1;for(let n=4;n<7;n++)if((t[n]??"").length>1&&!Hm.test(t[n]))return!1;return!0}function Au(e,t,n="",r=!1,i=Wn){let s,a="",u=e;if(e.startsWith("<")&&e.endsWith(">")){if(!(e=e.slice(1,-1)))return;let f=[e+".ahk"];(s=e.match(/^((\w|[^\x00-\x7f])+)_.*/))&&f.push(s[1]+".ahk");for(let l of t)for(let c of f)if((0,ci.existsSync)(e=l+c))return a=hn.file(e).toString().toLowerCase(),{uri:a,path:oe[a]?.fsPath??e,raw:u}}else{for(;s=e.match(/%a_(\w+)%/i);){let f=s[1].toLowerCase();if(i[f])e=e.replace(s[0],i[f]);else return}return e.indexOf(":")<0?e=(0,wo.resolve)(n,e):e.includes("..")&&(e=(0,wo.resolve)(e)),r&&!(0,ci.existsSync)(e)?void 0:(a=hn.file(e).toString().toLowerCase(),{uri:a,path:oe[a]?.fsPath??e,raw:u})}}function xo(e,t,n=new Set){let r=e.include,i=t.toLowerCase();n.add(e);for(let s in r){let a=r[s],u,f;if(u=oe[s])(u.scriptdir.toLowerCase()!==i&&(u.initLibDirs(t),u.need_scriptdir)||u.last_diags)&&u.parseScript();else{if(!(0,ci.existsSync)(a)||!(f=nr(li(a))))continue;(oe[s]=u=new Un(f,t)).parseScript()}n.has(u)||xo(u,t,n)}}function Ga(e,t){let n=!1,r,i,s,a;switch(e.kind){case D.SymbolKind.Method:case D.SymbolKind.Function:s="func";break;case D.SymbolKind.Number:s=e.name;break;case D.SymbolKind.String:s="string";break;default:if(!e.property)return;case D.SymbolKind.Class:if(a=e,i=a.base)return i;if(n=!!a.prototype,s=a.extends,t??=oe[a.uri],r=a.extendsuri,!s)if((a.full||a.name).toLowerCase()==="any")if(n)n=!1,s="class";else return;else s="object";break}return a=er(t??oe[an.ahk2],s,r),n?a:a?.prototype}function kn(e,t,n,r,i){let s,a,u,f,l=0,c=t,g=i??=[];for(n=n.toUpperCase();;){if(l===g.length){if(g.includes(c))break;g.push(c)}if(u=c.property?.[n])if(r){if(u.kind===D.SymbolKind.Method)return u.uri??=c.uri,u;if((f=u).kind===D.SymbolKind.Class||(f=u.call))return f.uri??=c.uri,f;s??=(u.uri??=c.uri,u)}else if(u.kind===D.SymbolKind.Method)a??=(u.uri??=c.uri,u);else{if(u.children||u.has_this_param)return u.uri??=c.uri,u;s??=(u.uri??=c.uri,u)}if((f=g[++l])===null)break;if(!(c=f??Ga(c,e))){g.push(null);break}}if(s??=a)return s}function $r(e,t,n){let r=t,i=n??[],s=[];for(;r&&!i.includes(r);)i.push(r),s.push(r.property),r=Ga(r,e);if(!n)for(let a;r=i.pop();a=r.checkmember??=a);return Object.assign({},...s.reverse())}function Wr(e,t){let n=kn(t??=oe[e.uri],e,"call",!0);return n?.full?.startsWith("(Object) static Call(")?kn(t,e.prototype,"__new",!0)??n:n}function Gm(e,t,n){let r=[],i;do if(i=t.property?.[n])return i.uri??=t.uri,i;while(t=(i=t.extends?.toLowerCase())&&[i,`(${i}) prototype`].includes(t.full.toLowerCase())&&!r.includes(t)&&r.push(t)?Ga(t,e):void 0)}function er(e,t,n){let r=t.toUpperCase().split("."),i=r.shift(),s=n?oe[n]?.declaration[i]:ji(e,i)?.node;if(!(!s?.property||s.def===!1)){n??=s.uri;for(i of r)if(!(s=Gm(e,s,i)))return;return s.uri??=n,s}}function Oi(e){switch(e.type){case"TK_DOT":return!0;case"TK_END_BLOCK":return!!(e.data??e.in_expr!==void 0);case"TK_END_EXPR":case"TK_NUMBER":case"TK_STRING":return!0;case"TK_WORD":return!e.paraminfo;case"TK_RESERVED":return zm.includes(e.content.toLowerCase(),3);case"TK_OPERATOR":if(e.op_type===1)return!0;switch(e.content){case"?":return!!e.ignore;case"%":return e.previous_pair_pos!==void 0;case"++":case"--":return!e.topofline&&Oi(e.previous_token??ot)}default:return!1}}function Ti(e,t,n,r){let i=[],s=[],a=e.tokens,u=[0],f=ot,l,c,g;typeof n=="object"?l=e.document.offsetAt(n):l=n;e:for(;t&&t.offset<l;){switch(t.type){case"TK_STRING":case"TK_NUMBER":if(x())break e;i.push(t),f=t;break;case"TK_WORD":if(x())break e;if(i.push(t),f=t,t.symbol){t=e.find_token(e.document.offsetAt(t.symbol.range.end),!0);continue}else if(t.callsite){if(t.next_token_offset>=l||t.next_token_offset===-1)break e;if(i.push(c={content:"",type:"TK_FUNC",paraminfo:t.callsite.paraminfo??t.paraminfo}),t=a[t.next_token_offset],c.data=t?.content==="(",!t||!(t=a[t.next_pair_pos])){i.length=0;break e}}break;case"TK_DOT":if((t=a[t.next_token_offset])?.type==="TK_WORD"){if(c=a[t.next_token_offset],c?.content==="["&&c.topofline<1||c?.content==="("&&!c.prefix_is_whitespace){let h={content:t.content,type:"TK_FUNC"};if(i.push(h),c.offset>=l)break e;if(h.data=c.content==="(",h.paraminfo=c.paraminfo,!(t=a[c.next_pair_pos])){i.length=0;break e}break}c?.content==="%"&&!c.prefix_is_whitespace&&c.previous_pair_pos===void 0?m():i.push({content:t.content,type:"TK_FUNC"})}else if(t?.type==="TK_START_EXPR"){if(t.offset>=l)break e;if(i.push({content:"",type:"TK_FUNC",data:t.content==="(",paraminfo:t.paraminfo}),!(t=a[t.next_pair_pos])){i.length=0;break e}}else m();break;case"TK_OPERATOR":if(t.content==="%"&&t.previous_pair_pos===void 0){if(!t.prefix_is_whitespace)m();else{if(x())break e;m()}break}case"TK_EQUALS":if(G(t))break e;break;case"TK_START_EXPR":if(!(t=a[(c=t).next_pair_pos])){i.length=0;break e}if(!c.symbol&&(!c.prefix_is_whitespace||c.content==="["&&c.topofline<1)&&(f.op_type===1||["TK_WORD","TK_NUMBER","TK_STRING","TK_END_EXPR"].includes(f.type)||f.type==="TK_END_BLOCK"&&(g=a[f.previous_pair_pos])&&(g.data??g.in_expr!==void 0)))i.push({content:"",type:"TK_FUNC",paraminfo:c.paraminfo,data:c.content==="("});else if(c.content==="[")i.push({symbol:Wa});else{if(x())break e;if(i.push(c),c.symbol){f=t,t=e.find_token(e.document.offsetAt(c.symbol.range.end),!0);continue}}f=t;break;case"TK_START_BLOCK":if(!(t=a[(c=t).next_pair_pos])){i.length=0;break e}i.push(c);break;case"TK_COMMENT":case"TK_INLINE_COMMENT":case"TK_BLOCK_COMMENT":break;case"TK_COMMA":i.length=s.length=0,f=ot,u=[0];break;case"TK_END_BLOCK":case"TK_END_EXPR":if(t.offset===l-1)break e;default:i.length=0;break e}t=a[t.next_token_offset]}if(!i.length)return[];for(;t=s.pop();)I(t);let k=new Set,d=[],w;for(t of i){if(t.symbol)if(t.symbol.kind===D.SymbolKind.Property){let h=t.symbol,W=h.parent;(h=W?.property?.[h.name.toUpperCase()])?d=On(h,oe[W.uri]??e,W):d=[]}else d=[t.symbol],t.symbol.uri??=e.uri;else switch(t.type){case"TK_FUNC":{let h=!!t.data,W=t.content.toLowerCase()||(h?"call":"__item");d=Ki(e,d,W,h,t.paraminfo,w);break}case"TK_WORD":{let h=e.document.positionAt(t.offset),W=ji(e,t.content,D.SymbolKind.Variable,h);if(!W)break;d=new Set;let _=W.node;if(_.kind===D.SymbolKind.Variable){W.uri!==e.uri&&(h.line=NaN);for(let de of Tk(_,oe[W.uri]??e,h,W.scope,r))d.add(de)}else if(d.add(_),W.is_this!==void 0){w=r??_;continue}break}case"TK_NUMBER":/^[-+]?(\d+$|0[xX])/.test(t.content)?d=[Ha]:/^[-+]?\d+[.eE]/.test(t.content)?d=[Ba]:d=[Pi];break;case"TK_STRING":d=[vi];break;case"TK_START_BLOCK":if(!(c=t.data))break;if(d=[c],c.uri??=e.uri,g=!c.extends&&c.property?.BASE){let h=On(g,e,r);if(h.length<2)c.base=h[0];else{d=[];for(let W of h)d.push({...c,base:W})}}break;case"TK_START_EXPR":{let h=(c=t.paraminfo?.comma)?.length?c.at(-1):t.next_token_offset;d=Ti(e,a[h],t.next_pair_pos-1,r);break}default:if(t.content==="||")for(let h of d)k.add(h);d=[];break}w=void 0}for(let h of d)k.add(h);return[...k];function I(h){let W=u.pop(),_={content:"",type:"TK_NUMBER"},de=i.splice(W??0);if(W===void 0||!de.length)return!(i.length=0);switch(h.op_type??(h.type==="TK_EQUALS"&&0)){case-1:if(h.content==="&"&&de[0]?.offset&&de[0].type==="TK_WORD")if(de.length===1)_={symbol:Ai};else{let ye=de.at(-1);if(ye.type!=="TK_FUNC"||ye.data)return!(i.length=0);u.push(i.length),ye.content="__ref",ye.data=!0,i.push(...de);return}case 1:break;case 0:{let ye=i.splice((W=u.pop())??0),pe;if(W===void 0||!ye.length)return!(i.length=0);if(h.content.startsWith("."))_.type="TK_STRING";else if(h.content===":="){u.push(i.length),i.push(...de);return}else if(["&&","and"].includes(pe=h.content.toLowerCase())){u.push(i.length),i.push(_),i.push({type:"TK_OPERATOR",content:"||",op_type:0}),i.push(...de);return}else if(["||","or","??","??=",":"].includes(pe)){u.push(i.length),i.push(...ye),i.push({type:"TK_OPERATOR",content:"||",op_type:0}),i.push(...de);return}break}default:return!(i.length=0)}u.push(i.length),i.push(_)}function G(h){let W=y(h,!1),_=s.length?y(s[s.length-1]):-1;for(;W<=_;){if(I(s.pop()))return!0;_=s.length?y(s[s.length-1]):-1}h.content==="?"?h.ignore||i.splice(u[u.length-1]??0):(s.push(h),!h.op_type&&u.push(i.length)),f=h}function x(){if(Oi(f))return G(f={content:".",type:"TK_OPERATOR",op_type:0})}function m(){let h=t;i.splice(u[u.length-1]),i.push({symbol:sn});do{for(;t;)if(t.type==="TK_WORD"){if(h=t,t=a[t.next_token_offset],!t||t.content!=="%"||t.prefix_is_whitespace)break}else if(t.content==="%"&&t.previous_pair_pos===void 0){if(h=a[t.next_pair_pos],t=a[h?.next_token_offset],!t||t.type!=="TK_WORD"||t.prefix_is_whitespace)break}else break;if(t&&(t.content==="["||t.content==="("&&!t.prefix_is_whitespace)){if(h=t,t=a[t.next_pair_pos],!t)break;h=t,t=a[t.next_token_offset]}if(t?.type==="TK_DOT"&&t.offset<l)h=t,t=a[t.next_token_offset];else break}while(t);f=t=h}function y(h,W=!0){if(h.type==="TK_OPERATOR")switch(h.content.toLowerCase()){case"++":case"--":return h.op_type===-1?77:82;case"||":case"or":return 17;case"&&":case"and":return 21;case"is":return 28;case">":case"<":case">=":case"<=":return 34;case"=":case"==":case"!=":case"!==":return 30;case"~=":return 36;case".":return 38;case"|":return 42;case"^":return 46;case"&":return h.op_type===-1?67:50;case"<<":case">>":case"<<<":return 54;case"//":return 62;case"+":case"-":return h.op_type===-1?67:58;case"*":case"/":return 62;case"**":return 73;case"not":return 25;case"!":return 67;case"?":return h.ignore?85:11;case":":return 11;default:return 0}return h.type==="TK_DOT"?86:h.type==="TK_EQUALS"?W?7:99:h.type==="TK_COMMA"?6:0}}function Ki(e,t,n,r,i,s){let a=new Set,u=s;for(let l of t){let c=l;switch(u=s??c,l.kind){case 0:return[sn];case D.SymbolKind.Class:if(r&&n==="call"){if(!(l=kn(e,c,n,r))){if(l=f(c))break;continue}if((l.full??"").startsWith("(ComObject)")){let k=e.tokens,d=[],w=k[k[i?.offset]?.next_token_offset];w?.type==="TK_STRING"&&(d.push(w.content),(w=k[w.next_token_offset])?.content===","&&(w=k[w.next_token_offset],w?.type==="TK_STRING"&&(d.push(w.content),w=k[w.next_token_offset])),w?.content===")"&&a.add({kind:D.SymbolKind.Interface,name:"ComObject",full:`ComObject<${d.join(", ")}>`,generic_types:[d],range:yn,selectionRange:yn}));continue}break}case D.SymbolKind.Function:case D.SymbolKind.Method:if(r&&n==="call"){if(!l.has_this_param||(u=void 0,!i))break;for(let g of Ti(e,e.find_token(i.offset+1),i.comma[0]??i.end,s))for(let k of On(l,oe[l.uri]??e,g))a.add(k);continue}default:if(!(l=kn(e,c,n,r))){if(l=f(c))break;continue}if(l.kind!==D.SymbolKind.Property){if(l.eval){let g=On(l,oe[l.uri]??e,u);for(let k of r?Ki(e,g,"call",!0):g)a.add(k);continue}else if(r)break;if(!i)a.add(l);else for(let g of Ki(e,[l],"__item",!1,i,u))a.add(g);continue}else if(l.eval){let g=Ki(e,On(l,oe[l.uri]??e,u),"call",!0);for(let k of r?Ki(e,g,"call",!0):g)a.add(k);continue}else if(r||i&&!l.get?.params.length){for(let g of Ki(e,On(l,oe[l.uri]??e,u),r?"call":"__item",r,i))a.add(g);continue}break}for(let g of On(l,oe[l.uri]??e,u))a.add(g)}return a;function f(l){let c=kn(e,l,r?"__call":"__get",r);if(!c)return;if(c.kind===D.SymbolKind.Method&&!c.eval)return c;let g=c.kind===D.SymbolKind.Class?[c]:c.children?void 0:On(c,oe[c.uri]??e,u);if(g?.length)for(let k of Ki(e,g,"call",!0,i))a.add(k)}}function vk(e,t,n,r){let i=os(t,e.selectionRange.start);if(!i||i.index<0)return[];let{pos:s,index:a,kind:u}=i,f=t.getContext(s),l=Ti(t,f.token,f.range.end,r),c=!0;if(l.includes(sn))return[sn];if(!l.length)return[];let g=f.text?"":f.word.toLowerCase();u===D.SymbolKind.Property?(g||="__item",c=!1):g||="call";for(let d of l)if(k(d,g,n))return[sn];return n=[...new Set(n)],n.includes(sn)?[sn]:n;function k(d,w,I,G=0){switch(d.kind){case D.SymbolKind.Method:G++;case D.SymbolKind.Function:if(!c||w!=="call")break;case D.SymbolKind.Property:{let x=d.params?.[a+G],m;if(!x||!(m=x.type_annotations))break;for(let y of m){if(y===Ai)return!0;y.data===Ai&&I.push(...Ua(y.generic_types?.[0]??[],t,r,Xm(t,r)?.type_params))}break}case D.SymbolKind.Class:{let x=kn(t,d,w,c),m=d;if(!x)break;if(c){if(x.kind===D.SymbolKind.Class)x=Wr(x);else if(x.full?.startsWith("(Object) static Call("))x=kn(t,m.prototype,"__new",!0)??x;else if(x.kind===D.SymbolKind.Property||x.eval){let y=On(x,oe[x.uri]??t,m);x.kind===D.SymbolKind.Property&&x.eval&&(y=Ki(t,y,"call",!0)),y.forEach(h=>k(h,"call",I,-1));return}x?.kind===D.SymbolKind.Method&&k(x,"call",I,-1);return}else if(x.kind===D.SymbolKind.Class)x=kn(t,x,"__item",!1);else{if(x.kind!==D.SymbolKind.Property)return;if(!x.params){for(let y of On(x,oe[x.uri]??t,m))(y=kn(t,y,"__item",!1))&&k(y,"",I);return}}x&&k(x,"",I)}}}}function Xm(e,t){if(!t||t.children)return t;let n=ji(e,t.full.replace(/<.+/,""))?.node;if(n?.prototype)return n}function Tk(e,t,n,r,i){let s=e.name.toUpperCase(),a=e,u=e.type_annotations?[e]:[];if(!r)for(let g in t?.relevance){let k=oe[g]?.declaration?.[s];k?.type_annotations&&(u.includes(k)||u.push(k))}let f,l;for(let g of u){if((l=g.returns)&&(g.returns=void 0),f=On(g,t,i),l&&(g.returns=l),g.is_param&&g.pass_by_ref){let k=new Set;for(let d of f){if(d===Ai)return[sn];d.data===Ai?Xa(d.generic_types?.[1]??[sn],k,t,i):k.add(d)}f=[...k]}if(f.includes(sn)&&(f=[sn])||!f.includes(ki))return f;break}f??=[],l=void 0;for(let g of(r??t).children??[])if(s===g.name.toUpperCase())if(g.kind===D.SymbolKind.Variable){if(g.range.end.line>n.line||g.range.end.line===n.line&&g.range.end.character>n.character)break;(g.pass_by_ref||g.returns&&(g.for_index===void 0||Bm(g,l??=t.document.offsetAt(n))))&&(e=g)}else return[g];if(e.for_index!==void 0){let k=function(d,w=!0){let I=0,G;switch(d.kind){case D.SymbolKind.Class:{let x=[];if(w&&(l=kn(t,d,"__enum",!0,x))){if(l.kind!==D.SymbolKind.Method)break;for(let m of On(l,oe[l.uri]??t,d))k(m,!1);break}else if((l=kn(t,d,"call",!0,x))?.kind===D.SymbolKind.Method)I=-1,G=d,d=l;else break}case D.SymbolKind.Method:I++;case D.SymbolKind.Function:{let x=d.params?.[e.for_index+I],m;if(!x||!(m=x.type_annotations))break;for(let y of m){if(y===Ai)return!0;y.data===Ai&&f.push(...Ua(y.generic_types?.[0]??[],t,G,Xm(t,G)?.type_params))}break}}};var c=k;if(e===a&&!Bm(e,l??=t.document.offsetAt(n)))return[];let g=On(e,t,i);for(let d of g)if(k(d))return[sn];return f=[...new Set(f)],f.includes(sn)?[sn]:f}return e.pass_by_ref&&!e.is_param?vk(e,t,f,i):(f.push(...On(e,t,i)),f=[...new Set(f)],f.includes(sn)?[sn]:f)}function Bm(e,t){let n=e.data;return n[0]<=t&&t<n[1]}function Ua(e,t,n,r){let i=new Set,s;for(let u of e){if(typeof u=="object"){i.add(u);continue}(s=u.startsWith("typeof "))&&(u=u.substring(7)),`'"`.includes(u[0])?i.add(vi):/^[-+]?(\d+$|0[xX])/.test(u)?i.add(Ha):/^[-+]?\d+[.eE]/.test(u)?i.add(Ba):i.add(`${s?"typeof ":""}${u}`)}let a=new Set;return Xa([...i],a,t,n,r),[...a]}function Xa(e,t,n,r,i){let s,a=-1,u,f,l,c,g;for(let d of e)a++,typeof d=="string"?((f=d.startsWith("typeof "))&&(d=d.substring(7)),(c=i?.[d.toUpperCase()])?Xa(r.generic_types?.[c.data]??(c.type_annotations||[]),t,n,r,i):(l=(u=d==="this")&&r||ji(n,d)?.node)&&(l.kind===D.SymbolKind.TypeParameter?(g=!0,e[a]="",e.push(...Ua(l.type_annotations||[],n))):l.kind!==D.SymbolKind.Variable&&(t.add(l=!f&&l.prototype||l),!u&&(e[a]=l)))):d.kind===D.SymbolKind.TypeParameter?(g=!0,e[a]="",e.push(...Ua(d.type_annotations||[],n))):t.add(i?k(d):d);g&&e.push(...new Set(e.splice(0).filter(Boolean)));function k(d){let w=d.generic_types;return!w||(s??=new RegExp(`[< ](${Object.keys(i).join("|")})[,>]`,"i"),!s.test(d.full))?d:(w=w.map(I=>I.flatMap(G=>typeof G=="object"?[k(G)]:(c=i[G.toUpperCase()])?r.generic_types?.[c.data]??(c.type_annotations||[]):[G])),w.length||(w=void 0),{...d,generic_types:w,full:d.full.replace(/<.+/,w?`<${w.map(I=>ai(I)).join(", ")}>`:"")})}}function On(e,t,n){let r,i,s,a;switch(!e.cached_types){case!0:{let f=e.type_annotations;if(!f)break;r=new Set;for(let l of f){if(typeof l=="object"){r.add(l);continue}(s=l.startsWith("typeof "))&&(l=l.substring(7)),`'"`.includes(l[0])?r.add(vi):/^[-+]?(\d+$|0[xX])/.test(l)?r.add(Ha):/^[-+]?\d+[.eE]/.test(l)?r.add(Ba):r.add(`${s?"typeof ":""}${l}`)}if(r.has(sn))return e.cached_types=[sn];e.cached_types=[...r],a=r.has(ki)}default:if(Xa(i=e.cached_types,r=new Set,t,n,n&&e.parent?.type_params),!a)return[...r]}let u;if(t&&e.returns){e.cached_types=[sn],u=[];for(let f=0,l=e.returns,c=l.length;f<c;f+=2)u.push(...Ti(t,t.find_token(l[f],!0),l[f+1],n));if(r){for(let f of new Set(u))f.property&&!f.name&&!r.has(f)&&(r.add(f),i.push(f));u=[...r],e.cached_types=i}else r=new Set(u),e.cached_types=u=[...r]}else u=r?[...r]:[];return u}function Ku(e){let t;switch(e.kind){case D.SymbolKind.Interface:return e.full;case D.SymbolKind.Class:return t=e,t.prototype?`typeof ${t.full}`:t.full||"Object";case D.SymbolKind.Function:{if(e.name){let r=e,i=[e],s=[e.name];for(;r.parent?.params;)i.push(r=r.parent),s.push(r.name);if(!s.includes("")&&r.kind!==D.SymbolKind.Property)return r.kind!==D.SymbolKind.Function&&s.splice(-1,1,Ku(r)),s.reverse().join("~")}let n=e;return t=n.full.replace(/^[^()]+/,""),t.length===n.param_def_len&&(n.params.some(r=>r.range_offset)&&(t=`(${n.params.map(r=>`${r.pass_by_ref?"&":""}${r.name}${r.defaultVal===null||r.range_offset?"?":r.defaultVal?` := ${r.defaultVal}`:r.arr?"*":""}`).join(", ")})`),t+=` => ${Do(e)||"void"}`),t}case D.SymbolKind.String:case D.SymbolKind.Number:return(e.data??e.name).toString();case 0:return"Any";case D.SymbolKind.Null:return"unset";case D.SymbolKind.Method:case D.SymbolKind.Property:if(t=e.full?.match(/^\((.+?)\)/)?.[1])return`${t}${e.static?".":"#"}${e.name}`;default:return"unknown"}}function Do(e,t,n){return ai(e.type_annotations||On(e,oe[e.uri]??t,n))}function ai(e){if(!e)return"";let t=[...new Set(e.map(r=>typeof r=="string"?r:Ku(r)))],n=t.pop();return n?((t=t.map(r=>r.includes("=>")&&!`"'`.includes(r[0])?`(${r})`:r)).push(n),t.join(" | ")):""}function Fr(e){if(e){let t=new Un(Gn.create("","ahk2",0,`$:${e}`),void 0,-1);return t.parseScript(),t.declaration.$?.type_annotations??!1}return!1}var wk=[D.SymbolKind.Variable,D.SymbolKind.Function,D.SymbolKind.Field];function ji(e,t,n,r){let i=t.toUpperCase().split(/[.#~]/),s=i.length-1,a=i.shift(),u=!0,f,l,c=e.findSymbol(a,n,!s&&wk.includes(n)?r:void 0);if(c===null)return;let g=c?.scope;if(!c||c.is_global===1?c=G(e.relevance,a)??c:c.is_global&&c.node.kind===D.SymbolKind.Variable&&(l=G(e.relevance,a),l&&(l.node.kind!==D.SymbolKind.Variable||l.node.def&&!c.node.def)&&(c=l)),n===D.SymbolKind.Field)return c;if((!c||c.node.kind===D.SymbolKind.Variable&&((u=!c.node.def)||c.is_global))&&(l=I(a))?c={uri:l.uri,node:l,is_global:!0}:g&&(g.uri??=e.uri,c.scope=g),!c)return;let k=a.length,d,w=c.node;w.uri??=c.uri;for(a of i){switch(t[k]){default:return;case"#":if(!(w=w.prototype))return;case".":if(!(w=Gm(e,w,a)))return;break;case"~":if(!(w=(d=w).declaration?.[a]))return;w.uri??=d.uri}k+=a.length+1}return s&&(n===D.SymbolKind.Method&&(l=w.call)&&(l.uri??=w.uri,w=l),c={node:w,uri:w.uri,parent:d}),c;function I(x){if(l=Wt[x])return l;for(let m of[an.ahk2_h,an.ahk2])if(l=oe[m]?.typedef[x])return l.uri??=m,l;if(u&&!s&&(l=oe[f=an.winapi]?.declaration[x]))return l.uri??=f,l}function G(x,m){let y,h;for(let W in x)if(h=(oe[W]??Jm(li(x[W]),!1))?.findSymbol(m,n)){if(h.node.kind!==D.SymbolKind.Variable)return h;(!y||h.node.def&&!y.node.def)&&(y=h)}return y}}function tr(e,t){let{text:n,word:r,range:i,kind:s}=t,a;if(n)return(a=ji(e,n,s,i.end))&&[a];let u=[],f=s===D.SymbolKind.Method,l=Ti(e,t.token,i.end);if(!r&&l.length){for(let c of l)u.push({node:c,uri:c.uri});return u}for(let c of l)(a=kn(e,c,r,f))&&u.push({node:a,uri:a.uri,parent:c});if(u.length)return u}function os(e,t,n){let r,i,s,a,u=e.tokens,f=e.document.offsetAt(t);function l(k){let d=u[k.offset];if(r=e.document.positionAt(k.offset),d.type==="TK_WORD"){if(a&&t.line>e.document.positionAt(a.offset+a.length).line&&!bn(a,ot))return;i=f>k.offset+d.content.length?0:-1}else{let w=d.previous_token??ot;if(w.symbol||w.ignore)return null;if(i=0,d.content==="["){if(d.topofline===1||!Oi(d.previous_token))return;s=D.SymbolKind.Property}else if(d.prefix_is_whitespace||!Oi(w))return}if(i!==-1)for(let w of k.comma)if(f>w)++i;else break;return s??=k.method?D.SymbolKind.Method:D.SymbolKind.Function,{name:k.name??"",pos:r,index:i,kind:s,count:k.count}}if(n)return l(n);let c=e.find_token(f),g=a=c.previous_token;if(!(f<=c.offset&&!(c=g))){if(c.callsite&&f>c.offset+c.length&&t.line<=c.callsite.range.end.line)return l(c.paraminfo);if(!(c.topofline>0))for(;c.topofline<=0;){switch(c.type){case"TK_END_BLOCK":c=u[c.previous_pair_pos];break;case"TK_END_EXPR":c=u[(g=c).previous_pair_pos],c=c?.previous_token;break;case"TK_START_EXPR":case"TK_COMMA":if(g=c,c.paraminfo)return l(c.paraminfo);break;case"TK_OPERATOR":c.content==="%"&&!c.next_pair_pos&&(c=u[c.previous_pair_pos]);default:break}if(!(c=c?.previous_token))break;if(c.callsite&&c.paraminfo)return l(c.paraminfo)}}}var Ji={},qr={};function is(){Ji={},qr={};for(let e of Object.values(oe))vr(e)}function vr(e,t){let{uri:n,include:r}=e,i=!0,s=Ji[n]??=(i=!1,{[n]:e.fsPath});t=(t??=qr[n])?{...t}:{},e.is_virtual||(t[n]=e.fsPath);for(let a in r)if(Object.assign(qr[a]??={},t),!!(e=oe[a]))if(s[a])t[a]||vr(e,t);else{if(i&&t[a])continue;let u=vr(e,t);u[n]?s=Ji[n]=Object.assign(u,s):Object.assign(s,u)}return s}function Vr(e,t,n){let r=e.markdown_detail;return r===void 0?e.detail??"":(n&&(r=r.replace(n,"")),r=r.replace(/\{@link(code|plain)?\b([^{}\n]*)\}/gm,(...i)=>{let s=i[2]?.trim()??"",a="",u,f=s.search(/[|\s]/);if(f!==-1&&(a=s.substring(f+1).trim(),s=s.slice(0,f).trim()),t&&(u=s.match(/^(([\w.$#~]|[^\x00-\x7f])+)(\(\))?$/)?.[1])){let l=ji(t,u,u.includes(".")?s.endsWith(")")?D.SymbolKind.Method:D.SymbolKind.Property:s.endsWith(")")?D.SymbolKind.Function:D.SymbolKind.Class);if(l&&(t=oe[l.uri])){let{start:{line:c,character:g}}=l.node.selectionRange,k=encodeURIComponent(JSON.stringify([hn.parse(t.document.uri).toJSON(),[-1,{selection:{startLineNumber:c+1,startColumn:g+1}}]]));a||=s,s=`command:_workbench.open?${k}`}}return/^[a-z]+:/.test(s)&&(a||=s)?`[${i[1]==="code"?`\`${a}\``:a}](${s})`:` ${s} ${a} `}),r?{kind:"markdown",value:r}:"")}function To(e,t){if(e.kind===t.kind)return e.kind===D.SymbolKind.Class?ee.conflictserr("class","Class",e.name):e.kind===D.SymbolKind.Function?ee.conflictserr("function","Func",e.name):ee.dupdeclaration();switch(t.kind){case D.SymbolKind.Variable:return ee.assignerr(e.kind===D.SymbolKind.Function?"Func":"Class",e.name);case D.SymbolKind.Function:return e.kind===D.SymbolKind.Variable?ee.assignerr("Func",e.name):ee.conflictserr("function","Class",e.name);case D.SymbolKind.Class:return e.kind===D.SymbolKind.Function?ee.conflictserr("class","Func",e.name):e.kind===D.SymbolKind.Property||e.kind===D.SymbolKind.Method?ee.dupdeclaration():ee.assignerr("Class",e.name);case D.SymbolKind.Property:case D.SymbolKind.Method:return ee.dupdeclaration()}return""}function Co(e,t,n){let{children:r,diagnostics:i,uri:s,relevance:a}=n,u=D.DiagnosticSeverity.Error,f="",l,c;for(let g of t){if(!g.name||!g.selectionRange.end.character)continue;let k;switch((l=g).kind){case D.SymbolKind.Variable:l.assigned||=!!l.returns,k=!0;case D.SymbolKind.Class:case D.SymbolKind.Function:case D.SymbolKind.Module:if(c=e[f=g.name.toUpperCase()],f.substring(0,2)==="A_"&&Wt[f]){if(k)continue;g.params&&(g.has_warned??=i.push({message:ee.conflictserr("function","built-in variable",g.name),range:g.selectionRange}))}if(t===r)g.uri=s;else if(c&&!a[c.uri]){e[f]=g;continue}if(!c)e[f]=g;else if(c.is_global){if(k){if(l.def&&c.kind!==D.SymbolKind.Variable){l.assigned!==1&&(g.has_warned??=i.push({message:ee.assignerr(c.kind===D.SymbolKind.Function?"Func":"Class",g.name),range:g.selectionRange,severity:u}));continue}}else if(c.kind===D.SymbolKind.Function){g.has_warned??=i.push({message:To(c,g),range:g.selectionRange,severity:u});continue}else c.def&&c.assigned!==1&&(c.has_warned??=i.push({message:ee.assignerr(g.kind===D.SymbolKind.Function?"Func":"Class",g.name),range:c.selectionRange,severity:u}));e[f]=g}else k?c.kind===D.SymbolKind.Variable?l.def&&!c.def?e[f]=g:c.assigned||=l.assigned:l.def&&(delete l.def,l.assigned!==1&&(g.has_warned??=i.push({message:To(c,g),range:g.selectionRange,severity:u}))):c.kind===D.SymbolKind.Variable?(c.def&&(delete c.def,c.assigned!==1&&(c.has_warned??=i.push({message:To(g,c),range:c.selectionRange,severity:u}))),e[f]=g):c.def!==!1?g.has_warned??=i.push({message:To(c,g),range:g.selectionRange,severity:u}):l.def!==!1&&(e[f]=g);break}}}function bn(e,t,n){switch(e.type){case"":case"TK_COMMA":case"TK_EQUALS":case"TK_START_EXPR":return!0;case"TK_OPERATOR":if(e.ignore)return!1;if(!/^(%|\+\+|--)$/.test(e.content))return!0;default:switch(t.type){case"TK_DOT":case"TK_COMMA":case"TK_EQUALS":return!0;case"TK_OPERATOR":return!/^(!|~|not|%|\+\+|--)$/i.test(t.content)&&(!n?.has_this_param||!$t.test(t.content)||n.returns?.[1]!==0||n.kind===D.SymbolKind.Function);case"TK_STRING":if(t.ignore)return!0;default:return!1}}}function Qm(e){let t=es;try{es=e?new RegExp(e,"i"):void 0}catch(n){throw es=t,n}}function ju(e){if(typeof e.brace_style=="string")switch(e.brace_style){case"0":case"Allman":e.brace_style=0;break;case"1":case"One True Brace":e.brace_style=1;break;case"-1":case"One True Brace Variant":e.brace_style=-1;break;default:delete e.brace_style;break}for(let t of["array_style","object_style"]){let n=e[t];typeof n=="string"&&(e[t]=Ir[n])}return e}var Ym=require("fs/promises"),Ja=zn(si());async function e_(e,t){let n=e.textDocument.uri,r=oe[n.toLowerCase()],i=r?.document;if(!r||t.isCancellationRequested||r.diag_pending!==void 0)return;let s=[],a={},u=[],f;for(let l of e.context.diagnostics)switch(l.code){case"call statement":{let c=r.tokens[i.offsetAt(l.range.start)],k=c.callsite.range.end,d=c.next_token_offset===-1?k=l.range.end:i.positionAt(c.next_token_offset);(d.line>k.line||d.line===k.line&&d.character>k.character)&&(d=k),u.push({newText:"(",range:{start:l.range.end,end:d}},{newText:")",range:{start:k,end:k}});break}case"expect":(a[`${i.getText(l.range)} ${l.data}`]??=[]).push({range:l.range,newText:l.data});break;case"include":if(f=l.data?.match(/(.+?)\*\.(\w+)$/)){let c=li(f[1]).replace(/\\?$/,"\\"),g=new RegExp(`\\.${f[2]}$`,"i"),k=[],d=Object.assign({},l.range);d.start=Object.assign({},d.start),d.start.character=0;try{for await(let G of await(0,Ym.opendir)(c))g.test(G.name)&&k.push(`#Include ${c}${G.name}`)}catch{continue}let w={range:d,newText:k.join(`
`)},I={title:Im.include(`${c}*.${f[2]}`),kind:Ja.CodeActionKind.QuickFix};I.edit={changes:{[n]:[w]}},s.push(I)}break}for(let[l,c]of Object.entries(a))s.push({kind:Ja.CodeActionKind.QuickFix,edit:{changes:{[n]:c}},title:l.replace(/(\S+) (\S+)/,"Replace '$1' with '$2'")});return u.length&&s.push({kind:Ja.CodeActionKind.Refactor,edit:{changes:{[n]:u}},title:"Use parenthesized function call styles"}),s.length?s:void 0}async function t_(e,t){let{range:n,color:r,textDocument:{uri:i}}=e,s=oe[i.toLowerCase()]?.document.getText(n);if(!s||t.isCancellationRequested)return;let a=/^0x/.test(s)?"0x":"",u=s.length-(a?2:0)>6?"A":"",f=[r.red,r.green,r.blue];return u&&f.unshift(r.alpha),f=f.map(l=>`0${Math.round(l*255).toString(16)}`.slice(-2)),f=[f.join(""),f.reverse().join("")],[{label:`${u}RGB: ${f[0]}`,textEdit:{range:n,newText:`${a}${f[0]}`}},{label:`BGR${u}: ${f[1]}`,textEdit:{range:n,newText:`${a}${f[1]}`}}]}async function n_(e,t){if(!t.isCancellationRequested)return oe[e.textDocument.uri.toLowerCase()]?.getColors()}var Rr=zn(si());var as={};function Rk(e,t,n=!1){if(bt.commands?.includes(e))return Hn?.sendRequest(e,t);n||Hn?.window.showWarningMessage(`Command '${e}' is not implemented!`)}function $u(){return Hn.sendRequest("getEditorLocation")}function i_(e){return e?.replace(/^[ \t]*(\*?[ \t]*(?=@)|\* ?)/gm,"").replace(/^\/\*+\s*|\s*\**\/$/g,"")??""}function Fu(e,t){return Rk("setTextDocumentLanguage",[e,t])}function Za(e,t,n){let r=n?.replace(/\$/g,"\\$").split(`
`),i={},s=[],a=[],u=["/**"],f,l,c=0,g=!0;if(r?.forEach(d=>{(l=d.match(/^@(param|arg)\s+(({[^}]*}\s)?\s*(\[.*?\]|\S+).*)$/i))?(f=i[l[4].replace(/^\[?((\w|[^\x00-\x7f])+).*$/,"$1").toUpperCase()]??=[]).push("@param "+l[2].trim()):(l=d.match(/^@(returns?)([\s:]\s*(.*))?$/i))?(f=s,s.push(`@${l[1].toLowerCase()} ${l[3]}`)):f&&!d.startsWith("@")?f.push(d):(f=void 0,a.push(d))}),a.join("").trim()?a.forEach(d=>u.push(" * "+d)):(u.push(" * $0"),g=!1),t.params.forEach(d=>{if(f=i[d.name.toUpperCase()])f.forEach(w=>u.push(" * "+w));else if(d.name){let w=Do(d,e);w?u.push(` * @param \${${++c}:{${w}\\}} ${d.name} $${++c}`):u.push(` * @param ${d.name} $${++c}`)}}),s.length)s.forEach(d=>u.push(" * "+d));else{let d=Do(t,e);d&&u.push(` * @returns \${${++c}:{${d}\\}} $${++c}`)}u.push(" */");let k=u.join(`
`);return g&&(k=k.replace(new RegExp(`\\$${c}\\b`),"$0")),k}async function Ck(){let{uri:e,position:t}=await $u(),n=oe[e.toLowerCase()],r=n.searchScopedNode(t),i=r?.children||n.children;for(let l of i)if((l.kind===Rr.SymbolKind.Function||l.kind===Rr.SymbolKind.Method)&&l.selectionRange.start.line===t.line&&l.selectionRange.start.character<=t.character&&t.character<=l.selectionRange.end.character){r=l;break}if(!r||!r.params)return;let s,a=r.selectionRange.start,u,f;if(r.markdown_detail===void 0)s=`${Za(n,r)}
`,u=n.tokens[n.document.offsetAt(a)],u.topofline===2&&(u=u.previous_token),a=n.document.positionAt(u.offset),f={start:a,end:a};else{if(u=n.find_token(n.document.offsetAt({line:a.line-1,character:0})),u.type!=="TK_BLOCK_COMMENT")return;s=Za(n,r,i_(r.detail)),f={start:n.document.positionAt(u.offset),end:n.document.positionAt(u.offset+u.length)}}Hn.sendRequest("insertSnippet",[s,f])}function r_(e){let t=oe[e.toLowerCase()],n={},r={};if(!t)return;is();for(let s of[t.uri,...Object.keys(t.relevance)]){if(!(t=oe[s]))continue;let a;a=Object.entries(t.include).map(u=>oe[u[0]]?.fsPath??li(u[1])),!a.length&&(a=void 0),i(Object.values(t.declaration),r[t.fsPath||t.document.uri]={includes:a},t)}return r;function i(s,a,u,f){let l,c,g,k;for(let x of s)if(x.selectionRange.end.character)switch(l=x.kind){case Rr.SymbolKind.Class:g=x,(a.classes??=[]).push(k={name:x.name,label:g.full,extends:w(g),detail:I(x)}),i(Object.values(g.property??{}),k,u,g),i(Object.values(g.$property??{}),k,u,g.prototype);break;case Rr.SymbolKind.Property:if(c=x,(a.properties??=[]).push({name:x.name,label:c.full,static:c.static??!1,variadic:c.variadic??!1,params:G(c.params),readonly:c.params&&!x.set||!1,type:Do(c,u,f),detail:I(x)}),!(x=x.call))break;case Rr.SymbolKind.Function:case Rr.SymbolKind.Method:c=x,(a[l===Rr.SymbolKind.Function?"functions":"methods"]??=[]).push({name:x.name,label:c.full,static:c.static??!1,variadic:c.variadic??!1,params:G(c.params),returns:Do(c,u,f),detail:I(x)});break}function d(x){switch(x.defaultVal){case!1:return null;case null:return"unset";default:return x.defaultVal}}function w(x){let m;if(m=x.extends)return n[`${x.extendsuri},${m}`]??=er(t,m,x.extendsuri)?.full||m}function I(x){return x.markdown_detail?i_(x.detail):x.detail??""}function G(x){return x?.map(m=>({name:m.name,defval:d(m),byref:m.pass_by_ref??!1,variadic:m.arr??!1,type:ai(m.type_annotations)}))}}}async function xk(){let{uri:e}=await $u(),t=oe[e.toLowerCase()];if(t){is();for(let n in t.relevance)(n=oe[n]?.document.uri)&&Eo({textDocument:{uri:n}});Eo({textDocument:{uri:e}})}}async function Dk(){let{uri:e}=await $u(),t=oe[e.toLowerCase()];if(t){(t.scriptdir!==t.scriptpath&&(t.initLibDirs(t.scriptpath),t.need_scriptdir)||t.last_diags)&&t.parseScript(),xo(t,t.scriptpath);for(let n in vr(t))(n=oe[n]?.document.uri)&&Eo({textDocument:{uri:n}});t.sendDiagnostics(!1,!0)}}function o_(e){let t=oe[e.toLowerCase()];if(!t)return;let n=t.document,r=t.tokens,i={line:0,character:0},s=t.get_token(0);for(;s.type==="TK_SHARP";)i.line=n.positionAt(s.offset).line+1,s=t.get_token(n.offsetAt(i));let a=[];(!s.type||s.type.endsWith("COMMENT"))&&/^\s*[;*]?\s*@(date|version)\b/im.test(s.content)&&a.push({uri:e,content:s.content,single:!1,range:{start:n.positionAt(s.offset),end:n.positionAt(s.offset+s.length)}});for(let u of t.tokenranges)u.type===1&&(s=r[u.start])?.topofline&&/^;\s*@ahk2exe-set(file|product)?version\b/i.test(s.content)&&a.push({uri:e,content:s.content,single:!0,range:{start:n.positionAt(u.start),end:n.positionAt(u.end)}});return a}function s_(e){return e?.length?(e.includes("getEditorLocation")&&(as["ahk2.diagnose.all"]=xk,e.includes("insertSnippet")&&(as["ahk2.generate.comment"]=Ck),as["ahk2.set.scriptdir"]=Dk),Object.keys(as)):[]}function a_(e,t){if(!t?.isCancellationRequested)return as[e.command](...e.arguments??[])}var Ur=require("fs"),Ya=require("fs/promises"),Br=require("path"),Oe=zn(si());async function c_(e,t){let{position:n,textDocument:{uri:r}}=e,i=oe[r=r.toLowerCase()],s={};if(!i||t.isCancellationRequested)return;let a=[],u=a.pop(),f,l,c,g,k,{triggerKind:d,triggerCharacter:w}=e.context??{},I=H=>H;if(w==="*"){let H=i.tokens[i.document.offsetAt(n)-3];if(H?.type==="TK_BLOCK_COMMENT"){!H.previous_token?.type&&H===i.get_token(0,!1)&&a.push({label:"/** */",detail:"File Doc",kind:Oe.CompletionItemKind.Text,insertTextFormat:Oe.InsertTextFormat.Snippet,textEdit:Oe.TextEdit.replace({start:i.document.positionAt(H.offset),end:i.document.positionAt(H.offset+H.length)},["/************************************************************************"," * @description ${1:}"," * @author ${2:}"," * @date ${3:$CURRENT_YEAR/$CURRENT_MONTH/$CURRENT_DATE}"," * @version ${4:0.0.0}"," ***********************************************************************/","$0"].join(`
`))});let ne=Ut(H);if(ne){let Ke=ne;a=[{label:"/** */",detail:"JSDoc Comment",kind:Oe.CompletionItemKind.Snippet,insertTextFormat:Oe.InsertTextFormat.Snippet,textEdit:Oe.TextEdit.replace({start:i.document.positionAt(H.offset),end:i.document.positionAt(H.offset+H.length)},`/**
 * $0
 */`)}],Ke.params&&(a[0].textEdit.newText=Za(i,Ke))}}return a}if(w==="@"){let H=i.findStrOrComment(i.document.offsetAt(n)-1);if(H?.type.endsWith("COMMENT")){let ne=i.document.positionAt(H.offset).line===n.line,Ke=H.type==="TK_BLOCK_COMMENT"?"/*":";";return cn.directive["@"].filter($e=>Ke.includes(f=$e.data)&&(ne||f!=="/"))}return}let G=Object.fromEntries(Object.entries(bt.CompletionCommitCharacters??{}).map(H=>(H[1]=(H[1]||void 0)?.split(""),H))),{text:x,word:m,token:y,range:h,linetext:W,kind:_,symbol:de}=i.getContext(n,!0),ye=i.relevance,{line:pe,character:Ve}=n,le=!1,N=Po(m),V;switch(y.type){case"TK_UNKNOWN":if(y.content===".")break;if(y.content!=="#")return;case"TK_SHARP":return y.topofline===1?cn.directive["#"]:[];case"TK_HOT":case"TK_HOTLINE":{if(!y.ignore)return cn.key.filter(ne=>!ne.label.toLowerCase().includes("alttab"));let H=i.document.offsetAt(n)-y.offset;return 0<H&&H<=x.indexOf(":",1)?cn.option.hotstring:void 0}case"":case"TK_EOF":if((c=y.previous_token)?.type==="TK_SHARP"){let H=!1;switch(c.content.toLowerCase()){case"#dllload":H=!0;case"#include":case"#includeagain":{let ne=i.document.offsetAt(n)-y.offset,Ke=y.content,$e=Ke.slice(0,ne),Bt,ke=$e[0],dt=!1,st="";if(`'"`.includes(ke)?$e=$e.slice(1):ke="",$e=$e.replace(/^\*i[ \t]/i,""),$e.startsWith("*")){N=Po($e.slice(1));for(let Xe of Ni.get_RCDATA()?.paths??[])N.test(Xe)&&Ne(Xe,Oe.CompletionItemKind.File);return a}if($e[0]==="<"&&(ke=">"+ke,$e=$e.slice(1)),/["<>*?|]/.test($e)||H&&ke.startsWith(">"))return;if($e=$e.replace(/`(.)/g,"$1").replace(/[^\\/]+$/,Xe=>(st=Xe,"")),!ke.startsWith(">")&&Ke.includes("%")){if(Ke.replace(/%[^%]+%/g,nt=>"\0".repeat(nt.length))[ne]==="\0")return Object.values(Wt).filter(nt=>nt.kind===Oe.SymbolKind.Variable&&N.test(nt.name)).map(Lt);let Xe={...Wn,scriptdir:i.scriptdir,linefile:i.fsPath};if($e=$e.replace(/%a_(\w+)%/i,(nt,we)=>{let it=Xe[we.toLowerCase()];return typeof it=="string"?it:"\0"}),$e.includes("\0"))return}if(H)Bt=[(k=i.dlldir.get(n.line))?k:i.scriptpath,"C:\\Windows\\System32"];else if(ke.startsWith(">"))Bt=i.libdirs,dt=!0;else{let Xe=i.scriptpath,nt=n.line;for(let[we,it]of i.includedir)if(we<nt)Xe=it;else break;Bt=[Xe]}ke&&(Ke.endsWith(ke)||Ke.endsWith(">")?ke="":ke.length===2&&Ke.endsWith(ke[1])&&(ke=ke[0]));let et=$e.endsWith("/")?"/":"\\",je=Po(st),We=H?/\.(dll|ocx|cpl)$/i:dt?/\.ahk$/i:/\.(ahk2?|ah2)$/i,Dt={title:"Trigger Suggest",command:"editor.action.triggerSuggest"},Ht=$t.test(st)?void 0:{start:{line:n.line,character:n.character-st.length},end:n},Jt=Ht?(Xe,nt)=>Xe.textEdit={newText:nt,range:Ht}:(Xe,nt)=>Xe.insertText=nt,Ct=Ht||ke?Jt:()=>{};for(let Xe of Bt){try{if(!(0,Ur.existsSync)(Xe=(0,Br.resolve)(Xe,$e)+"\\")||!(0,Ur.statSync)(Xe).isDirectory()||s[Xe=Xe.toUpperCase()])continue;s[Xe]=1;for await(let nt of await(0,Ya.opendir)(Xe)){let we=nt.name;if(nt.isDirectory()){if(!je.test(we))continue;s[`${we.toUpperCase()}/`]??=(we=we.replace(/(`|(?<= );)/g,"`$1"),Jt(u={label:we,command:Dt,kind:Oe.CompletionItemKind.Folder},we+et),1)}else{if(!We.test(we)||!je.test(dt?we=we.replace(We,""):we))continue;s[we.toUpperCase()]??=(we=we.replace(/(`|(?<= );)/g,"`$1"),Ct(u={label:we,kind:Oe.CompletionItemKind.File},we+ke),1)}a.push(u)}}catch{}if($e.includes(":"))break}return a}default:return}}else if(c?.type!=="TK_HOTLINE")return;if(c.ignore)return St(),a;a.push(...cn.key),_=Oe.SymbolKind.Event;break;case"TK_BLOCK_COMMENT":if(!/[<{|:.,][ \t]*$/.test(W.substring(0,h.start.character)))return;if(x.includes("."))for(let H of Object.values(er(i,x.replace(/\.[^.]*$/,""))?.property??{}))H.kind===Oe.SymbolKind.Class&&N.test(H.name)&&a.push(Lt(H));else De();return a;case"TK_COMMENT":case"TK_INLINE_COMMENT":return;default:{if(y.callsite||y.topofline>0)break;let H=["TK_COMMA","TK_DOT","TK_EQUALS","TK_NUMBER","TK_OPERATOR","TK_RESERVED","TK_STRING","TK_WORD"],ne=y.type==="TK_STRING"?0:3,Ke=i.tokens,$e=0,Bt,ke=(c=y).callsite,dt=ke?.paraminfo;for(;(c=(Bt=Ke[c.previous_pair_pos])??c.previous_token)&&++$e!==ne;){if(Bt){if(le=!0,c.topofline>0||($e++,!(c=Bt.previous_token))||c.topofline>0){c=void 0;break}continue}if(le||=c.next_pair_pos!==void 0||H.includes(c.type),dt??=c.paraminfo){c=Ke[dt.offset]?.previous_token,$e++,le=!0;break}if((ke??=c.callsite)||c.topofline>0)break}if((ke??dt)&&(dt??=ke?.paraminfo,le=!0),c?.type==="TK_RESERVED")switch(f=c.content.toLowerCase()){case"class":if($e===2)return[{label:"extends",kind:Oe.CompletionItemKind.Keyword,preselect:!0}];if($e===3&&y.previous_token?.content.toLowerCase()==="extends")$e=1;else return;case"catch":if($e!==1)return;if(x)De();else{let st=y,et=i.document.offsetAt(h.end);for(x=y.content;(st=Ke[st.next_token_offset])&&st.offset<et;x+=st.content);if($t.test(x.replaceAll(".","")))for(let je of Object.values(er(i,x)?.property??{}))je.kind===Oe.SymbolKind.Class&&N.test(je.name)&&a.push(Lt(je))}return a;case"break":case"continue":case"goto":{if($e===1&&y.type!=="TK_WORD")return;g=i.searchScopedNode(n);let st=(g??i).labels,et,je=i.document.offsetAt(n);for(let We in st)if(N.test(We))for(let Dt of st[We]){if(!Dt.def)break;if((et=Dt.data)===-1||et<je&&(!(et=Ke[Ke[et].next_pair_pos]?.offset)||je<et)){a.push(Lt(Dt));break}}if(!g){for(let We in ye)for(let Dt in st=oe[We]?.labels)if(N.test(Dt))for(let Ht of st[Dt]){if(!Ht.def)break;if(Ht.data===-1){a.push(Lt(Ht));break}}}if($e===1||$e===2&&!ne)return a;if(ne)for(let We of a)We.insertText=`'${We.insertText}'`}}else if(!ne&&!y.ignore){let st=new Set,et=dt&&os(i,n,dt),je,We,Dt=x.substring(1).endsWith(x[0])?"":x[0],Ht=Dt?Ct=>({label:Ct,kind:je,insertText:`${Ct}${Dt}`}):Ct=>({label:Ct,kind:je,command:We});if(et){let Ct,Xe,nt,we,it,An=tr(i,i.getContext(et.pos))??[],O=Object.values(an),ue=[],Ae=[];for(it of An){if(Ct=it.node,Ae.includes(Ct))continue;switch(Ae.push(Ct),we=O.includes(Ct.uri),nt=et.index,Xe=Ct.name.toLowerCase(),je=Oe.CompletionItemKind.Value,We={title:"cursorRight",command:"cursorRight"},we&&(it.kind??et.kind)){case Oe.SymbolKind.Method:switch(Xe){case"deleteprop":case"getmethod":case"getownpropdesc":case"hasownprop":case"hasmethod":case"hasprop":{if(nt!==0||!it.parent)continue;let Se=Xe.endsWith("method")?Qe=>Qe!==Oe.SymbolKind.Method:void 0;for(let Qe of Object.values($r(i,it.parent,ue)))N.test(Qe.name)&&!Se?.(Qe.kind)&&Ne(Qe.name,Qe.kind===Oe.SymbolKind.Method?Oe.CompletionItemKind.Method:Oe.CompletionItemKind.Property);continue}case"bind":case"call":if(Ae.pop(),!it.parent||![Oe.SymbolKind.Function,Xe==="call"&&Oe.SymbolKind.Class].includes(it.parent.kind))break;{let Se=it.parent;An.push({node:Se,uri:Se.uri,kind:Se.kind});continue}}break;case Oe.SymbolKind.Function:switch(Xe){case"dynacall":if(nt!==0)continue;case"dllcall":if(nt===0){await fn();continue}nt++;case"comcall":if(nt>1&&nt%2===0)for(let Se of["cdecl"].concat(Du))Ne(Se,Oe.CompletionItemKind.TypeParameter)&&(u.commitCharacters=["*"]);continue;case"comobject":nt===0&&a.push(...(await Wu("GetProgID",[]))?.filter(Se=>N.test(Se)).map(Ht)??[]);continue;case"numget":if(nt===2||nt===1)nt=0;else continue;case"numput":if(nt%2===0)for(let Se of Du.filter(Qe=>!/str$/i.test(Qe)))Ne(Se,Oe.CompletionItemKind.TypeParameter);continue;case"hotkey":nt<2&&a.push(...cn.key.filter(Se=>N.test(Se.label)));continue;case"objbindmethod":case"hasmethod":case"objhasownprop":case"hasprop":if(nt===1){let Se=dt?.comma[0];if(!Se)continue;let Qe=Xe.endsWith("method")?yt=>yt!==Oe.SymbolKind.Method:void 0;for(let yt of Ti(i,i.find_token(dt.offset+1,!0),Se))for(let Ft of Object.values($r(i,yt,ue)))N.test(Ft.name)&&!Qe?.(Ft.kind)&&Ne(Ft.name,Ft.kind===Oe.SymbolKind.Method?Oe.CompletionItemKind.Method:Oe.CompletionItemKind.Property)}continue}}Ct.kind===Oe.SymbolKind.Class&&(et.kind===Oe.SymbolKind.Property?Ct=kn(oe[Ct.uri],Ct,"__item",!1):Ct=Wr(Ct));let Ge=Ct?.params?.[nt];if(Ge){if(we){if(Ge.name==="Keys"){je=Oe.CompletionItemKind.Text,We=void 0,Xe.includes("send")&&a.push(Ht("Blind")),a.push(...cn.key.filter(Se=>N.test(Se.label)));continue}if(Ge.name==="WinTitle"){a.push(...cn.option.ahk_criteria.filter(Se=>N.test(Se.label)));continue}}await Jt(Ge.type_annotations||[])}}}if(!a.length&&(c=y.previous_token)?.content===":="&&(c=c?.previous_token)?.type==="TK_WORD"){let Ct=tr(i,i.getContext(i.document.positionAt(c.offset)))??[];je=Oe.CompletionItemKind.Value,We={title:"cursorRight",command:"cursorRight"};for(let Xe of Ct)await Jt(Xe.node.type_annotations||[])}return!a.length&&St(),a;async function Jt(Ct){let Xe;for(let nt of Ct)if(!st.has(nt))switch(st.add(nt),nt){case qu:await qt(!0);break;case Iu:await fn();break;case za:await qt();break;case vi:je=Oe.CompletionItemKind.Text,We=void 0;break;default:if(typeof nt=="string"){/['"]/.test(nt[0])?nt.endsWith(nt[0])&&N.test(nt=nt.slice(1,-1))&&a.push(Ht(nt)):(Xe=ji(i,nt)?.node)?.type_annotations&&!st.has(Xe)&&Xe.kind===Oe.SymbolKind.TypeParameter&&(st.add(Xe),await Jt(Xe.type_annotations));break}nt.data===za&&(nt=nt.generic_types?.[0]?.[0]??"",typeof nt=="string"&&/^(['"])\w+(\|\w+)*\1$/.test(nt)&&await qt(!1,new RegExp(`[^.\\/]+$(?<!\\.(${nt.slice(1,-1)}))`,"i")));break}}}}}let Re="([".includes(W[h.end.character]||"\0"),Ce=bt.FormatOptions.brace_style===0?`
`:" ";if(de){if(!de.children&&(g??=i.searchScopedNode(n))?.kind===Oe.SymbolKind.Class){let H=g,ne=["__Init()","__Call(${1:Name}, ${2:Params})","__Delete()","__Enum(${1:NumberOfVars})","__Get(${1:Key}, ${2:Params})","__Item[$1]","__New($1)","__Set(${1:Key}, ${2:Params}, ${3:Value})"];if(a.push(...cn.snippet),y.topofline===1&&a.push(cn.keyword.static??{label:"static",kind:Oe.CompletionItemKind.Keyword},{label:"class",insertText:["class $1",`{
	$0
}`].join(Ce),kind:Oe.CompletionItemKind.Snippet,insertTextFormat:Oe.InsertTextFormat.Snippet}),i.tokens[y.next_token_offset]?.topofline===0)return y.topofline===1?(a.pop(),a):void 0;de.static??!1?ne.splice(0,1):H=H.prototype??{},y.topofline&&ne.forEach($e=>{let Bt=$e.replace(/[([].*$/,"");a.push({label:Bt,kind:Oe.CompletionItemKind.Snippet,insertTextFormat:Oe.InsertTextFormat.Snippet,insertText:$e+Ce+`{
	$0
}`})});for(let $e of Object.values($r(i,H)))Ne($e.name,$e.kind===Oe.SymbolKind.Method?Oe.CompletionItemKind.Method:Oe.CompletionItemKind.Property);return a}return}if(_===Oe.SymbolKind.Null)return;if(_===Oe.SymbolKind.Property||_===Oe.SymbolKind.Method){if(!y.symbol&&y.semantic?.type===6)return;let H={},ne=Ti(i,y,h.end),Ke=0,$e=ne.includes(sn),Bt=[],ke={};W[h.end.character]==="."&&(Re="([".includes(W[h.end.character+m.length+1])),$e?ne=[]:I=st=>ke[st]??st;for(let st of ne){if(st.kind===Oe.SymbolKind.Interface){let je=st.generic_types?.[0]?.map(Dt=>`'"`.includes(Dt[0])?Dt.slice(1,-1):Dt);if(!je?.length)continue;let We=await Wu("GetDispMember",je)??{};Object.entries(We).forEach(Dt=>N.test(Dt[0])&&Ne(Dt[0],Dt[1]===1?Oe.CompletionItemKind.Method:Oe.CompletionItemKind.Property));continue}let et=$r(i,st,Bt);for(let je=Bt.length;Ke<je;Ke++)ke[Bt[Ke].full]=`0000${Ke}`.slice(-4);for(let[je,We]of Object.entries(et))N.test(je)&&((k=H[je])?k.detail?.endsWith(We.full??"")||(k.detail="(...) "+(k.insertText=We.name),k.commitCharacters=k.command=k.documentation=void 0,k.sortText=k.labelDetails=void 0):a.push(H[je]=Lt(We)))}if(!$e&&(d!==1||m.length<3))return a;let dt=new Set([i.object,oe[an.ahk2]?.object,oe[an.ahk2_h]?.object]);dt.delete(void 0);for(let st in ye)dt.add(oe[st].object);for(let st in k=i.object.property){let et=k[st];et.length===1&&!et[0].full&&ft(et[0])&&delete k[st]}for(let st of dt)for(let et of Object.values(st))for(let[je,We]of Object.entries(et))if(N.test(je)){if(k=H[je]){if(k.detail?.endsWith(We[0].full??""))continue}else if(a.push(H[je]=k=Lt(We[0])),We.length===1)continue;k.detail="(...) "+k.label,k.insertText?.endsWith(")")&&We.some(Dt=>Dt.kind===Oe.SymbolKind.Property)&&(k.insertText=k.label,k.kind=Oe.CompletionItemKind.Property),k.commitCharacters=k.command=k.documentation=void 0}return a}if(a.push(...cn.snippet),g??=i.searchScopedNode(n),g?.children&&g.kind===Oe.SymbolKind.Property)return y.topofline!==1?void 0:[{label:"get",kind:Oe.CompletionItemKind.Function},{label:"set",kind:Oe.CompletionItemKind.Function}];let xe=bt.FormatOptions?.keyword_start_with_uppercase,R=xe?function(H){a.push(H=Object.assign({},H)),H.insertText=(H.insertText??H.label).replace(/(?<=^(loop\s)?)[a-z]/g,ne=>ne.toUpperCase())}:H=>a.push(H);if(le)for(let H of Object.values(cn.keyword)){if(H.label==="break")break;N.test(H.label)&&R(H)}else{let H=Oe.CompletionItemKind.Snippet,ne=Oe.InsertTextFormat.Snippet,Ke=bt.FormatOptions?.switch_case_alignment?"":"	",$e=dt=>dt,Bt=$e;xe&&($e=dt=>dt.replace(/\b[a-z](?=\w)/g,st=>st.toUpperCase())),bt.FormatOptions?.switch_case_alignment&&(Bt=dt=>dt.replace(/^\t/gm,""));for(let[dt,st]of[["switch",["switch ${1:[SwitchValue, CaseSense]}",Bt(`{
${Ke}case \${2:}:
	${Ke}\${3:}
${Ke}default:
	${Ke}$0
}`)]],["trycatch",["try",`{
	$1
}`,"catch ${2:Error} as ${3:e}",`{
	$0
}`]],["class",["class $1",`{
	$0
}`]]])a.push({label:dt,kind:H,insertTextFormat:ne,insertText:$e(st.join(Ce))});a.at(-3).detail=cn.keyword.switch?.detail;let ke={...cn.keyword};delete ke.switch;for(let dt in ke)N.test(dt)&&R(ke[dt])}!g&&(k=W.match(/^\s*(((([<>$~*!+#^]*?)(`?;|[a-z]\w+|[\x21-\x3A\x3C-\x7E]|[^\x00-\x7f]))|~?(`?;|[\x21-\x3A\x3C-\x7E]|[a-z]\w+|[^\x00-\x7f])\s*&\s*~?(`?;|[\x21-\x3A\x3C-\x7E]|[a-z]\w+|[^\x00-\x7f]))\s*(\s(up?)?)?)$/i))&&(a=a.concat(k[8]?{label:"Up",kind:Oe.CompletionItemKind.Keyword}:cn.key.filter(H=>!H.label.toLowerCase().includes("alttab"))));for(let H in Wt)N.test(H)&&(s[H]=Lt(Wt[H]));for(let H of Object.values(i.declaration))N.test(f=H.name.toUpperCase())&&!ft(H)&&(!s[f]||H.kind!==Oe.SymbolKind.Variable)&&(s[f]=Lt(H));let pt=Object.keys(ye).reverse();for(let H of new Set([i.d_uri,...pt.map(ne=>oe[ne]?.d_uri),...pt])){if(!(k=oe[H]))continue;let ne=k.d;l=k.fsPath,k=k.declaration;for(let Ke in k){let $e=k[Ke];N.test(Ke)&&(ne||!s[Ke]||s[Ke].kind===Oe.CompletionItemKind.Variable&&$e.kind!==Oe.SymbolKind.Variable)&&(s[Ke]=u=Lt($e))}}if(g&&(n=h.end,Object.entries(i.getScopeSymbols(g)).forEach(([H,ne])=>{N.test(H)&&(ne.def!==!1||!s[H]&&!ft(ne))&&(s[H]=Lt(ne))})),bt.AutoLibInclude){let st=function(et){let je=(et=et.replace(/(\s);/g,"$1`;")).toLowerCase(),We=[],Dt=i.scriptpath,Ht=0,Jt=-1;for(let we of H)if(++Ht,je.startsWith(we.toLowerCase())){let it=(0,Br.basename)(et);je.endsWith(".ahk")&&!H.slice(0,Ht-1).some(An=>(0,Ur.existsSync)(An+it))?We.push(`#Include <${(0,Br.relative)(we,et.slice(0,-4))}>`):Ht===1?We.push(`#Include %A_MyDocuments%\\AutoHotkey\\Lib\\${it}`):Ht===2?We.push(`#Include %A_AhkPath%\\..\\Lib\\${it}`):We.push(`#Include %A_ScriptDir%\\Lib\\${it}`)}i.includedir.forEach((we,it)=>{je.startsWith(we.toLowerCase()+"\\")?we.length>=Dt.length&&(Jt=it,Dt=we):Dt||(Jt=it)}),Jt===-1&&(Jt=$e),Dt[0]===je[0]&&We.push(`#Include ${(0,Br.relative)(Dt,et)}`);let Ct={line:i.document.lineCount,character:0},Xe=`#Include ${et}`,nt;return We.forEach(we=>we.length<Xe.length&&(Xe=we)),Xe=`
`+Xe,Jt!==-1?(nt=i.document.getText({start:{line:Jt,character:0},end:{line:Jt+1,character:0}}),Ct={line:Jt,character:nt.length}):n.line===Ct.line-1&&((Bt??=(ke=i.find_token(0))?.type.endsWith("COMMENT")&&!Ut(ke))?(Ct=i.document.positionAt(ke.offset+ke.length),Xe=`
`+Xe):(Ct.line=0,Xe=Xe.trimStart()+`
`)),[Oe.TextEdit.insert(Ct,Xe)]};var ct=st;let H=i.libdirs,ne={},Ke=0,$e=-1,Bt,ke,dt=i.workspaceFolder;dt=(dt?hn.parse(dt).fsPath:i.scriptdir).toLowerCase(),i.includedir.forEach((et,je)=>$e=je);for(let et in In)if(!ye[et]&&(l=In[et].fsPath)&&(bt.AutoLibInclude>1&&In[et].islib||bt.AutoLibInclude&1&&l.toLowerCase().startsWith(dt))){for(let je of In[et])N.test(f=je.name)&&(s[f.toUpperCase()]??=(u=Lt(je),Ke++,u.additionalTextEdits=ne[l]??=st(l),u.detail=`${zi.include(l)}

${u.detail??""}`,u));if(Ke>300)break}}if(pt.unshift(i.uri),!pt.includes(an.winapi)&&pt.some(H=>oe[H]?.include[an.winapi]))for(let H in k=oe[an.winapi]?.declaration)N.test(H)&&(s[H]??=Lt(k[H]));if(!le&&_!==Oe.SymbolKind.Event&&(d===1&&x.length>2&&x.includes("_")||/[A-Z]{2,}/.test(x)))for(let H of cn.constant)N.test(H.label)&&a.push(H);return a.concat(Object.values(s));function Ut(H){if(H.symbol)return H.symbol;let ne,Ke=i.tokens[H.next_token_offset];if(Ke&&((ne=Ke.symbol)?.detail??(ne=i.tokens[Ke.next_token_offset]?.symbol)?.detail)!==void 0)return ne}function De(){let H,ne=[Wt,i.declaration];for(let Ke in ye)(H=oe[Ke])&&ne.push(H.declaration);for(let Ke of ne)for(let $e in Ke)(H=Ke[$e]).kind===Oe.SymbolKind.Class&&N.test($e)&&(s[$e]??=a.push(Lt(H)))}async function qt(H=!1,ne){V??=i.document.offsetAt(n);let Ke=y.content.substring(1,V-y.offset),$e="";if(/[*?"<>|\t]/.test(Ke))return;/^\w:[\\/]/.test(Ke)||(Ke=`${i.scriptdir}/${Ke}`),Ke=Ke.replace(/`(.)/g,"$1").replace(/[^\\/]+$/,je=>($e=je,""));try{if(!(0,Ur.existsSync)(Ke)||!(0,Ur.statSync)(Ke).isDirectory())return}catch{return}let Bt=Ke.endsWith("/")?"/":"\\",ke=Po($e),dt={title:"Trigger Suggest",command:"editor.action.triggerSuggest"},st=$t.test($e)?void 0:{start:{line:n.line,character:n.character-$e.length},end:n},et=st?(je,We)=>je.textEdit={newText:We,range:st}:(je,We)=>je.insertText=We;try{for await(let je of await(0,Ya.opendir)(Ke)){let We=je.name;if(ke.test(We)){if(je.isDirectory())We=We.replace(/(`|(?<= );)/g,"`$1"),et(u={label:We,command:dt,kind:Oe.CompletionItemKind.Folder},We+Bt);else{if(H||ne?.test(We))continue;We=We.replace(/(`|(?<= );)/g,"`$1"),u={label:We,kind:Oe.CompletionItemKind.File},st&&(u.textEdit={range:st,newText:We})}a.push(u)}}}catch{}}async function fn(){V??=i.document.offsetAt(n);let H=y.content.substring(1,V-y.offset),ne="",Ke,$e=[i],Bt={};for(let je in ye)(Ke=oe[je])&&$e.push(Ke);H=H.replace(/`(.)/g,"$1").replace(/[^\\/]+$/,je=>(ne=je,""));let ke=Po(ne),dt=Oe.CompletionItemKind.Function,st=$t.test(ne)?void 0:{start:{line:n.line,character:n.character-ne.length},end:n},et=je=>(je=je.replace(/(`|(?<= );)/g,"`$1"),u={label:je,kind:Oe.CompletionItemKind.File},st?u.textEdit={range:st,newText:`${je}\\`}:u.insertText=`${je}\\`,u);if(H){if(await qt(!1,/[^.\\/]+$(?<!\.(dll|ocx|cpl))/i),H.endsWith("/")||H.endsWith(":\\"))return;let je=new Set,We=H.slice(0,-1).replaceAll("\\","/").toLowerCase(),Dt=!0;/\.\w+$/.test(We)||(We+=".dll"),We.includes(":")?je.add(We):We.includes("/")?je.add(i.scriptpath+(We.startsWith("/")?We:`/${We}`)):(We=`/${We}`,$e.forEach(Ht=>Ht.dllpaths.forEach(Jt=>{(Jt=Jt.toLowerCase()).endsWith(We)&&(je.add(Jt),Dt=!1)})),Dt&&(je.add(We.substring(1)),$e.forEach(Ht=>je.add(Ht.scriptpath+We))));for(let Ht of await Ni.get_DllExport(je,!0))ke.test(Ht)&&a.push({label:Ht,kind:dt})}else{$e.forEach(je=>je.dllpaths.forEach(We=>ke.test(We=We.replace(/^.*[\\/]/,""))&&(Bt[We.toUpperCase()]??=a.push(et(We.replace(/\.dll$/i,""))))));try{let je;for await(let We of await(0,Ya.opendir)("C:\\Windows\\System32"))/\.(dll|ocx|cpl)$/i.test(je=We.name)&&ke.test(je)&&(Bt[je.toUpperCase()]??=a.push(et(je.replace(/\.dll$/i,""))))}catch{}for(let je of ec)ke.test(je)&&a.push({label:je,kind:dt})}}function St(){for(let H of cn.text)N.test(H.label)&&(s[H.label.toUpperCase()]=!0,a.push(H));for(let H in k=i.texts)N.test(H)&&Ne(k[H],Oe.CompletionItemKind.Text);for(let H in ye)for(let ne in k=oe[H]?.texts)N.test(ne)&&Ne(k[ne],Oe.CompletionItemKind.Text)}function Ne(H,ne){return s[f=H.toUpperCase()]?!1:(a.push(u={label:H,kind:ne}),s[f]=!0)}function ft(H){return H.selectionRange.end.line===pe&&Ve===H.selectionRange.end.character}function wt(H,ne){let Ke=ne?.full;Ke&&(H.sortText=I(Ke),H.labelDetails={description:Ke})}function Lt(H){let ne=Oe.CompletionItem.create(H.name);switch(H.kind){case Oe.SymbolKind.Method:wt(ne,H.parent);case Oe.SymbolKind.Function:ne.kind=H.kind===Oe.SymbolKind.Method?Oe.CompletionItemKind.Method:Oe.CompletionItemKind.Function,bt.CompleteFunctionParens?Re?ne.command={title:"cursorRight",command:"cursorRight"}:H.params.length?(ne.command={title:"Trigger Parameter Hints",command:"editor.action.triggerParameterHints"},ne.insertText=ne.label+"($0)",ne.insertTextFormat=Oe.InsertTextFormat.Snippet):ne.insertText=ne.label+"()":ne.commitCharacters=G.Function,ne.detail=H.full;break;case Oe.SymbolKind.Variable:if(ne.kind=Oe.CompletionItemKind.Variable,!H.range.end.character)return ne.detail=H.detail,ne;break;case Oe.SymbolKind.Class:ne.kind=Oe.CompletionItemKind.Class,ne.commitCharacters=G.Class,ne.detail="class "+(H.full||ne.label);break;case Oe.SymbolKind.Event:return ne.kind=Oe.CompletionItemKind.Event,ne;case Oe.SymbolKind.Field:return ne.kind=Oe.CompletionItemKind.Field,ne.label=ne.insertText=ne.label.slice(0,-1),ne;case Oe.SymbolKind.Property:{ne.kind=Oe.CompletionItemKind.Property,ne.detail=H.full||ne.label,wt(ne,H.parent);let $e=H;!$e.call&&$e.get?.params.length&&(ne.insertTextFormat=Oe.InsertTextFormat.Snippet,ne.insertText=ne.label+"[$0]");break}case Oe.SymbolKind.Module:ne.kind=Oe.CompletionItemKind.Module;break;default:return ne.kind=Oe.CompletionItemKind.Text,ne}H.tags&&(ne.tags=H.tags);let Ke=Vr(H,i);return Ke&&(ne.documentation=Ke),ne}}var Cr=zn(si());async function l_(e,t){if(t.isCancellationRequested)return;let n=e.textDocument.uri.toLowerCase(),r=oe[n],i=r?.getContext(e.position),s=[];if(!i)return;if(!i.token.type){let u=i.token.previous_token;if(u?.content.match(/^#include/i)){let f=e.position.line,l=i.linetext.indexOf("#"),c=u.data,g=c?.data;if(g){l+=c.offset-u.offset;let k=Cr.Range.create(0,0,oe[g[1]]?.document.lineCount??0,0),d=l+c.content.length,w=g[0]?hn.file(li(g[0].replaceAll("`;",";"))).toString():g[1];return[Cr.LocationLink.create(w,k,k,Cr.Range.create(f,l,f,d))]}}return}if(i.kind===Cr.SymbolKind.Null)return;let a=[];return tr(r,i)?.forEach(u=>{!a.includes(u.node)&&a.push(u.node)&&u.node.selectionRange.end.character&&(n=u.node.uri??u.uri)&&s.push(Cr.LocationLink.create(oe[n].document.uri,u.node.range,u.node.selectionRange))}),s}var tc=zn(si());async function u_(e){let t=oe[e.textDocument.uri.toLowerCase()],n=tc.Range.create(0,0,t.document.lineCount,0),r={...bt.FormatOptions};r.indent_string??=e.options.insertSpaces?" ".repeat(e.options.tabSize):"	";let i=t.beautify(r);return[{range:n,newText:i}]}async function f_(e){let t=oe[e.textDocument.uri.toLowerCase()],n=e.range,r={...bt.FormatOptions};r.indent_string=e.options.insertSpaces?" ".repeat(e.options.tabSize):"	";let i=t.beautify(r,n).trim();return[{range:n,newText:i}]}async function d_(e){let t=oe[e.textDocument.uri.toLowerCase()],{ch:n,position:r}=e,i={...bt.FormatOptions},s,a,u,f;if(i.indent_string=" ".repeat(e.options.tabSize),a=t.document.getText({start:{line:0,character:0},end:{line:0,character:1}}),(a==="	"||!e.options.insertSpaces&&a!==" ")&&(i.indent_string="	"),n===`
`){let{line:c,character:g}=r,k=t.document.getText({start:{line:c-1,character:0},end:{line:c+2,character:0}}).split(/\r?\n/),d=k[0].trimEnd(),w;if(k[1].trim()||(g=k[1].length),d.endsWith("{")){let I=i.indent_string;(f=l({line:c-1,character:d.length}))&&(w=i.indent_string,k[1].substring(0,g)!==w&&f.push({newText:w,range:{start:{line:c,character:0},end:{line:c,character:g}}}),(d=(k[2]??="").trimStart()).startsWith("}")&&!k[2].startsWith((w=w.replace(I,""))+"}")&&f.push({newText:w,range:{start:{line:c+1,character:0},end:{line:c+1,character:k[2].length-d.length}}}))}else if((u=t.linepos[c-1])!==void 0){let I={start:t.document.positionAt(u),end:{line:c-1,character:d.length}},G=t.beautify(i,I).trim();f=[{range:I,newText:G}],w=i.indent_string,k[1].substring(0,g)!==w&&f.push({newText:w,range:{start:{line:c,character:0},end:{line:c,character:g}}})}else if(!d&&k[0]!==(k[1]=k[1].substring(0,g))){if(!k[0]){if(s=t.find_token(t.document.offsetAt(r)),s.type==="TK_STRING"||s.type.endsWith("COMMENT"))return;let I=["TK_START_EXPR","TK_START_BLOCK",""];for(;(s=s.previous_token)&&!I.includes(s.type););if(I.pop(),I.includes(s?.type))return}f=[{newText:k[0],range:{start:{line:c,character:0},end:{line:c,character:g}}}]}return f}else{if(n==="}")return l(r);if(a=Yo[n]){let c={line:r.line,character:r.character-1};if(s=t.find_token(t.document.offsetAt(c)),s.type==="TK_WORD")return s.length>1&&(a=s.content.replace(/./g,g=>Yo[g]??g),c=t.document.positionAt(s.offset),r.character=c.character+s.length),[tc.TextEdit.replace({start:c,end:r},a)]}}function l(c){if(s=t.tokens[t.document.offsetAt({line:c.line,character:c.character-1})],u=s?.previous_pair_pos,u!==void 0){for(;(s=t.tokens[u])?.previous_pair_pos!==void 0;)u=s.previous_pair_pos;let g={start:t.document.positionAt(u),end:c},k=t.beautify(i,g).trim();return[{range:g,newText:k}]}}}var cs=zn(si());async function p_(e,t){if(t.isCancellationRequested)return;let n=e.textDocument.uri.toLowerCase(),r=oe[n],i=r?.getContext(e.position),s=[],a;if(!i)return;if(i.kind===cs.SymbolKind.Null)return i.token.semantic?.type!==5&&(a=i.token,a=So[(a.hover_word||a.content).toLowerCase()])?a[1]:void 0;let u=tr(r,i);if(!u?.length)return;let f=[];if(u=u.filter(l=>!f.includes(l.node)&&f.push(l.node)),u.length>1)for(a of u)(a=a.node.full)&&s.push({kind:"ahk2",value:a});else{let{node:l,is_global:c,uri:g}=u[0],k=l;if(l.kind===cs.SymbolKind.Class&&!k.full?.startsWith("("))s.push({kind:"ahk2",value:"class "+(k.full||l.name)});else if(k.full){s.push({kind:"ahk2",value:k.full});let w=k.overloads;switch(typeof w){case"object":w=w.map(I=>I.full).join(`
`);case"string":k.name&&(w=w.replace(/^(\w|[^\x00-\x7f])+/gm,k.full.substring(0,k.full.search(/(?!^)[([]/)))),s.at(-1).value+=`
${w}`;break}}let d=Vr(l,oe[g]);typeof d=="string"?d=d&&"```plaintext\n"+d+"\n```":d=d.value,l.is_param?d.startsWith("*@param* ")?d=d.replace(/\n|(?<=`\*?) — /,`
___
`):d=`*@param* \`${l.name}\`${(a=ai(l.type_annotations))&&`: *\`${a}\`*`}
___
${d}`:l.kind===cs.SymbolKind.Variable?d=`${c===!0?"*@global*":l.static?"*@static*":"*@local*"} \`${l.name}\`${(a=ai(l.type_annotations))&&`: *\`${a}\`*`}
___
${d}`:l.kind===cs.SymbolKind.Property&&s.length&&(a=ai(l.type_annotations))&&(s[0].value+=`: ${a}`),d&&s.push({value:(s.length?`___
`:"")+d})}return{contents:{kind:"markdown",value:s.map(l=>l.kind==="ahk2"?"```ahk2\n"+l.value+"\n```":l.value).join(`

`)}}}var tn=zn(si());async function h_(e,t){let n=[],r=oe[e.textDocument.uri.toLowerCase()];if(!r||t.isCancellationRequested)return;let i=Vu(r,r.getContext(e.position));for(let s in i)n.push(...i[s].map(a=>({uri:s,range:a})));return n}function Vu(e,t,n=!0){if(t.kind===tn.SymbolKind.Null)return;let r=tr(e,t);if(r?.length!==1)return;let i=t.text.toUpperCase(),s={},{node:a,uri:u,scope:f,is_this:l,is_global:c}=r[0];if(!(!u||!a.selectionRange.end.character||l===!1)){if(!n&&(a===Wt[i]||u===an.winapi))return null;if(l){let g=a,k=[],d=g.property;for(let w of Object.values(d??{}))w.children?.length&&ls(w,i,k,!1,!1);return k.length?{[oe[u].document.uri]:k}:void 0}switch(a.kind){case tn.SymbolKind.Field:if(f){let g=f.labels;g&&g[i]&&(s[oe[u].document.uri]=g[i].map(k=>k.selectionRange))}else{let g=e.labels;g[i]&&(s[e.document.uri]=g[i].map(k=>k.selectionRange));for(let k in e.relevance)g=oe[k].labels,g[i]&&(s[oe[k].document.uri]=g[i].map(d=>d.selectionRange))}break;case tn.SymbolKind.Function:case tn.SymbolKind.Variable:case tn.SymbolKind.Class:if(a.kind!==tn.SymbolKind.Class||!a.full.includes(".")){let g=c===!0?void 0:r[0].parent,k={[e.uri]:g};if(u!==e.uri&&(k[u]=void 0),!g)for(let d in e.relevance)k[d]=void 0;for(let d in k){let w=nc(k[d]??oe[d],i,tn.SymbolKind.Variable);w.length&&(s[oe[d].document.uri]=w)}break}default:if(a.kind===tn.SymbolKind.Class||a.static){if(a.kind===tn.SymbolKind.Class)i=a.full.toUpperCase();else{let x=a,m=x.full?.match(/^\(([^)]+)\)[ \t]static[ \t]([^([]+)($|[([])/);if(m)i=`${m[1]}.${m[2]}`.toUpperCase();else if(x.parent?.kind===tn.SymbolKind.Class)i=`${x.parent.full}.${x.name}`.toUpperCase();else return}let g=i.split("."),k=g.length,d=0,w={};for(let x of new Set([e.uri,...Object.keys(e.relevance)]))w[oe[x].document.uri]=nc(oe[x],g[0],tn.SymbolKind.Variable);for(;d<k;){let x=g.slice(0,++d).join("."),m=ji(e,x);if(m?.node.kind===tn.SymbolKind.Class)for(let y of Object.values(m.node.property??{})){let h=[];if(y.children?.length&&h.push(y),y.kind===tn.SymbolKind.Property){let _=y;h.push(...[_.get,_.set,_.call].filter(Boolean))}if(!h.length)continue;let W=w[oe[m.uri].document.uri]??=[];for(let _ of h)ls(_,"THIS",W,!1,!1)}for(let y in w){let h=w[y],W=oe[y.toLowerCase()],_=s[y]??=[],de=W.document,ye=W.tokens;e:for(let pe of h){let Ve=ye[de.offsetAt(pe.start)];if(Ve){for(let le=d;le<k;le++)if((Ve=ye[Ve.next_token_offset])?.type!=="TK_DOT"||(Ve=ye[Ve.next_token_offset])?.type!=="TK_WORD"||Ve.content.toUpperCase()!==g[le])continue e;_.push({start:de.positionAt(Ve.offset),end:de.positionAt(Ve.offset+Ve.length)})}}s[y].length||delete s[y]}w={}}let I=a.parent,G=s[oe[u].document.uri]??=[];for(;I&&I.kind!==tn.SymbolKind.Class;)I=I.parent;if(I){let x=a.name.toLowerCase(),m=[];for(let y of I.children??[])y.static&&y.name.toLowerCase()===x&&m.push(y.selectionRange);G.unshift(...m)}else G.includes(a.selectionRange)||G.unshift(a.selectionRange);break}return}if(Object.keys(s).length){for(let g in s){let k={};for(let d of s[g])k[`${d.start.line},${d.start.character}`]??=d;s[g]=Object.values(k)}return s}}}function nc(e,t,n,r=[]){if(!(n===tn.SymbolKind.Method||n===tn.SymbolKind.Property)){let i=e,s=!e.kind,a=!i?.local?.[t]?.static,u=s;if(a&&!s&&i.declaration?.[t]?.static===null&&(a=!1),u)u=!1;else{let f=i.local,l=i.declaration;f?.[t]||l?.[t]||(u=void 0)}for(let f of i.children??[])f.name.toUpperCase()===t&&r.push(f.selectionRange),f.children?.length&&ls(f,t,r,s,s||f.kind===tn.SymbolKind.Function?u:void 0,a);if(i.kind===tn.SymbolKind.Property){let f=i;for(let l of[f.get,f.set,f.call])l?.children?.length&&nc(l,t,n,r)}}return r}function ls(e,t,n,r,i,s=!0){let a=e.kind===tn.SymbolKind.Function&&e.static,u=a||e.closure,f,l=i;if(a&&s&&!r)return;if(r&&e.has_this_param&&["THIS","SUPER"].includes(t))i=l=!1;else if(e.assume===2||e.global?.[t]){if(!r)return;i=l=!0}else if(e.local?.[t]||(!u||r&&!i)&&e.declaration?.[t]){if(!r)return;i=l=!1}else r&&!i&&(a&&(!(f=e.declaration?.[t])||f.kind===tn.SymbolKind.Variable&&!f.def)||e.unresolved_vars?.[t]||t.substring(0,2)==="A_")&&(l=!0);s&&(s=!e?.local?.[t]?.static),l===r?e.children?.forEach(g=>{g.name.toUpperCase()===t&&g.kind!==tn.SymbolKind.Property&&g.kind!==tn.SymbolKind.Method&&g.kind!==tn.SymbolKind.Class&&n.push(g.selectionRange),g.children?.length&&ls(g,t,n,r,g.kind===tn.SymbolKind.Function?i:r||void 0,s),g.kind===tn.SymbolKind.Property&&c(g)}):e.children?.forEach(g=>{g.children?.length&&ls(g,t,n,r,r?!1:void 0,s),g.kind===tn.SymbolKind.Property&&c(g)});function c(g){for(let k of[g.get,g.set,g.call])k?.children?.length&&nc(k,t,tn.SymbolKind.Variable,n)}}var g_=zn(dr());var ic;async function m_(e,t){let n=oe[e.textDocument.uri.toLowerCase()];if(!n||t.isCancellationRequested)return;let r=n.getContext(e.position);return(ic=Vu(n,r,!1))?{range:r.range,placeholder:r.text.split(".").pop()||""}:new g_.ResponseError(0,ic===null?Su.cannotrenamestdlib():Su.cannotrename())}async function __(e,t){if(t.isCancellationRequested)return;let n={changes:{}},r=e.newName;for(let i in ic)n.changes[i]=ic[i].map(s=>({range:s,newText:r}));return n}var ui=zn(si());var Xt,Wi=new Map;function b_(e,t){let n=e.semantic,r;if(n){let i=e.pos??(e.pos=t.document.positionAt(e.offset)),s=n.type;if(s===8)if(e.ignore){let a=i.line+1,u=e.data;for(let f=0;f<u.length;f++)t.STB.push(a++,0,u[f],s,0)}else t.STB.push(i.line,i.character,e.length,s,0);else(Xt&&(s===2||s===6)&&e.previous_token?.type==="TK_DOT"||(Xt=void 0,s===0))&&(s=Ek(e,t)),t.STB.push(i.line,i.character,e.length,s,(n.modifier??0)|e.definition?.static===!0)}else if(Xt&&e.type!=="TK_DOT"&&!e.type.endsWith("COMMENT"))Xt=void 0;else if(e.type==="TK_WORD"&&["THIS","SUPER"].includes(r=e.content.toUpperCase())&&e.previous_token?.type!=="TK_DOT"){let i=t.findSymbol(r,ui.SymbolKind.Variable,t.document.positionAt(e.offset));i?.is_this!==void 0&&(Xt=i.node)}}function Eo(e,t){let n=oe[e.textDocument.uri.toLowerCase()];return!n||t?.isCancellationRequested?{data:[]}:(n.STB.previousResult(""),Xt=void 0,Wi.clear(),Tr({textDocument:e.textDocument},null),Object.values(n.tokens).forEach(r=>b_(r,n)),k_(n),Wi.clear(),n.sendDiagnostics(),n.STB.build())}function y_(e,t){let n=oe[e.textDocument.uri.toLowerCase()];if(!n||t?.isCancellationRequested)return{data:[]};let r=n.document.offsetAt(e.range.start),i=n.document.offsetAt(e.range.end);n.STB.previousResult(""),Xt=void 0,Wi.clear(),Tr({textDocument:e.textDocument},null);for(let s of Object.values(n.tokens))if(!(s.offset<r)){if(s.offset>i)break;b_(s,n)}return k_(n),Wi.clear(),n.STB.build()}function Ek(e,t){let n=e.content.toUpperCase(),r=e.semantic;switch(r.type){case 0:return Xt=Uu[n],Xt?.kind!==ui.SymbolKind.Class&&(Xt=void 0),0;case 2:case 6:if(Xt&&!e.ignore){let s=Xt.property[n],a=s?.kind,u;if(!s||s.def===!1){let f=(u=Wi.get(Xt)??(Wi.set(Xt,u=$r(t,Xt)),u))[n];f?(s=f,a=f.kind):r.type===2?u.__CALL&&(a=ui.SymbolKind.Null):u.__GET&&(a=ui.SymbolKind.Null)}switch(a){case ui.SymbolKind.Method:if(r.modifier=(r.modifier??0)|2|1,e.callsite){if(Xt){if(s.full?.startsWith("(Object) static Call("))s=kn(t,Xt.prototype,"__new",!0)??s;else if(s.full?.startsWith("(Object) DefineProp(")){let f=t.tokens[e.next_token_offset];f?.content==="("&&(f=t.tokens[f.next_token_offset]),f&&(f.type==="TK_STRING"?i(Xt,f.content.slice(1,-1),f.offset+1):i(Xt,""))}}rc(t,s,e.callsite)}return Xt=void 0,r.type=2;case ui.SymbolKind.Class:return r.modifier=(r.modifier??0)|2,Xt=Xt.property[n],e.callsite&&rc(t,Xt,e.callsite),r.type=0;case ui.SymbolKind.Property:{let f=s;return r.modifier=(r.modifier??0)|(s.static?1:0)|(!f.set&&f.children?2:0),Xt=Xt.range===s.range?Xt.prototype:void 0,r.type=6}case void 0:if((Xt.checkmember??t.checkmember)!==!1&&bt.Diagnostics.ClassNonDynamicMemberCheck){let f=t.tokens[e.next_token_offset];vo.includes(f?.content)?i(Xt,e.content,e.offset):(e.__ref||f?.content[0]!=="?"||!f.ignore&&f.content==="?")&&Wi.get(Xt)?.["#checkmember"]!==!1&&(((Xt.undefined??={})[n]??=e).has_warned||=e.__ref)}}}default:return Xt=void 0,r.type}function i(s,a,u){let f=oe[s.uri];if(f&&u){if(s.property[a.toUpperCase()])return;let l=ui.Range.create(f.document.positionAt(u),f.document.positionAt(u+a.length)),c=ui.DocumentSymbol.create(a,void 0,ui.SymbolKind.Property,l,l);if(c.static=c.def=!0,a=a.toUpperCase(),f===t&&f.d<2)s.children?.push(c),s.property[a]??=c;else{let g=Wi.get(s);g&&(g[a]??=c)}s.undefined&&delete s.undefined[a]}else if(delete s.undefined,f&&f.d<2)s.checkmember=!1;else{let l=Wi.get(s);l&&(l["#checkmember"]=!1)}}}function k_(e){for(let t of Wi.keys()){if(!t.undefined)continue;let n=t.name;for(let r of Object.values(t.undefined))r.has_warned||(r.has_warned=!0,e.addDiagnostic(ee.maybehavenotmember(n,r.content),r.offset,r.length,{severity:2}))}}var fi=zn(si());var ir={};async function v_(e,t){if(t.isCancellationRequested)return;let{textDocument:{uri:n},context:r,position:i}=e,s=oe[n.toLowerCase()],a=r?.activeSignatureHelp?.activeSignature,u,f;switch(r?.triggerKind){case 2:if(r.isRetrigger){if(r.triggerCharacter===" "||!(f=s.tokens[u=s.document.offsetAt(i)-1]?.paraminfo))return y()}else{if(u=s.document.offsetAt(i),r.triggerCharacter===" "){let W=s.find_token(u);W.offset>=u&&(f=W.previous_token?.callsite)&&(f=f.range.start.line===i.line&&f.paraminfo)}else f=s.tokens[u-1]?.paraminfo;if(!f)return}break}let l=os(s,i,f);if(!l||l.index<0){l===null&&(ir.loc="");return}let{name:c,pos:g,index:k,kind:d,count:w}=l,I=`${s.uri}?${c},${g.line},${g.character}`;if(I===ir.loc){if(k===ir.index)return y();ir.index=k}else ir={loc:I,index:k};let G=ir.nodes,x=new Set,m={activeSignature:a,signatures:[]};if(!G){let ye=function(pe,Ve,le=0){let N,V=pe.uri;switch(pe.kind){case fi.SymbolKind.Method:if(!_)break;if(le++,Ve==="call"){G.push({node:pe,needthis:le,uri:V});break}N=pe,Re();break;case fi.SymbolKind.Function:if(!_)break;if(Ve==="call"){G.push({node:pe,needthis:le,uri:V});break}N=pe;default:Re();break}function Re(){let Ce,xe=pe;if(Ce=kn(s,xe,Ve,_)){if(_){if(Ce.kind===fi.SymbolKind.Class)Ce=Wr(Ce);else if(Ce.full?.startsWith("(Object) static Call("))Ce=kn(s,xe.prototype,"__new",!0)??Ce;else if(Ce.kind===fi.SymbolKind.Property||Ce.eval){let R=On(Ce,oe[Ce.uri]??s,xe);return Ce.kind===fi.SymbolKind.Property&&Ce.eval&&(R=Ki(s,R,"call",!0)),R.forEach(pt=>ye(pt,"call",-1))}else if(N&&Ve==="bind"){if(x.has(N))return;x.add(N);let R=N.full.indexOf("(",N.name?1:0);N={...N,name:Ce.name,detail:Ce.markdown_detail===void 0?Ce.detail:void 0,full:`(Func) Bind${N.full.slice(R,R+N.param_def_len)} => BoundFunc`,markdown_detail:Ce.markdown_detail},Ce=N}}else if(Ce.kind===fi.SymbolKind.Class)Ce=kn(s,Ce,"__item",!1);else{if(Ce.kind!==fi.SymbolKind.Property)return;if(!Ce.params){for(let R of On(Ce,oe[Ce.uri]??s,xe))(R=kn(s,R,"__item",!1))&&G.push({node:R,needthis:le,uri:R.uri});return}}Ce&&G.push({node:Ce,needthis:le,uri:Ce.uri})}}};var h=ye;let W=s.getContext(g),_=!0;if(ir.nodes=G=[],W.kind===fi.SymbolKind.Null||W.token.symbol)return;let de=Ti(s,W.token,W.range.end);if(de.includes(sn)){if(d!==fi.SymbolKind.Method)return;let pe=c.toUpperCase();G=[];for(let Ve of new Set([an.ahk2,an.ahk2_h,s.uri,...Object.keys(s.relevance)]))for(let le of oe[Ve]?.object.method[pe]??[])G.push({node:le,uri:Ve})}else{let pe=W.text?"":W.word.toLowerCase();d===fi.SymbolKind.Property?(pe||="__item",_=!1):pe||="call";for(let Ve of de)ye(Ve,pe)}}for(let W of G){let _=W.node,de=oe[W.uri],ye=W.needthis??0;if(!_.params||x.has(_))continue;let pe=[_],Ve=k-ye,le=[],N=_.name&&_.full.match(/^(\(.+?\))?[^([]+/)?.[0].length||0,V,Re,Ce,xe,R,pt,Ut=Vr(_,de,/(^|\n)\*@param\*(.|\n|\r)*?(?=\n\*@|$)/g);if(_.overloads)if(typeof _.overloads=="string"){let De=new Un(Gn.create("","ahk2",-10,_.kind===fi.SymbolKind.Function?_.overloads:`class _ {
${_.overloads}
}`),void 0,-1);De.parseScript(),R=_.name||"_";let qt=_.kind===fi.SymbolKind.Function?De.children:De.declaration._?.children??[],fn=_.full.match(/^(\(.+?\))?[^([]+/)?.[0]??R;for(let St of qt)St.name!==R||!St.params||(St.full=fn+St.full.replace(/^(\(.+?\))?[^([]+/,""),pe.push(St));_.overloads=pe.slice(1)}else pe.push(..._.overloads);N+=ye>0?7:1,x.add(_);for(let De of pe){if(R=De.full,V=De.params,xe=V.length,Ce=De.variadic&&V[xe-1].arr?Math.min(Ve,xe-1):Ve,pt=V[Ce]?.name.toUpperCase()??(ye&&Ce===-1?"this":"\0"),Re=_.params.find(qt=>qt.name.toUpperCase()===pt)??_.overload_params?.[pt],le=De.param_offsets.map((qt,fn)=>({label:[qt+=N,qt+(V[fn]?.name.length||1)]})),ye>0&&(le.unshift({label:"this"}),Ce++,R=R.replace(/(?<=.)\(/,"(this"+(V.length?", ":""))),Re){if(Re.arr===2){let qt=Ve%2!==Re.data,fn=xe%2!==Re.data,St=fn?2:1;(!qt||++Ce&&fn)&&k>=w-St&&(k===w-1||Ce-St!==xe-2)&&(Ce-=St),Re=V[Ce]??Re}else if(k<w-1&&V.at(-1)?.arr===2){let qt=V.at(-1),fn=xe%2!==qt.data,St=fn?2:1;k<w-St&&!V[Ce+St]?.name.length&&(Re=V[Ce+=St]??qt)}le[Ce].documentation=Vr(Re,de)}m.signatures.push({label:R,parameters:le,documentation:Ut,activeParameter:Ce})}}return ir.signinfo=m;function y(){let W=ir.signinfo;return W&&(W.activeSignature=a),W}}var Tt=zn(si());var Uu={};function Tr(e,t){let n=e.textDocument.uri.toLowerCase(),r=oe[n];if(!r||t?.isCancellationRequested)return[];if(t!==null&&r.symbolInformation)return r.symbolInformation;let{document:i,tokens:s}=r,a=Uu={...Wt},u=[n,...Object.keys(r.relevance)],f={};u=u.map(x=>oe[x]?.d_uri).concat(u);for(let x of u){let m=oe[x];if(!m)continue;let y=m.d,h=m.declaration,W;for(let _ in h)!(W=a[_])||y||h[_].kind!==Tt.SymbolKind.Variable&&(W.kind===Tt.SymbolKind.Variable||W.def===!1)?a[_]=h[_]:W.kind===Tt.SymbolKind.Variable&&(W.assigned||=h[_].assigned,h[_].def)&&(W.def??=!1)}if(r.symbolInformation)return r.symbolInformation;an.winapi&&!u.includes(an.winapi)&&(f=oe[an.winapi]?.declaration??f);let l=bt.Warn?.LocalSameAsGlobal,c=[],g=new Map,k=[Tt.SymbolKind.Method,Tt.SymbolKind.Property,Tt.SymbolKind.Class];for(let[x,m]of Object.entries(r.declaration)){let y=a[x],h=!1;y.kind===Tt.SymbolKind.Variable&&!y.assigned&&(f[x]?(y=a[x]=f[x],h=!0):m.returns===void 0&&g.set(y,m)),(y===m||m.kind!==Tt.SymbolKind.Variable&&(a[x]=m))&&(c.push(m),G(m,m,h||m===Wt[x]).definition=m)}if(w(r),bt.Warn?.VarUnset)for(let[x,m]of g){if(x.assigned||x.has_warned)continue;x.has_warned=!0;let y,h,W=Gi.varisunset(m.name);!x.decl&&(h=Kr[x.name.toUpperCase()])&&(W+=`, ${ee.requireversion(h)}`,y="built-in library"),r.diagnostics.push({code:y,message:W,range:m.selectionRange,severity:Tt.DiagnosticSeverity.Warning})}return r.actived&&(I(r),r.sendDiagnostics(!1,!0)),n=r.document.uri,r.symbolInformation=c.map(x=>Tt.SymbolInformation.create(x.name,x.kind,x.range,n));function d(x,m){!(x.assigned||=m.assigned)&&m.returns===void 0&&(g.has(x)||g.set(x,m))}function w(x,m={},y=!1){let h=[],W=x.kind===Tt.SymbolKind.Class,_;x.children?.forEach(de=>{if(de.children&&h.push(de),!de.name)return;let ye=de.kind;if(ye===Tt.SymbolKind.Variable||ye===Tt.SymbolKind.Function||!W&&ye===Tt.SymbolKind.Class){let pe=de.name.toUpperCase(),Ve=m[pe]??a[pe];if(Ve===de||!Ve)return;(_=G(de,Ve,Ve===Wt[pe])).definition=Ve,Ve.selectionRange.end.character?de.kind!==Tt.SymbolKind.Variable?c.push(de):Ve.kind===Tt.SymbolKind.Variable?d(Ve,de):_.callsite&&rc(r,Ve,_.callsite):delete _.semantic}else k.includes(ye)||c.push(de)});for(let de of h){let ye={},pe,Ve=y,le=de;switch(de.kind){case Tt.SymbolKind.Class:{let N=de;ye={THIS:Ro,SUPER:ns},y=!1;for(let V of[N.property,N.prototype?.property??{}])Object.values(V).forEach(Re=>Re.selectionRange.end.character&&c.push(Re));break}case Tt.SymbolKind.Property:if(le.has_this_param){let N=de;for(let V of[N.get,N.set,N.call])V&&(h.push(V),V.selectionRange.end.character&&c.push(V))}else break;case Tt.SymbolKind.Method:case Tt.SymbolKind.Function:if(le.has_this_param)ye={THIS:Ro,SUPER:ns};else if(m.SUPER?.range.end.character===0&&delete m.SUPER,le.assume!==2)if(le.assume===1&&(y=!1),le.static)for(let[N,V]of Object.entries(m))(V.static||V===a[N])&&(ye[N]=V);else ye={...m};else y=!0;case Tt.SymbolKind.Event:y||=le.assume===2;for(let[N,V]of Object.entries(le.global??{}))pe=ye[N]=a[N]??=V,G(V,pe,pe===Wt[N]).definition=pe,pe.kind===Tt.SymbolKind.Variable&&d(pe,V);for(let[N,V]of Object.entries(le.local??{})){if(G(ye[N]=V,V).definition=V,V.kind===Tt.SymbolKind.Variable){if(V.is_param)continue;!V.assigned&&V.returns===void 0?g.set(V,V):l&&!V.decl&&a[N]&&r.diagnostics.push({message:Gi.localsameasglobal(V.name),range:V.selectionRange,severity:Tt.DiagnosticSeverity.Warning})}c.push(V)}if(le.static===null){let N={...le.global,...le.local};for(let[V,Re]of Object.entries(le.declaration??={}))N[V]||(G(ye[V]=Re,Re).definition=Re);break}for(let[N,V]of Object.entries(le.declaration??={}))(pe=ye[N])?pe!==V&&(G(V,pe,pe===Wt[N]).definition=pe,pe.kind===Tt.SymbolKind.Variable&&d(pe,V)):y?(pe=a[N]??=(c.push(V),V.is_global=!0,r.declaration[N]=V),G(V,pe,pe===Wt[N]).definition=pe,pe.kind===Tt.SymbolKind.Variable&&d(pe,V)):!V.def&&(pe=a[N])?G(V,pe,pe===Wt[N]).definition=pe:(G(ye[N]=le.local[N]=V,V).definition=V,c.push(V),V.static===null&&(V.static=!0),l&&V.kind===Tt.SymbolKind.Variable&&a[N]&&r.diagnostics.push({message:Gi.localsameasglobal(V.name),range:V.selectionRange,severity:Tt.DiagnosticSeverity.Warning}));for(let[N,V]of Object.entries(le.unresolved_vars??{}))(pe=ye[N]??a[N]??f[N])?G(V,pe,pe===Wt[N]).definition=pe:(G(V,V).definition=V,c.push(ye[N]=V),le.assume===1&&(V.static=!0),V.returns===void 0&&g.set(V,V));break;default:ye={...m};break}w(de,ye,y),y=Ve}}function I(x){if(x.d)return;let m={...Wt},y={},h=Tt.DiagnosticSeverity.Error,{relevance:W,uri:_}=x,de,ye;Object.entries(x.labels).forEach(N=>N[1][0].def&&(y[N[0]]=_));for(let N in W)if(de=oe[N]){if(de.d)continue;Co(m,Object.values(de.declaration).filter(Ce=>Ce.kind!==Tt.SymbolKind.Variable),de);let V=de.labels;if(!Object.keys(V).length)continue;let Re=de.relevance;for(let Ce in V){if(!(ye=V[Ce][0]).def)continue;let xe=y[Ce];xe?Re[xe]&&(ye.has_warned??=de.diagnostics.push({message:ee.duplabel(),range:ye.selectionRange,severity:h})):y[Ce]=N}}let pe=Object.values(x.declaration);Co(m,pe,x);for(let N in W)(de=oe[N])&&Co(m,Object.values(de.declaration).filter(V=>V.kind===Tt.SymbolKind.Variable),de);let Ve;pe.forEach(N=>{if(N.kind===Tt.SymbolKind.Class&&(Ve=N).extendsuri===void 0){let V=Ve.extends?.toUpperCase();V===N.name.toUpperCase()?le(x,Ve,!1):V&&!er(x,V)?.prototype&&le(x,Ve)}});for(let N in W)if(de=oe[N]){for(let V of Object.values(de.declaration))if(V.kind===Tt.SymbolKind.Class&&(Ve=V).extendsuri===void 0){let Re=Ve.extends?.toUpperCase();Re===V.name.toUpperCase()?le(de,Ve,!1):Re&&!er(de,Re)?.prototype&&le(de,Ve)}}function le(N,V,Re=!0){let Ce=N.document.offsetAt(V.selectionRange.start),xe,R=N.tokens;if(!(xe=R[R[Ce].next_token_offset])||!(xe=R[xe.next_token_offset])||xe.has_warned)return;Ce=xe.offset,xe.has_warned=!0;let pt={start:N.document.positionAt(Ce),end:N.document.positionAt(Ce+V.extends.length)};N.diagnostics.push({message:Re?ee.unknown("class '"+V.extends)+"'":ee.unexpected(V.extends),range:pt,severity:Tt.DiagnosticSeverity.Warning})}}function G(x,m,y=!1){let h,W,_=m.kind;switch(_){case Tt.SymbolKind.Variable:if(m.is_param){if(!x.selectionRange.end.character)return{};W=4}else y||(W=5);break;case Tt.SymbolKind.Class:W=0;break;case Tt.SymbolKind.Function:W=1;break;case Tt.SymbolKind.Module:W=3;break}let de=s[i.offsetAt(x.selectionRange.start)];if(!de)return{};if(W===void 0)delete de.semantic;else if(!de.ignore){if(h=de.semantic)_!==void 0&&(h.type=W);else if(de.semantic=h={type:W},x.kind===Tt.SymbolKind.Variable&&x.def&&(_===Tt.SymbolKind.Class||_===Tt.SymbolKind.Function)&&(r.diagnostics.push({message:To(x,{kind:_}),range:x.selectionRange}),delete x.def),!de.callsite&&W===1){let ye=r.tokens[de.next_token_offset];ye&&ye.topofline<1&&!(ye.op_type>=0||":?.+-*/=%<>,)]}".includes(ye.content.charAt(0))||!ye.data&&ye.content==="{")&&r.diagnostics.push({message:ee.funccallerr2(),range:x.selectionRange,severity:2})}W<4&&(h.modifier=(h.modifier??0)|2|(y?8:0))}return de}}function Pk(e){let t=e.params,n=t.length,r=n;for(e.variadic&&(r=1/0,n>0&&t[n-1].arr&&n--);n>0&&t[n-1].defaultVal!==void 0;)--n;for(let i=0;i<n;++i)t[i].defaultVal===!1&&--n;return{min:n,max:r,has_this_param:e.has_this_param}}function rc(e,t,n){let r=n.paraminfo,i,s;if(!r||!bt.Diagnostics.ParamsCheck||((i=t?.kind===Tt.SymbolKind.Class)&&(t=Wr(t)),!(s=t?.params)))return;let{max:a,min:u}=Pk(t),f=s.length-(t.variadic?1:0),l={},{count:c,miss:g}=r,k;for(g=[...g];(k=g.pop())!==void 0;)if(k!==--c){c++,g.push(k);break}(c<u&&!r.unknown||c>a)&&e.diagnostics.push({message:ee.paramcounterr(u===a?u:a===1/0?`${u}+`:`${u}-${a}`,c),range:n.range,severity:Tt.DiagnosticSeverity.Error});for(k of g){if(k>=f)break;l[k]=!0,d(s,k)&&e.addDiagnostic(ee.missingparam(),r.comma[k]??e.document.offsetAt(n.range.end),1)}if(t.hasref&&s.forEach((w,I)=>{if(I<c&&w.pass_by_ref&&!l[I]){let G,x;if(I===0?G=n.offset+n.name.length+1:G=r.comma[I-1]+1,(x=e.find_token(G)).content!=="&"&&(x.content.toLowerCase()!=="unset"||w.defaultVal===void 0)&&e.tokens[x.next_token_offset]?.type!=="TK_DOT"){let m=0,y=Ti(e,x,r.comma[I]??(m=r.end));if(y.some(W=>W===Ai||W===sn||W.data===Ai)||un>=wn+7&&y.some(W=>kn(e,W,"__value",!1)))return;let h=e.tokens[r.comma[I]]?.previous_token;h&&(m=h.offset+h.length),e.addDiagnostic(ee.typemaybenot("VarRef"),x.offset,Math.max(0,m-x.offset),{severity:2})}}}),!t.returns?.length&&!(t.type_annotations||null)?.length&&!(i&&t.name.toLowerCase()==="__new")){let w=e.tokens[n.offset];if(w?.previous_token?.type==="TK_EQUALS"){let I=e.get_token(e.document.offsetAt(n.range.end),!0);(!I||!bn(I.previous_token,I)||I.content!=="??"&&(I.content!=="?"||!I.ignore))&&e.addDiagnostic(ee.missingretval(),w.offset,w.length,{severity:2})}}function d(w,I){if(w[I].defaultVal!==void 0)return!1;let G=I-1;for(;G>=0;){for(;G>=0&&w[G].defaultVal===!1;G--,I++);if(!w[I]||w[I].defaultVal!==void 0)return!1;for(;G>=0&&w[G].defaultVal!==!1;G--);}return!0}}async function T_(e,t){let n=[],r=e.query,i=0;if(t.isCancellationRequested||!r||!r.match(/^(\w|[^\x00-\x7f])+$/))return n;let s=new RegExp(r.match(/[^\w]/)?r.replace(/(.)/g,"$1.*"):"("+r.replace(/(.)/g,"$1.*")+"|[^\\w])","i");for(let u in oe)if(a(u))return n;{let u,f,l;for(let c of $i){c=hn.parse(c).fsPath;for await(let g of us(c))if(u=hn.file(g).toString().toLowerCase(),!oe[u]&&(l=nr(g))){if((f=new Un(l)).parseScript(),f.maybev1)continue;if(oe[u]=f,a(u))return n}}}return n;function a(u){for(let f of Tr({textDocument:{uri:u}}))if(s.test(f.name)&&(n.push(f),++i>=1e3))return!0;return!1}}var R_=(r=>(r[r.Disabled=0]="Disabled",r[r.Local=1]="Local",r[r["User and Standard"]=2]="User and Standard",r[r.All=3]="All",r))(R_||{}),Ok=Dn.realpathSync.native,C_={ALPHA:3,BETA:2,RC:1,3:"alpha",2:"beta",1:"rc"},ec=[],oe={},wn=Gu("2.1-alpha.3"),ts=wn+8,bt={ActionWhenV1IsDetected:"Warn",AutoLibInclude:0,CommentTags:"^;;\\s*(.*)",CompleteFunctionParens:!1,CompletionCommitCharacters:{Class:".(",Function:"("},Diagnostics:{ClassNonDynamicMemberCheck:!0,ParamsCheck:!0},Files:{Exclude:[],MaxDepth:2},FormatOptions:{},InterpreterPath:"C:\\Program Files\\AutoHotkey\\v2\\AutoHotkey.exe",SymbolFoldingFromOpenBrace:!1,Warn:{VarUnset:!0,LocalSameAsGlobal:!1,CallWithoutParentheses:!1},WorkingDirs:[]},Ni={get_DllExport:(e,t=!1)=>Promise.resolve([]),get_RCDATA:e=>{},get_ahkProvider:async()=>null},Hn,ss="en-us",Qi="",Zi=!1,Vi="",xr="",un=1/0,Qa=0,an={},Wt={},Kr={},In={},So={},wr=[],$i=[],cn;function Hu(e,t=!0){let n;try{if(n=(0,Dn.readFileSync)(e),n[0]===255&&n[1]===254)return n.toString("utf16le");if(n[0]===239&&n[1]===187&&n[2]===191)return n.toString("utf8").substring(1);try{return new TextDecoder("utf8",{fatal:!0}).decode(n)}catch{t&&Hn?.window.showErrorMessage(ee.invalidencoding(e))}}catch(r){t&&(delete r.stack,r.path=e,console.error(r))}}function nr(e,t=!0){{let n=Hu(e,t);if(n!==void 0)return Gn.create(hn.file(e).toString(),"ahk2",-10,n)}}function Jm(e,t=!0,n=!0){let r=nr(e,t);if(r){let i=new Un(r);return i.parseScript(),n&&(oe[i.uri]=i),i}}function li(e){let t;try{t=Ok(e)}catch{return e}let n=e.toUpperCase(),r=t.toUpperCase();if(n===r)return t;let[i,s,a]=[t,r,n].map(f=>f.split(/[/\\]/)),u=a.length;try{let f,l;for(f=0;f<u&&a[f]===s[f];f++);e:for(t=i.slice(0,f||=(i[0]=a[0],1)).join(rr.sep);f<u;){l=a[f++];for(let c of(0,Dn.readdirSync)(t+=rr.sep))if(c.toUpperCase()===l){t+=c;continue e}break}}catch{}return t+e.substring(t.length)}function Bu(e){let t=e.match(/<>./),n;if(t){if((0,Dn.existsSync)(n=e.replace("<>",ss)))return n;if(ss.toLowerCase()==="zh-tw"&&(0,Dn.existsSync)(n=e.replace("<>","zh-cn")))return n;if((0,Dn.existsSync)(n=e.replace(t[0],"")))return n}else if((0,Dn.existsSync)(e))return e}function Km(e,t){let n=Bu(e);if(n)return(0,Dn.readFileSync)(n,t&&{encoding:t})}function ds(){let e=Ei.Keyword,t="*";Wt={},an={},Kr={},cn={constant:[],directive:{"#":[],"@":Lm.map(n=>({label:n,kind:e,data:t}))},key:[],keyword:{},snippet:[],text:[],option:{ahk_criteria:[],hotstring:[]}}}function Li(e="ahk2",t=3){let n,r=`${Qi}/syntaxes/<>/${e}`;{let l=function(c){return Bu(u+c)||(u!==r?Bu(r+c):void 0)};var s=l;let a=bt.Syntaxes,u=a?`${a}/<>/${e}`:r,f;if((n=l(".d.ahk"))&&(f=nr(li(n)))){let c=new Un(f,void 0,t);c.parseScript(),oe[c.uri]=c,an[e]=c.uri}(n=l(".json"))&&i(JSON.parse((0,Dn.readFileSync)(n,{encoding:"utf8"}))),e==="ahk2"&&(i(JSON.parse((0,Dn.readFileSync)(`${Qi}/syntaxes/ahk2_common.json`,{encoding:"utf8"}))),a&&(0,fs.opendir)(a).then(async c=>{for await(let g of c)!g.isDirectory()&&g.name.toLowerCase().endsWith(".snippet.json")&&i(JSON.parse(await(0,fs.readFile)(`${a}/${g}`,{encoding:"utf8"})))}))}function i(a){let u,f,l,c,g=_n.create(0,0,0,0);for(let w in a){let I=a[w];switch(w){case"constants":f=Ei.Constant,u=Mr.Snippet;for(c of I)cn.constant.push({label:c.prefix,kind:f,insertTextFormat:u,insertText:`\${1:${c.prefix} := }${c.body}$0`,detail:c.description??c.body});break;case"directives":l="",f=Ei.Keyword,u=Mr.Snippet;for(c of I)c.prefix??=c.body.trim(),"@#".includes(l=c.prefix.charAt(0))&&(cn.directive[l].push({label:c.prefix.replace(/^[^#\w]/,""),insertText:c.body.replace(/^\W+/,""),kind:f,insertTextFormat:u,detail:c.description,data:c.body.charAt(0)}),l==="#"&&(So[c.prefix.toLowerCase()]=[c.prefix,{contents:{kind:"markdown",value:"```ahk2\n"+(c.syntax??d(c.body))+"\n```\n\n"+(c.description??"")}}]));break;case"keys":f=Ei.Keyword;for(c of I)cn.key.push({label:c.body,kind:f,detail:c.description});break;case"keywords":f=Ei.Keyword,u=Mr.Snippet;for(c of I)c.prefix??=c.body.trim(),cn.keyword[c.prefix]={label:c.prefix,kind:f,insertTextFormat:u,insertText:c.body,detail:c.description,preselect:!0},So[c.prefix.toLowerCase()]=[c.prefix,{contents:{kind:"markdown",value:"```ahk2\n"+(c.syntax??d(c.body))+"\n```\n\n"+(c.description??"")}}];break;case"snippet":f=Ei.Snippet,u=Mr.Snippet;for(c of I)cn.snippet.push({label:c.prefix,insertText:k(c.body),detail:c.description,kind:f,insertTextFormat:u});break;case"variables":for(c of I)Wt[c.body.toUpperCase()]={name:c.body,kind:Ia.Variable,range:g,selectionRange:g,detail:c.description};break;case"texts":f=Ei.Text;for(c of I)cn.text.push({label:c.body,kind:f});break;case"options":f=Ei.Text;for(let G in I){let x=cn.option[G]??=[];for(c of I[G])x.push({label:c.body,kind:f,detail:c.description})}break;default:break}}function k(w){return typeof w=="object"?w.join(`
`):w}function d(w){return w.replace(/\$\{\d+((\|)|:)([^}]*)\2\}|\$\d/g,(...I)=>I[2]?I[3].replaceAll(",","|"):I[3]||"")}}}var oc={};function us(e){let t=bt.Files.MaxDepth,{file:n,folder:r}=oc;return i(li(e),0);async function*i(s,a){try{for await(let u of await(0,fs.opendir)(s))if(u.isDirectory()&&a<t){let f=(0,rr.resolve)(s,u.name);r?.some(l=>l.test(f))||(yield*i(f,a+1))}else if(u.isFile()&&/\.(ahk2?|ah2)$/i.test(u.name)){let f=(0,rr.resolve)(s,u.name);n?.some(l=>l.test(f))||(yield f)}}catch{}}}function zu(e){typeof e.AutoLibInclude=="string"?e.AutoLibInclude=R_[e.AutoLibInclude]:typeof e.AutoLibInclude=="boolean"&&(e.AutoLibInclude=e.AutoLibInclude?3:0),typeof e.Warn?.CallWithoutParentheses=="string"&&(e.Warn.CallWithoutParentheses={On:!0,Off:!1,Parentheses:1}[e.Warn.CallWithoutParentheses]),ju(e.FormatOptions??{});try{Qm(e.CommentTags)}catch(t){delete e.CommentTags,Hn?.window.showWarningMessage(Xi.valueerr("CommentTags","RegExp",t.message))}if(e.WorkingDirs instanceof Array?e.WorkingDirs=e.WorkingDirs.map(t=>(t=hn.file(t.includes(":")?t:(0,rr.resolve)(t)).toString().toLowerCase()).endsWith("/")?t:t+"/"):e.WorkingDirs=[],oc={},e.Files){let t=[],n=[];for(let r of e.Files.Exclude??[])try{(/[\\/]$/.test(r)?n:t).push(Ak(r))}catch{Hn?.window.showWarningMessage(Xi.valueerr("Files.Exclude","glob pattern",r))}t.length&&(oc.file=t),n.length&&(oc.folder=n),(e.Files.MaxDepth??=2)<0&&(e.Files.MaxDepth=1/0)}if(e.Syntaxes){let t=Oo(e.Syntaxes,!0);t&&(0,Dn.lstatSync)(t).isDirectory()?e.Syntaxes=li(t):(Hn?.window.showWarningMessage(Xi.valueerr("Syntaxes","folder path",e.Syntaxes)),delete e.Syntaxes)}Object.assign(bt,e)}function Gu(e){let t=e.replace(/-\w+/,r=>`.-${C_[r.substring(1).toUpperCase()]}`).split("."),n=0;for(let r=0;r<4;r++)n+=parseInt(t[r]??"0")*1e3**(3-r);return n}function jm(e){let t=[];e+=3e3;for(let n=0;n<4;n++)t[3-n]=e%1e3,e=Math.floor(e/1e3);return(t[2]-=3)>=0&&(e=t.pop())&&t.push(e),t.join(".").replace(/\.-\d+/,n=>`-${C_[n.substring(2)]}`)}function Zm(e){e:for(let t of e.split("||")){for(let n of t.matchAll(/(ahk_h\s*)?([<>]=?|=)?([^<>=]+)/g)){if(n[1]&&!Zi)continue e;let r=Gu(n[3]),i=!1;switch(n[2]??">="){case">=":i=un>=r;break;case"<=":i=un<=r;break;case"=":i=un===r;break;case">":i=un>r;break;case"<":i=un<r;break}if(!i)continue e}return!0}return!1}async function Wu(e,t){return Ni.get_ahkProvider().then(n=>n?.sendRequest(e,...t))}function Po(e){let t;return e=e.replace(/([*.?+^$|\\/[\](){}])|([^\x00-\x7f])|(.)/g,(n,r,i,s)=>`${s||(t??=i)||`\\${r}`}.*`),new RegExp(t?e:`([^\\x00-\\x7f]|${e})`,"i")}function x_(){In={}}function sc(e){Zi=e}function D_(e){let t=Oo(e,!0);t&&(Vi=e,xr=t)}function S_(e){return Hn=e}function E_(e){Qi=e.replace(/[/\\]$/,"")}function P_(e){e&&(ss=e.toLowerCase())}function O_(e){un=Gu(e),un<ts?Qa=1:Qa=0}function ac(e){let t=$i;if($i=[...e],bt.WorkingDirs.forEach(n=>!e.has(n)&&$i.push(n)),$i.sort().reverse(),!(t.length===$i.length&&!t.some((n,r)=>$i[r]!==n)))for(let n of Object.values(oe))oe[n.uri]&&!n.setWorkspaceFolder()&&!n.actived&&n.close()}async function Xu(e){return new Promise(t=>setTimeout(t,e))}function Oo(e,t=!1){if(!e)return e;let n=[];if(e=e.replace(/%(\w+)%/g,(r,i)=>process.env[i]??r),e.includes(":")||n.push((0,rr.resolve)(e)),process.platform==="win32"&&!/[\\/]/.test(e))try{n.push((0,w_.execSync)(`chcp 65001 > nul && where ${e}`,{encoding:"utf-8"}).trim())}catch{}n.push(e);for(let r of n)if(r)try{return(0,Dn.lstatSync)(r).isSymbolicLink()&&t&&(0,Dn.lstatSync)(r=(0,rr.resolve)(r,"..",(0,Dn.readlinkSync)(r))),r}catch{}return""}function Ak(e){let t="",n=!1,r,i;(r=e.startsWith("!"))&&(e=e.slice(1));for(let s=0,a,u=e.length;s<u;s++)switch(i=e[s]){case"/":case"\\":t+="[\\x5c/]";break;case"$":case"^":case"+":case".":case"(":case")":case"=":case"|":t+="\\"+i;break;case"?":t+=".";break;case"!":s?t.endsWith("[")?t+="^":t+="\\"+i:r=!0;break;case"{":n=!0,t+="(";break;case"}":n=!1,t+=")";break;case",":t+=n?"|":",";break;case"*":for(a=s;e[s+1]==="*";)s++;s>a&&/^[\x5c/]?\*+[\x5c/]?$/.test(e.substring(a-1,s+2))?(t+="((?:[^\\x5c/]*(?:[\\x5c/]|$))*)",s++):t+="([^\\x5c/]*)";break;default:t+=i}return/^([a-zA-Z]:|\*\*)/.test(e)?t="^"+t:/[\\/]/.test(e[0])||(t="[\\x5c/]"+t),/[\\/]$/.test(e)||(t+="$"),r&&(t=t.startsWith("^")?`^(?!${t})`:`(?!${t})`),new RegExp(t,"i")}var wi;async function Nk(){return new Promise(async e=>{if(!xr)return e(0);let t,n=1200;for(;;)try{t=await(0,Hr.createClientSocketTransport)(n);break}catch{n++}let r=(0,A_.spawn)(xr,[`${Qi}/server/dist/ahkProvider.ahk`,n.toString()]);if(!r.pid)return e(0);let i=s=>{if(i=void 0,!s)return e(0);s.onNotification("initialized",a=>(s.dispose(),e(a))),s.listen()};r.on("close",()=>i?.()),t.onConnected().then(s=>i?.((0,Hr.createMessageConnection)(...s)),()=>i?.())})}async function N_(){if(wi!==void 0)return wi;let e=0;return process.platform==="win32"&&(e=await Nk()),e?new Promise(t=>{let n=!1;wi=(0,Hr.createMessageConnection)(...(0,Hr.createServerSocketTransport)(e)),wi.onNotification("initialized",()=>{n=!0,t(wi??(wi=void 0,null))}),wi.onClose(()=>wi=void 0),wi.listen(),setTimeout(()=>{n||(wi?.dispose(),t(wi=null))},500)}):wi=null}var cc=require("fs");var Ao=class{close=()=>{};is_bit64;reader;resource={};dataDirectory=[];sectionTable=[];constructor(t){let r=Buffer.alloc(4096),i,s,a,u;this.is_bit64=new Promise(async(g,k)=>{try{if(a=await cc.promises.open(t,"r"),this.close=()=>a?.close(),await l(0)!==23117)throw Error("no MS-DOS stub");if(i=await c(60),await c(i)!==17744)throw Error("no PE file");s=i+24,g(await l(s)===523)}catch(d){return a?.close(),k(d)}}),this.reader=()=>u??=new Promise(async(g,k)=>{try{let _=function(ye){let pe=W.find(Ve=>ye>=Ve.virtualAddress);if(!pe||ye>=pe.virtualAddress+pe.sizeOfRawData)throw Error("out of range");return ye-pe.virtualAddress+pe.pointerToRawData};var d=_;let w=await this.is_bit64,I=s+(w?112:96),G=await c(I-4),x=await l(i+6),m=await l(i+20),y=Buffer.alloc(40*x),{dataDirectory:h,sectionTable:W}=this;if((await a.read(y,0,y.length,s+m)).bytesRead!==y.length)throw Error("bad PE file");for(let ye=0,pe=0;ye<x;ye++,pe+=40){let Ve=y.readUInt32LE(pe+12),le=y.readUInt32LE(pe+16),N=y.readUInt32LE(pe+20);W.push({virtualAddress:Ve,sizeOfRawData:le,pointerToRawData:N})}if(this.sectionTable=W.sort((ye,pe)=>pe.virtualAddress-ye.virtualAddress),y=Buffer.alloc(8*G),(await a.read(y,0,y.length,I)).bytesRead!==y.length)throw Error("bad PE file");for(let ye=0,pe=0;ye<G;ye++,pe+=8)h.push({virtualAddress:y.readUInt32LE(pe),size:y.readUInt32LE(pe+4)});g({readUInt16LE:l,readUInt32LE:c,RVA2Offset:_,read:f,readString:de});async function de(ye){return await a.read(r,0,r.length,_(ye)),r.subarray(0,r.indexOf(Buffer.alloc(1))).toString()}}catch(w){return this.close(),k(w)}});async function f(g,k){return(await a.read(Buffer.alloc(k),0,k,g)).buffer}async function l(g){return await a.read(r,0,2,g),r.readUInt16LE(0)}async function c(g){return await a.read(r,0,4,g),r.readUInt32LE(0)}}async getExport(){let t=await this.reader(),n=this.dataDirectory[0];if(!n?.virtualAddress)return;if(n.data)return n.data;let r=n.virtualAddress,i=r+n.size,s=await t.read(t.RVA2Offset(r),40),a=s.readUInt32LE(12),u=s.readUInt32LE(16),f=s.readUInt32LE(20),l=s.readUInt32LE(24),c=t.RVA2Offset(s.readUInt32LE(28)),g=t.RVA2Offset(s.readUInt32LE(32)),k=t.RVA2Offset(s.readUInt32LE(36)),d={Module:await t.readString(a),Functions:[],OrdinalBase:u},w={};for(let I=0;I<l;I++){let G=await t.readUInt32LE(g),x=await t.readUInt16LE(k),m=await t.readUInt32LE(c+x*4);g+=4,k+=2,w[x]=!0;let y=m>r&&m<i?await t.readString(m):"0x"+(m+4294967296).toString(16).substring(1);d.Functions.push({Name:await t.readString(G),EntryPoint:y,Ordinal:u+x})}for(let I=0;l<f;I++,l++){for(;w[I];)I++;let G=await t.readUInt32LE(c+I*4),x=G>r&&G<i?await t.readString(G):"0x"+(G+4294967296).toString(16).substring(1);w[I]=!0,d.Functions.splice(I,0,{Name:"",EntryPoint:x,Ordinal:u+I})}return n.data=d}async getImport(){let t=await this.reader(),n=this.dataDirectory[1];if(!n?.virtualAddress)return;if(n.data)return n.data;let r=t.RVA2Offset(n.virtualAddress),i=await t.readUInt32LE(r+12),s=await t.readUInt32LE(r+16),a=4,u=r,f,l,c,g;await this.is_bit64?(a=8,l=BigInt(65535),c=BigInt("0x8000000000000000"),f=async d=>(await t.read(d,8)).readBigUInt64LE()):(l=65535,c=2147483648,f=t.readUInt32LE);let k={};for(;s;){let d=await t.readString(i),w=k[d]??=[];for(let I=0;g=await f(t.RVA2Offset(s+I*a));I++)w.push(g&c?`Ordinal#${g&l}`:await t.readString(Number(g)+2));u+=20,i=await t.readUInt32LE(u+12),s=await t.readUInt32LE(u+16)}return n.data=k}async getResource(...t){let n=await this.reader(),r=this.dataDirectory[2];if(!r?.virtualAddress)return;if(t.length===1&&this.resource[t[0]])return this.resource[t[0]];let i=n.RVA2Offset(r.virtualAddress),s=[i],a={};return t.forEach(g=>this.resource[g]??=a[g]=[]),a[10]&&=this.resource[10]={},await u(i),t.forEach(g=>a[g]??=this.resource[g]),t.length===1?a[t[0]]:a;async function u(g,k=0){let d={NumberOfNamedEntries:await n.readUInt16LE(g+12),NumberOfIdEntries:await n.readUInt16LE(g+14)},w=[],I=d.NumberOfIdEntries+d.NumberOfNamedEntries;g+=16;for(let G=0;G<I;G++,g+=8){let x=await n.readUInt32LE(g);if(k===0&&!a[x&65535])continue;let m=await n.readUInt32LE(g+4),y={name:x,id:x&65535,pad:x&4294901760,nameOffset:x&2147483647,offsetToData:m,dataIsDirectory:!!((m&2147483648)>>31),offsetToDirectory:m&2147483647},h,W;if((x&2147483648)>>31){let _=i+y.nameOffset,de=await n.readUInt16LE(_);h=(await n.read(_+2,de*2)).toString("utf16le")}else W=x;if(y.dataIsDirectory){if(s.includes(i+y.offsetToDirectory))break;s.push(i+y.offsetToDirectory);let _=await u(i+y.offsetToDirectory,k+1);if(_===void 0)break;w.push({struct:y,id:W,name:h,directory:_})}else{let _=i+y.offsetToDirectory,ye={struct:{offsetToData:await n.readUInt32LE(_),size:await n.readUInt32LE(_+4),codePage:await n.readUInt32LE(_+8),reserved:await n.readUInt32LE(_+12)},lang:y.name&1023,subLang:y.name>>10};w.push({struct:y,id:W,name:h,data:ye})}if(k===0){let _=w[w.length-1];if(y.id===16){let de=_.directory?.entries[0].directory?.entries??[];for(let ye of de){let pe=ye.data?.struct;pe&&await f(a[16],pe)}}else if(y.id===24){let de=_.directory?.entries[0].directory?.entries??[];for(let ye of de){let pe=ye.data?.struct;pe?.size&&a[24].push(await l(pe))}}else if(y.id===10){a[10]instanceof Array&&(a[10]={});let de=a[10];for(let ye of _.directory?.entries??[]){let pe=ye.name??`#${ye.id}`,Ve=ye.directory?.entries?.pop()?.data?.struct;Ve&&(de[pe.toLowerCase()]=await n.read(n.RVA2Offset(Ve.offsetToData),Ve.size))}}else throw Error("not handled")}}return{struct:d,entries:w}}async function f(g,k){let d=0,w=0,I=k.offsetToData,G=await n.read(n.RVA2Offset(I),k.size);h(w),w=c(2+d,I);let x={Signature:G.readUInt32LE(w),StrucVersion:G.readUInt32LE(w+4),FileVersionMS:G.readUInt32LE(w+8),FileVersionLS:G.readUInt32LE(w+12),ProductVersionMS:G.readUInt32LE(w+16),ProductVersionLS:G.readUInt32LE(w+20),FileFlagsMask:G.readUInt32LE(w+24),FileFlags:G.readUInt32LE(w+28),FileOS:G.readUInt32LE(w+32),FileType:G.readUInt32LE(w+36),FileSubtype:G.readUInt32LE(w+40),FileDateMS:G.readUInt32LE(w+44),FileDateLS:G.readUInt32LE(w+48)},m={StringTable:[],Version:[x.FileVersionMS>>16,x.FileVersionMS&65535,x.FileVersionLS>>16,x.FileVersionLS&65535].join(".")};g.push(m),w=c(w+52,I);let y=h(w);if(y.Key==="StringFileInfo"&&[0,1].includes(y.Type)&&y.ValueLength===0){let W=c(2+d,I);for(;;){let _=h(W),de={};for(m.StringTable.push(de),w=c(2+d,I);w<W+_.Length;){let ye=w,pe=h(w);w=c(2+d,I);let Ve=h(w,!1);pe.Length===0?w=W+_.Length:w=c(ye+pe.Length,I),de[pe.Key]=Ve.Key}if(w=c(_.Length+W,I),w===W||w>=y.Length)break;W=w}}function h(W,_=!0){let de={};return _&&(de={Length:G.readUInt16LE(W),ValueLength:G.readUInt16LE(W+2),Type:G.readUInt16LE(W+4)},W+=6),d=(G.indexOf(Buffer.alloc(2),W)+1>>1)*2,{...de,Key:G.subarray(W,d).toString("utf16le")}}}async function l(g){return(await n.read(n.RVA2Offset(g.offsetToData),g.size)).toString()}function c(g,k){return(g+k+3&4294967292)-(k&4294967292)}}};async function L_(e,t){let n,r="",i,s=[""];for(;;)try{n=new Ao(e);let a=await n.is_bit64;if(r&&t!==void 0&&a!==t)throw n.close(),Error();return n}catch(a){if(a instanceof Error||a.errno===-4058){if(!i){if(e.includes(":")||!(i=process.env.Path?.split(";")))return;t===!1&&i.unshift("C:\\Windows\\SysWOW64\\"),r=e,r.toLowerCase().endsWith(".dll")||s.push(".dll")}let u;e:for(;(u=i.pop())!==void 0;)for(let f of s)if(u&&(0,cc.existsSync)(e=(u.endsWith("/")||u.endsWith("\\")?u:u+"\\")+r+f))break e;if(!u)return}}}var Lk="ahk2-language-server",Mo=new di.TextDocuments(Gn),Nt=S_((0,di.createConnection)(di.ProposedFeatures.all)),Lo=new Set,Yu=!1,Qu=!1,I_=!1,q_="";Ni.get_RCDATA=Ik;Ni.get_DllExport=U_;Ni.get_ahkProvider=N_;Nt.onInitialize(async e=>{let t=e.capabilities,n=e.initializationOptions,r={serverInfo:{name:Lk},capabilities:{textDocumentSync:{change:di.TextDocumentSyncKind.Incremental,openClose:!0},completionProvider:{resolveProvider:!1,triggerCharacters:[".","#","*","@"]},signatureHelpProvider:{triggerCharacters:["(",","," "]},documentSymbolProvider:!0,definitionProvider:!0,documentFormattingProvider:!0,documentRangeFormattingProvider:!0,documentOnTypeFormattingProvider:{firstTriggerCharacter:"}",moreTriggerCharacter:[`
`,...Object.keys(Yo)]},executeCommandProvider:{commands:s_(n?.commands)},hoverProvider:!0,foldingRangeProvider:!0,colorProvider:!0,codeActionProvider:!0,renameProvider:{prepareProvider:!0},referencesProvider:{workDoneProgress:!0},semanticTokensProvider:{legend:{tokenTypes:Object.values(jr).filter(s=>typeof s=="string"),tokenModifiers:Object.values(rs).filter(s=>typeof s=="string")},full:!0,range:!0},workspaceSymbolProvider:!0}};Yu=!!(t.workspace&&t.workspace.configuration),Qu=!!(t.workspace&&t.workspace.workspaceFolders),Qu&&(e.workspaceFolders?.forEach(s=>Lo.add(s.uri.toLowerCase()+"/")),r.capabilities.workspace={workspaceFolders:{supported:!0}}),E_((0,ps.resolve)(__dirname,"../..")),P_(n?.locale??e.locale),qm(),ds();let i=Wt;return n&&zu(n),ac(Lo),await ef(Oo(bt.InterpreterPath??="")),i===Wt&&Li(),r});Nt.onInitialized(()=>{Yu&&Nt.client.register(di.DidChangeConfigurationNotification.type),Qu&&Nt.workspace.onDidChangeWorkspaceFolders(e=>{e.removed.forEach(t=>Lo.delete(t.uri.toLowerCase()+"/")),e.added.forEach(t=>Lo.add(t.uri.toLowerCase()+"/")),ac(Lo)}),I_=!0,W_(),U_(["user32","kernel32","comctl32","gdi32"].map(e=>`C:\\Windows\\System32\\${e}.dll`)).then(e=>ec.push(...e))});Nt.onDidChangeConfiguration(async e=>{let t=e?.settings;if(Yu&&!t&&(t=await Nt.workspace.getConfiguration("AutoHotkey2")),!t){Nt.window.showWarningMessage("Failed to obtain the configuration");return}let{AutoLibInclude:n,InterpreterPath:r,Syntaxes:i}=bt,s=Wt;zu(t),ac(Lo),r!==bt.InterpreterPath&&await ef(Oo(bt.InterpreterPath??="")),n!==bt.AutoLibInclude&&(bt.AutoLibInclude>1&&n<=1&&j_(),bt.AutoLibInclude&1&&!(n&1)&&Mo.all().forEach(a=>tf(a.uri.toLowerCase()))),s===Wt&&i!==bt.Syntaxes&&(ds(),Li(),Zi&&(Li("ahk_h"),Li("winapi",4)))});Nt.onDidChangeWatchedFiles(e=>{let t,n;for(let r of e.changes)switch(r.type){case 2:(n=oe[r.uri.toLowerCase()])?.actived===!1&&(Gn.update(n.document,[{text:Hu(n.fsPath)??""}],0),n.update());break;case 3:(n=oe[t=r.uri.toLowerCase()])&&(n.close(!0),delete oe[t]);break}});Mo.onDidOpen(e=>{let t=q_===e.document.uri,n=e.document.uri.toLowerCase(),r=oe[n];r?r.document=e.document:oe[n]=r=new Un(e.document),Object.defineProperty(r.include,"",{value:"",enumerable:!1}),r.actived=!0,t&&(r.actionwhenv1="Continue"),bt.AutoLibInclude&1&&tf(n).then(()=>r.last_diags&&Object.keys(r.included).length&&r.update())});Mo.onDidClose(e=>oe[e.document.uri.toLowerCase()]?.close());Mo.onDidChangeContent(e=>oe[e.document.uri.toLowerCase()]?.update());Nt.onCodeAction(e_);Nt.onCompletion(c_);Nt.onColorPresentation(t_);Nt.onDocumentColor(n_);Nt.onDefinition(l_);Nt.onDocumentFormatting(u_);Nt.onDocumentRangeFormatting(f_);Nt.onDocumentOnTypeFormatting(d_);Nt.onDocumentSymbol(Tr);Nt.onFoldingRanges(e=>oe[e.textDocument.uri.toLowerCase()]?.foldingranges);Nt.onHover(p_);Nt.onPrepareRename(m_);Nt.onReferences(h_);Nt.onRenameRequest(__);Nt.onSignatureHelp(v_);Nt.onExecuteCommand(a_);Nt.onWorkspaceSymbol(T_);Nt.languages.semanticTokens.on(Eo);Nt.languages.semanticTokens.onRange(y_);Nt.onRequest("exportSymbols",e=>r_(e));Nt.onRequest("getAHKversion",V_);Nt.onRequest("getContent",e=>oe[e.toLowerCase()]?.document.getText());Nt.onRequest("getVersionInfo",o_);Nt.onNotification("resetInterpreterPath",e=>ef(bt.InterpreterPath=e));Nt.onNotification("onDidCloseTextDocument",e=>{e.id==="ahk2"?oe[e.uri.toLowerCase()]?.close(!0):q_=e.uri});Mo.listen(Nt);Nt.listen();async function lc(e){if(K_(),!bt.commands?.includes("executeCommand"))return Nt.window.showErrorMessage(e);await Nt.window.showErrorMessage(e,{title:"Select Interpreter"})&&Nt.sendRequest("executeCommand",["ahk2.set.interpreter"])}async function Mk(e){if(!xr)return lc(Xi.ahkpatherr()),!1;let t,n=un;for(let i=0;i<3&&!t;i++)t=await qk();if(!t)return lc(Xi.getenverr()),!1;if(Object.assign(Wn,t).ahkpath??=Vi,O_(Wn.ahkversion??="2.0.0"),Wn.ahkversion.startsWith("1.")&&lc(Xi.versionerr()),!e||!wr.length){wr.length=0,wr.push(Wn.mydocuments+"\\AutoHotkey\\Lib\\",Wn.ahkpath.replace(/[^\\/]+$/,"Lib\\"));let i;for(i of Object.values(In))i.islib=$_(i.fsPath)}if(un!==n){let i=!!Wn.threadid;ds(),sc(i),Li(),i&&(Li("ahk2_h"),Li("winapi",4)),e=!1}else Wn.threadid?Zi||(sc(!0),e=!1,Li("ahk2_h"),Li("winapi",4)):Zi&&(sc(!1),e=!1,ds(),Li());if(Object.assign(Wn,{index:"0",clipboard:"",threadid:""}),await r(),e)return!0;for(let i in oe){let s=oe[i];s.d||(s.initLibDirs(),(Object.keys(s.include).length||s.diagnostics.length)&&s.update())}return x_(),bt.AutoLibInclude>1&&j_(),!0;async function r(){let i;try{K_(),i=new Ao(Oo(Vi,!0)),No=await i.getResource(10)}catch{}finally{i?.close()}}}function K_(){Zu.forEach(e=>e.close(!0)),Zu.length=0,No=void 0}function Ju(e){return Object.assign(Object.values(e.declaration).filter(t=>t.kind===di.SymbolKind.Class||t.kind===di.SymbolKind.Function),{fsPath:e.fsPath,islib:$_(e.fsPath)})}async function j_(){let e,t,n,r,i;for(e of wr)for await(t of us(e))if(!In[n=hn.file(t).toString().toLowerCase()]){if(!(r=oe[n])&&(!(i=nr(t))||(r=new Un(i)).d||(r.parseScript(),r.maybev1)))continue;In[n]=Ju(r),await Xu(50)}}function $_(e){e=e.toLowerCase();for(let t of wr)if(e.startsWith(t.toLowerCase()))return!0;return!1}async function Fk(e,t){let n=!!e&&(0,ps.resolve)(e,"..").toLowerCase()===(0,ps.resolve)(t,"..").toLowerCase();return await Mk(n)?(n||Mo.all().forEach(r=>{let i=oe[r.uri.toLowerCase()];i&&(i.initLibDirs(i.scriptdir),bt.AutoLibInclude&1&&tf(i.uri))}),!0):!1}async function ef(e){let t=Vi;if(e){if(e.toLowerCase()===t.toLowerCase())return;D_(e),W_(),await Fk(t,e)}Vi||lc(Xi.ahkpatherr())}async function W_(){let e="updateStatusBar";!I_||!bt.commands?.includes(e)||Nt.sendRequest(e,xr?[Vi].concat(await V_([xr])):[""])}async function tf(e){let t=oe[e];if(!t||!e.startsWith("file:"))return;!t.d&&(In[e]??=Ju(t));let n=t.workspaceFolder,r=!1,i,s;n?(n=hn.parse(n).fsPath,r=!0):n=t.scriptdir+"\\lib";for await(i of us(n))if(!In[e=hn.file(i).toString().toLowerCase()]){if(!(t=oe[e])){if(!(s=nr(i))||(t=new Un(s)).d||(t.parseScript(),t.maybev1))continue;r&&(xo(oe[e]=t,t.scriptdir),vr(t))}In[e]=Ju(t),await Xu(50)}}async function V_(e){return Promise.all(e.map(async t=>{let n;try{n=new Ao(t);let r=(await n.getResource(16))[0].StringTable[0];if(r.ProductName?.toLowerCase().startsWith("autohotkey")){let i=await n.is_bit64,s=(await n.getResource(24))[0]?.replace(/<!--[\s\S]*?-->/g,"")??"",a=`${r.ProductName} ${r.ProductVersion??"unknown version"} ${i?"64":"32"} bit`;return s.includes('uiAccess="true"')&&(a+=" [UIAccess]"),a}}catch{}finally{n?.close()}return""}))}async function U_(e,t=!1){let n={};for(let r of e){let i=await L_(r,Wn.ptrsize==="8"?!0:Wn.ptrsize==="4"?!1:void 0);if(i)try{if((await i.getExport())?.Functions.forEach(s=>n[s.Name]=!0),t)break}finally{i.close()}}return delete n[""],Object.keys(n)}var No,Zu=[];function Ik(e){if(!No)return;if(!e)return{uri:"",path:"",paths:Object.keys(No??{})};let t=`${Vi}:${e}`,n=hn.from({scheme:"ahkres",path:t}).toString().toLowerCase();if(oe[n])return{uri:n,path:t};let r=No[e];if(r)try{let i=oe[n]=new Un(Gn.create(n,"ahk2",-10,new TextDecoder("utf8",{fatal:!0}).decode(r)));return i.parseScript(),Zu.push(i),{uri:n,path:t}}catch{delete No[e]}}function qk(){let e=`\\\\.\\pipe\\ahk-script-${Buffer.from(Uint16Array.from([process.pid,Date.now()]).buffer).toString("hex")}`,t=!1,n,r=(0,M_.createServer)().listen(e),i=`
#NoTrayIcon
s := ""
for _, k in ${JSON.stringify([...Om,...Am])}
	try if SubStr(k, 1, 2) = "a_" && !IsObject(v := %k%)
		s .= SubStr(k, 3) "|" v "\`n"
FileOpen(A_ScriptFullPath, "w", "utf-8").Write(s)`;return new Promise(s=>{r.on("connection",u=>{let f=()=>u.destroy();if(u.on("error",f),t){n="",u.setEncoding("utf8").on("data",l=>n+=l).on("end",()=>(s(),f()));return}t=u.write(i),u.destroySoon()});let a=(0,F_.spawn)(`"${Vi}" /CP65001 /ErrorStdOut ${e}`,[],{cwd:(0,ps.resolve)(Vi,".."),shell:!0});a.on("exit",u=>u!==0?s():n===void 0&&setTimeout(s,1e3)),a.on("error",s),setTimeout(()=>a.kill(),2e3)}).then(()=>{let s=n?.trim();if(s)return Object.fromEntries(s.split(`
`).map(a=>a.split("|")))}).finally(()=>r.close())}
//# sourceMappingURL=server.js.map
